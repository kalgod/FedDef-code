test5
3e-2 + 10
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=10, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.129, Acc 0.571
Round   1, Average loss 2.535, Acc 0.288
Round   2, Average loss 2.361, Acc 0.410
Round   3, Average loss 2.902, Acc 0.390
Round   4, Average loss 2.229, Acc 0.786
Round   5, Average loss 2.908, Acc 0.952
Round   6, Average loss 2.199, Acc 0.786
Round   7, Average loss 2.876, Acc 0.962
Round   8, Average loss 2.226, Acc 0.788
Round   9, Average loss 2.838, Acc 0.950
Round  10, Average loss 2.195, Acc 0.787
Round  11, Average loss 2.871, Acc 0.829
Round  12, Average loss 2.136, Acc 0.794
Round  13, Average loss 2.838, Acc 0.897
Round  14, Average loss 2.187, Acc 0.806
Round  15, Average loss 2.853, Acc 0.949
Round  16, Average loss 2.175, Acc 0.786
Round  17, Average loss 2.833, Acc 0.785
Round  18, Average loss 2.176, Acc 0.834
0.0135
Round  19, Average loss 2.837, Acc 0.792
Round  20, Average loss 2.346, Acc 0.820
Round  21, Average loss 2.859, Acc 0.795
Round  22, Average loss 2.357, Acc 0.913
Round  23, Average loss 2.856, Acc 0.760
Round  24, Average loss 2.370, Acc 0.930
Round  25, Average loss 2.863, Acc 0.355
Round  26, Average loss 2.383, Acc 0.943
Round  27, Average loss 2.873, Acc 0.362
Round  28, Average loss 2.370, Acc 0.942
Round  29, Average loss 2.874, Acc 0.370
Round  30, Average loss 2.400, Acc 0.945
Round  31, Average loss 2.868, Acc 0.365
Round  32, Average loss 2.394, Acc 0.409
Round  33, Average loss 2.868, Acc 0.367
Round  34, Average loss 2.428, Acc 0.411
Round  35, Average loss 2.902, Acc 0.389
Round  36, Average loss 2.442, Acc 0.394
Round  37, Average loss 2.941, Acc 0.397
Round  38, Average loss 2.461, Acc 0.384
0.01215
Round  39, Average loss 2.934, Acc 0.393
Round  40, Average loss 2.538, Acc 0.413
Round  41, Average loss 2.848, Acc 0.411
Round  42, Average loss 2.514, Acc 0.410
Round  43, Average loss 2.874, Acc 0.401
Round  44, Average loss 2.493, Acc 0.401
Round  45, Average loss 2.895, Acc 0.385
Round  46, Average loss 2.545, Acc 0.389
Round  47, Average loss 2.908, Acc 0.363
Round  48, Average loss 2.565, Acc 0.375
Round  49, Average loss 2.915, Acc 0.363
Round  50, Average loss 2.578, Acc 0.383
Round  51, Average loss 2.892, Acc 0.378
Round  52, Average loss 2.518, Acc 0.376
Round  53, Average loss 2.902, Acc 0.377
Round  54, Average loss 2.506, Acc 0.379
Round  55, Average loss 2.913, Acc 0.390
Round  56, Average loss 2.497, Acc 0.380
Round  57, Average loss 2.898, Acc 0.378
Round  58, Average loss 2.516, Acc 0.374
0.010935
Round  59, Average loss 2.913, Acc 0.375
Round  60, Average loss 2.558, Acc 0.368
Round  61, Average loss 2.906, Acc 0.374
Round  62, Average loss 2.569, Acc 0.376
Round  63, Average loss 2.894, Acc 0.381
Round  64, Average loss 2.548, Acc 0.371
Round  65, Average loss 2.888, Acc 0.376
Round  66, Average loss 2.540, Acc 0.382
Round  67, Average loss 2.891, Acc 0.347
Round  68, Average loss 2.562, Acc 0.370
Round  69, Average loss 2.884, Acc 0.298
Round  70, Average loss 2.579, Acc 0.379
Round  71, Average loss 2.888, Acc 0.336
Round  72, Average loss 2.604, Acc 0.384
Round  73, Average loss 2.869, Acc 0.377
Round  74, Average loss 2.560, Acc 0.386
Round  75, Average loss 2.901, Acc 0.383
Round  76, Average loss 2.568, Acc 0.384
Round  77, Average loss 2.898, Acc 0.384
Round  78, Average loss 2.558, Acc 0.380
0.009841500000000001
Round  79, Average loss 2.904, Acc 0.385
Round  80, Average loss 2.592, Acc 0.379
Round  81, Average loss 2.892, Acc 0.385
Round  82, Average loss 2.593, Acc 0.376
Round  83, Average loss 2.898, Acc 0.384
Round  84, Average loss 2.618, Acc 0.371
Round  85, Average loss 2.902, Acc 0.390
Round  86, Average loss 2.593, Acc 0.378
Round  87, Average loss 2.868, Acc 0.385
Round  88, Average loss 2.592, Acc 0.375
Round  89, Average loss 2.877, Acc 0.395
Round  90, Average loss 2.611, Acc 0.375
Round  91, Average loss 2.880, Acc 0.394
Round  92, Average loss 2.572, Acc 0.374
Round  93, Average loss 2.843, Acc 0.385
Round  94, Average loss 2.554, Acc 0.384
Round  95, Average loss 2.828, Acc 0.378
Round  96, Average loss 2.568, Acc 0.379
Round  97, Average loss 2.849, Acc 0.379
Round  98, Average loss 2.533, Acc 0.389
0.008857350000000002
Round  99, Average loss 2.838, Acc 0.378
Round 100, Average loss 2.614, Acc 0.381
Round 101, Average loss 2.847, Acc 0.377
Round 102, Average loss 2.593, Acc 0.385
Round 103, Average loss 2.835, Acc 0.380
Round 104, Average loss 2.609, Acc 0.378
Round 105, Average loss 2.829, Acc 0.379
Round 106, Average loss 2.591, Acc 0.380
Round 107, Average loss 2.838, Acc 0.383
Round 108, Average loss 2.560, Acc 0.386
Round 109, Average loss 2.817, Acc 0.382
Round 110, Average loss 2.577, Acc 0.383
Round 111, Average loss 2.821, Acc 0.379
Round 112, Average loss 2.572, Acc 0.397
Round 113, Average loss 2.798, Acc 0.379
Round 114, Average loss 2.573, Acc 0.398
Round 115, Average loss 2.809, Acc 0.383
Round 116, Average loss 2.541, Acc 0.385
Round 117, Average loss 2.821, Acc 0.380
Round 118, Average loss 2.561, Acc 0.386
0.007971615000000001
Round 119, Average loss 2.806, Acc 0.384
Round 120, Average loss 2.575, Acc 0.369
Round 121, Average loss 2.822, Acc 0.383
Round 122, Average loss 2.574, Acc 0.374
Round 123, Average loss 2.790, Acc 0.384
Round 124, Average loss 2.538, Acc 0.377
Round 125, Average loss 2.786, Acc 0.386
Round 126, Average loss 2.551, Acc 0.364
Round 127, Average loss 2.782, Acc 0.376
Round 128, Average loss 2.548, Acc 0.370
Round 129, Average loss 2.773, Acc 0.376
Round 130, Average loss 2.532, Acc 0.369
Round 131, Average loss 2.776, Acc 0.376
Round 132, Average loss 2.549, Acc 0.378
Round 133, Average loss 2.781, Acc 0.377
Round 134, Average loss 2.569, Acc 0.380
Round 135, Average loss 2.757, Acc 0.374
Round 136, Average loss 2.575, Acc 0.373
Round 137, Average loss 2.773, Acc 0.382
Round 138, Average loss 2.551, Acc 0.371
0.007174453500000001
Round 139, Average loss 2.779, Acc 0.379
Round 140, Average loss 2.578, Acc 0.374
Round 141, Average loss 2.790, Acc 0.387
Round 142, Average loss 2.564, Acc 0.361
Round 143, Average loss 2.747, Acc 0.367
Round 144, Average loss 2.565, Acc 0.385
Round 145, Average loss 2.696, Acc 0.372
Round 146, Average loss 2.557, Acc 0.387
Round 147, Average loss 2.723, Acc 0.371
Round 148, Average loss 2.563, Acc 0.387
Round 149, Average loss 2.703, Acc 0.375
Round 150, Average loss 2.537, Acc 0.386
Round 151, Average loss 2.710, Acc 0.372
Round 152, Average loss 2.554, Acc 0.387
Round 153, Average loss 2.711, Acc 0.377
Round 154, Average loss 2.537, Acc 0.387
Round 155, Average loss 2.735, Acc 0.387
Round 156, Average loss 2.531, Acc 0.392
Round 157, Average loss 2.734, Acc 0.385
Round 158, Average loss 2.564, Acc 0.397
0.006457008150000001
Round 159, Average loss 2.730, Acc 0.386
Round 160, Average loss 2.578, Acc 0.400
Round 161, Average loss 2.732, Acc 0.384
Round 162, Average loss 2.571, Acc 0.402
Round 163, Average loss 2.735, Acc 0.387
Round 164, Average loss 2.566, Acc 0.402
Round 165, Average loss 2.723, Acc 0.400
Round 166, Average loss 2.555, Acc 0.403
Round 167, Average loss 2.746, Acc 0.408
Round 168, Average loss 2.545, Acc 0.394
Round 169, Average loss 2.733, Acc 0.409
Round 170, Average loss 2.544, Acc 0.397
Round 171, Average loss 2.736, Acc 0.408
Round 172, Average loss 2.558, Acc 0.387
Round 173, Average loss 2.761, Acc 0.402
Round 174, Average loss 2.555, Acc 0.399
Round 175, Average loss 2.732, Acc 0.397
Round 176, Average loss 2.564, Acc 0.411
Round 177, Average loss 2.709, Acc 0.401
Round 178, Average loss 2.547, Acc 0.401
0.005811307335000002
Round 179, Average loss 2.731, Acc 0.398
Round 180, Average loss 2.582, Acc 0.412
Round 181, Average loss 2.701, Acc 0.402
Round 182, Average loss 2.607, Acc 0.408
Round 183, Average loss 2.728, Acc 0.403
Round 184, Average loss 2.594, Acc 0.411
Round 185, Average loss 2.713, Acc 0.406
Round 186, Average loss 2.576, Acc 0.412
Round 187, Average loss 2.729, Acc 0.402
Round 188, Average loss 2.580, Acc 0.411
Round 189, Average loss 2.727, Acc 0.407
Round 190, Average loss 2.609, Acc 0.410
Round 191, Average loss 2.729, Acc 0.410
Round 192, Average loss 2.588, Acc 0.411
Round 193, Average loss 2.722, Acc 0.410
Round 194, Average loss 2.583, Acc 0.411
Round 195, Average loss 2.734, Acc 0.410
Round 196, Average loss 2.583, Acc 0.411
Round 197, Average loss 2.732, Acc 0.410
Round 198, Average loss 2.570, Acc 0.412
0.005230176601500001
Round 199, Average loss 2.723, Acc 0.408
Round 200, Average loss 2.593, Acc 0.412
Round 201, Average loss 2.715, Acc 0.409
Round 202, Average loss 2.603, Acc 0.411
Round 203, Average loss 2.726, Acc 0.410
Round 204, Average loss 2.588, Acc 0.412
Round 205, Average loss 2.718, Acc 0.410
Round 206, Average loss 2.596, Acc 0.413
Round 207, Average loss 2.718, Acc 0.410
Round 208, Average loss 2.612, Acc 0.412
Round 209, Average loss 2.702, Acc 0.411
Round 210, Average loss 2.593, Acc 0.412
Round 211, Average loss 2.719, Acc 0.411
Round 212, Average loss 2.568, Acc 0.411
Round 213, Average loss 2.697, Acc 0.411
Round 214, Average loss 2.571, Acc 0.410
Round 215, Average loss 2.711, Acc 0.410
Round 216, Average loss 2.553, Acc 0.410
Round 217, Average loss 2.711, Acc 0.410
Round 218, Average loss 2.566, Acc 0.411
0.004707158941350001
Round 219, Average loss 2.678, Acc 0.410
Round 220, Average loss 2.563, Acc 0.411
Round 221, Average loss 2.704, Acc 0.410
Round 222, Average loss 2.567, Acc 0.410
Round 223, Average loss 2.703, Acc 0.410
Round 224, Average loss 2.575, Acc 0.410
Round 225, Average loss 2.690, Acc 0.410
Round 226, Average loss 2.562, Acc 0.410
Round 227, Average loss 2.684, Acc 0.410
Round 228, Average loss 2.545, Acc 0.410
Round 229, Average loss 2.697, Acc 0.409
Round 230, Average loss 2.552, Acc 0.405
Round 231, Average loss 2.680, Acc 0.410
Round 232, Average loss 2.548, Acc 0.402
Round 233, Average loss 2.681, Acc 0.408
Round 234, Average loss 2.571, Acc 0.408
Round 235, Average loss 2.668, Acc 0.405
Round 236, Average loss 2.553, Acc 0.408
Round 237, Average loss 2.674, Acc 0.404
Round 238, Average loss 2.546, Acc 0.408
0.004236443047215001
Round 239, Average loss 2.662, Acc 0.401
Round 240, Average loss 2.564, Acc 0.410
Round 241, Average loss 2.653, Acc 0.400
Round 242, Average loss 2.556, Acc 0.402
Round 243, Average loss 2.670, Acc 0.402
Round 244, Average loss 2.548, Acc 0.401
Round 245, Average loss 2.671, Acc 0.403
Round 246, Average loss 2.536, Acc 0.400
Round 247, Average loss 2.680, Acc 0.400
Round 248, Average loss 2.562, Acc 0.402
Round 249, Average loss 2.662, Acc 0.401
Round 250, Average loss 2.550, Acc 0.404
Round 251, Average loss 2.661, Acc 0.410
Round 252, Average loss 2.542, Acc 0.403
Round 253, Average loss 2.675, Acc 0.410
Round 254, Average loss 2.558, Acc 0.405
Round 255, Average loss 2.679, Acc 0.410
Round 256, Average loss 2.559, Acc 0.410
Round 257, Average loss 2.664, Acc 0.410
Round 258, Average loss 2.556, Acc 0.411
0.003812798742493501
Round 259, Average loss 2.660, Acc 0.410
Round 260, Average loss 2.577, Acc 0.408
Round 261, Average loss 2.642, Acc 0.410
Round 262, Average loss 2.542, Acc 0.405
Round 263, Average loss 2.676, Acc 0.410
Round 264, Average loss 2.564, Acc 0.411
Round 265, Average loss 2.662, Acc 0.410
Round 266, Average loss 2.581, Acc 0.411
Round 267, Average loss 2.648, Acc 0.405
Round 268, Average loss 2.567, Acc 0.412
Round 269, Average loss 2.657, Acc 0.410
Round 270, Average loss 2.573, Acc 0.413
Round 271, Average loss 2.655, Acc 0.411
Round 272, Average loss 2.569, Acc 0.412
Round 273, Average loss 2.660, Acc 0.411
Round 274, Average loss 2.553, Acc 0.412
Round 275, Average loss 2.656, Acc 0.411
Round 276, Average loss 2.555, Acc 0.412
Round 277, Average loss 2.641, Acc 0.411
Round 278, Average loss 2.537, Acc 0.413
0.003431518868244151
Round 279, Average loss 2.647, Acc 0.411
Round 280, Average loss 2.576, Acc 0.411
Round 281, Average loss 2.661, Acc 0.411
Round 282, Average loss 2.573, Acc 0.413
Round 283, Average loss 2.640, Acc 0.411
Round 284, Average loss 2.589, Acc 0.412
Round 285, Average loss 2.651, Acc 0.412
Round 286, Average loss 2.566, Acc 0.412
Round 287, Average loss 2.654, Acc 0.412
Round 288, Average loss 2.580, Acc 0.412
Round 289, Average loss 2.667, Acc 0.411
Round 290, Average loss 2.578, Acc 0.412
Round 291, Average loss 2.666, Acc 0.411
Round 292, Average loss 2.587, Acc 0.412
Round 293, Average loss 2.681, Acc 0.411
Round 294, Average loss 2.578, Acc 0.412
Round 295, Average loss 2.670, Acc 0.412
Round 296, Average loss 2.571, Acc 0.413
Round 297, Average loss 2.641, Acc 0.411
Round 298, Average loss 2.572, Acc 0.413
0.0030883669814197362
Round 299, Average loss 2.646, Acc 0.412
145.27441883087158 s
Memory used: 1653.22 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=10, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.6574278] and score 2 is 0.0
Round   0, Average loss 3.241, Acc 0.000
score 1 is [0.72551733] and score 2 is 0.0
Round   1, Average loss 3.241, Acc 0.000
score 1 is [0.72706944] and score 2 is 0.0
Round   2, Average loss 3.241, Acc 0.000
score 1 is [0.7723241] and score 2 is 0.0
Round   3, Average loss 3.241, Acc 0.000
score 1 is [0.7409148] and score 2 is 0.0
Round   4, Average loss 3.241, Acc 0.000
10.368116617202759 s
Memory used: 1682.95 MB

3e-2 + 20
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=20, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.132, Acc 0.914
Round   1, Average loss 2.716, Acc 0.786
Round   2, Average loss 1.655, Acc 0.786
Round   3, Average loss 1.144, Acc 0.786
Round   4, Average loss 1.027, Acc 0.786
Round   5, Average loss 1.166, Acc 0.569
Round   6, Average loss 1.857, Acc 0.785
Round   7, Average loss 0.940, Acc 0.793
Round   8, Average loss 1.171, Acc 0.569
Round   9, Average loss 1.465, Acc 0.786
Round  10, Average loss 0.941, Acc 0.786
Round  11, Average loss 0.994, Acc 0.569
Round  12, Average loss 1.574, Acc 0.783
Round  13, Average loss 0.823, Acc 0.569
Round  14, Average loss 1.377, Acc 0.853
Round  15, Average loss 0.877, Acc 0.569
Round  16, Average loss 1.299, Acc 0.796
Round  17, Average loss 0.815, Acc 0.569
Round  18, Average loss 1.262, Acc 0.786
0.0135
Round  19, Average loss 0.882, Acc 0.642
Round  20, Average loss 0.931, Acc 0.786
Round  21, Average loss 0.883, Acc 0.688
Round  22, Average loss 0.932, Acc 0.785
Round  23, Average loss 0.946, Acc 0.618
Round  24, Average loss 0.923, Acc 0.785
Round  25, Average loss 1.026, Acc 0.569
Round  26, Average loss 0.950, Acc 0.217
Round  27, Average loss 1.168, Acc 0.786
Round  28, Average loss 0.837, Acc 0.569
Round  29, Average loss 1.543, Acc 0.759
Round  30, Average loss 0.996, Acc 0.569
Round  31, Average loss 1.522, Acc 0.753
Round  32, Average loss 0.789, Acc 0.759
Round  33, Average loss 1.869, Acc 0.569
Round  34, Average loss 1.058, Acc 0.328
Round  35, Average loss 1.155, Acc 0.217
Round  36, Average loss 1.694, Acc 0.569
Round  37, Average loss 0.898, Acc 0.785
Round  38, Average loss 1.179, Acc 0.569
0.01215
Round  39, Average loss 1.877, Acc 0.786
Round  40, Average loss 1.101, Acc 0.569
Round  41, Average loss 1.892, Acc 0.786
Round  42, Average loss 1.120, Acc 0.569
Round  43, Average loss 2.075, Acc 0.786
Round  44, Average loss 1.099, Acc 0.569
Round  45, Average loss 2.103, Acc 0.786
Round  46, Average loss 1.065, Acc 0.569
Round  47, Average loss 1.997, Acc 0.785
Round  48, Average loss 1.193, Acc 0.569
Round  49, Average loss 1.799, Acc 0.785
Round  50, Average loss 1.089, Acc 0.569
Round  51, Average loss 2.160, Acc 0.785
Round  52, Average loss 1.085, Acc 0.569
Round  53, Average loss 1.937, Acc 0.785
Round  54, Average loss 1.256, Acc 0.569
Round  55, Average loss 2.118, Acc 0.785
Round  56, Average loss 1.241, Acc 0.569
Round  57, Average loss 2.030, Acc 0.785
Round  58, Average loss 1.212, Acc 0.569
0.010935
Round  59, Average loss 2.110, Acc 0.786
Round  60, Average loss 1.015, Acc 0.569
Round  61, Average loss 2.076, Acc 0.786
Round  62, Average loss 1.156, Acc 0.569
Round  63, Average loss 2.193, Acc 0.786
Round  64, Average loss 1.099, Acc 0.569
Round  65, Average loss 2.074, Acc 0.786
Round  66, Average loss 1.133, Acc 0.569
Round  67, Average loss 2.023, Acc 0.786
Round  68, Average loss 1.224, Acc 0.569
Round  69, Average loss 2.063, Acc 0.785
Round  70, Average loss 1.216, Acc 0.569
Round  71, Average loss 1.890, Acc 0.217
Round  72, Average loss 1.148, Acc 0.785
Round  73, Average loss 2.047, Acc 0.569
Round  74, Average loss 1.588, Acc 0.204
Round  75, Average loss 1.201, Acc 0.217
Round  76, Average loss 2.206, Acc 0.569
Round  77, Average loss 1.811, Acc 0.217
Round  78, Average loss 1.497, Acc 0.217
0.009841500000000001
Round  79, Average loss 2.347, Acc 0.569
Round  80, Average loss 1.486, Acc 0.585
Round  81, Average loss 1.368, Acc 0.786
Round  82, Average loss 1.585, Acc 0.569
Round  83, Average loss 1.541, Acc 0.569
Round  84, Average loss 2.436, Acc 0.574
Round  85, Average loss 1.170, Acc 0.569
Round  86, Average loss 2.159, Acc 0.569
Round  87, Average loss 1.074, Acc 0.569
Round  88, Average loss 2.121, Acc 0.573
Round  89, Average loss 1.012, Acc 0.569
Round  90, Average loss 2.146, Acc 0.572
Round  91, Average loss 1.043, Acc 0.569
Round  92, Average loss 2.210, Acc 0.573
Round  93, Average loss 1.087, Acc 0.569
Round  94, Average loss 2.337, Acc 0.569
Round  95, Average loss 0.943, Acc 0.569
Round  96, Average loss 2.305, Acc 0.569
Round  97, Average loss 0.975, Acc 0.569
Round  98, Average loss 2.399, Acc 0.569
0.008857350000000002
Round  99, Average loss 1.012, Acc 0.569
Round 100, Average loss 2.424, Acc 0.569
Round 101, Average loss 1.041, Acc 0.569
Round 102, Average loss 2.238, Acc 0.569
Round 103, Average loss 1.214, Acc 0.569
Round 104, Average loss 2.519, Acc 0.569
Round 105, Average loss 1.073, Acc 0.569
Round 106, Average loss 2.060, Acc 0.217
Round 107, Average loss 1.540, Acc 0.785
Round 108, Average loss 2.151, Acc 0.569
Round 109, Average loss 2.212, Acc 0.785
Round 110, Average loss 1.486, Acc 0.569
Round 111, Average loss 1.647, Acc 0.786
Round 112, Average loss 1.306, Acc 0.785
Round 113, Average loss 1.463, Acc 0.569
Round 114, Average loss 1.705, Acc 0.785
Round 115, Average loss 0.986, Acc 0.569
Round 116, Average loss 1.388, Acc 0.569
Round 117, Average loss 1.852, Acc 0.783
Round 118, Average loss 0.910, Acc 0.569
0.007971615000000001
Round 119, Average loss 1.840, Acc 0.786
Round 120, Average loss 0.907, Acc 0.569
Round 121, Average loss 1.410, Acc 0.569
Round 122, Average loss 1.559, Acc 0.786
Round 123, Average loss 0.923, Acc 0.786
Round 124, Average loss 1.240, Acc 0.569
Round 125, Average loss 1.496, Acc 0.786
Round 126, Average loss 0.846, Acc 0.786
Round 127, Average loss 1.353, Acc 0.569
Round 128, Average loss 1.290, Acc 0.786
Round 129, Average loss 0.802, Acc 0.786
Round 130, Average loss 1.335, Acc 0.569
Round 131, Average loss 1.576, Acc 0.786
Round 132, Average loss 0.845, Acc 0.569
Round 133, Average loss 1.532, Acc 0.786
Round 134, Average loss 0.931, Acc 0.569
Round 135, Average loss 1.667, Acc 0.786
Round 136, Average loss 0.848, Acc 0.569
Round 137, Average loss 1.579, Acc 0.785
Round 138, Average loss 0.940, Acc 0.569
0.007174453500000001
Round 139, Average loss 1.478, Acc 0.217
Round 140, Average loss 1.210, Acc 0.569
Round 141, Average loss 1.366, Acc 0.218
Round 142, Average loss 1.154, Acc 0.569
Round 143, Average loss 1.415, Acc 0.217
Round 144, Average loss 1.076, Acc 0.569
Round 145, Average loss 1.313, Acc 0.217
Round 146, Average loss 1.170, Acc 0.217
Round 147, Average loss 1.650, Acc 0.569
Round 148, Average loss 1.345, Acc 0.590
Round 149, Average loss 0.967, Acc 0.569
Round 150, Average loss 1.790, Acc 0.584
Round 151, Average loss 0.991, Acc 0.569
Round 152, Average loss 1.804, Acc 0.573
Round 153, Average loss 0.919, Acc 0.569
Round 154, Average loss 1.796, Acc 0.570
Round 155, Average loss 0.967, Acc 0.569
Round 156, Average loss 1.780, Acc 0.569
Round 157, Average loss 0.997, Acc 0.569
Round 158, Average loss 1.814, Acc 0.745
0.006457008150000001
Round 159, Average loss 0.835, Acc 0.569
Round 160, Average loss 1.470, Acc 0.569
Round 161, Average loss 1.529, Acc 0.785
Round 162, Average loss 0.813, Acc 0.569
Round 163, Average loss 1.176, Acc 0.569
Round 164, Average loss 1.464, Acc 0.791
Round 165, Average loss 0.703, Acc 0.732
Round 166, Average loss 1.131, Acc 0.569
Round 167, Average loss 1.286, Acc 0.775
Round 168, Average loss 0.773, Acc 0.569
Round 169, Average loss 1.289, Acc 0.577
Round 170, Average loss 1.040, Acc 0.569
Round 171, Average loss 1.690, Acc 0.572
Round 172, Average loss 0.936, Acc 0.569
Round 173, Average loss 1.873, Acc 0.570
Round 174, Average loss 0.903, Acc 0.569
Round 175, Average loss 1.594, Acc 0.569
Round 176, Average loss 0.991, Acc 0.569
Round 177, Average loss 1.674, Acc 0.569
Round 178, Average loss 0.996, Acc 0.569
0.005811307335000002
Round 179, Average loss 1.568, Acc 0.569
Round 180, Average loss 0.944, Acc 0.569
Round 181, Average loss 1.649, Acc 0.569
Round 182, Average loss 0.943, Acc 0.569
Round 183, Average loss 1.551, Acc 0.569
Round 184, Average loss 0.977, Acc 0.569
Round 185, Average loss 1.459, Acc 0.569
Round 186, Average loss 1.003, Acc 0.569
Round 187, Average loss 1.492, Acc 0.569
Round 188, Average loss 1.015, Acc 0.569
Round 189, Average loss 1.717, Acc 0.569
Round 190, Average loss 1.089, Acc 0.569
Round 191, Average loss 1.594, Acc 0.569
Round 192, Average loss 0.986, Acc 0.569
Round 193, Average loss 1.609, Acc 0.569
Round 194, Average loss 0.960, Acc 0.569
Round 195, Average loss 1.463, Acc 0.569
Round 196, Average loss 0.976, Acc 0.569
Round 197, Average loss 1.445, Acc 0.569
Round 198, Average loss 0.994, Acc 0.569
0.005230176601500001
Round 199, Average loss 1.493, Acc 0.569
Round 200, Average loss 1.007, Acc 0.569
Round 201, Average loss 1.337, Acc 0.569
Round 202, Average loss 1.171, Acc 0.569
Round 203, Average loss 1.413, Acc 0.569
Round 204, Average loss 0.950, Acc 0.569
Round 205, Average loss 1.326, Acc 0.569
Round 206, Average loss 0.983, Acc 0.569
Round 207, Average loss 1.441, Acc 0.570
Round 208, Average loss 0.917, Acc 0.569
Round 209, Average loss 1.360, Acc 0.570
Round 210, Average loss 0.871, Acc 0.569
Round 211, Average loss 1.137, Acc 0.569
Round 212, Average loss 0.929, Acc 0.569
Round 213, Average loss 1.343, Acc 0.569
Round 214, Average loss 0.938, Acc 0.569
Round 215, Average loss 1.183, Acc 0.569
Round 216, Average loss 1.062, Acc 0.569
Round 217, Average loss 1.226, Acc 0.569
Round 218, Average loss 0.990, Acc 0.569
0.004707158941350001
Round 219, Average loss 1.219, Acc 0.569
Round 220, Average loss 1.013, Acc 0.569
Round 221, Average loss 1.296, Acc 0.569
Round 222, Average loss 1.100, Acc 0.569
Round 223, Average loss 1.287, Acc 0.569
Round 224, Average loss 1.073, Acc 0.569
Round 225, Average loss 1.283, Acc 0.569
Round 226, Average loss 1.115, Acc 0.569
Round 227, Average loss 1.285, Acc 0.569
Round 228, Average loss 1.043, Acc 0.569
Round 229, Average loss 1.420, Acc 0.569
Round 230, Average loss 1.071, Acc 0.569
Round 231, Average loss 1.305, Acc 0.569
Round 232, Average loss 1.014, Acc 0.569
Round 233, Average loss 1.439, Acc 0.569
Round 234, Average loss 1.058, Acc 0.569
Round 235, Average loss 1.406, Acc 0.569
Round 236, Average loss 1.182, Acc 0.569
Round 237, Average loss 1.490, Acc 0.569
Round 238, Average loss 1.146, Acc 0.569
0.004236443047215001
Round 239, Average loss 1.311, Acc 0.569
Round 240, Average loss 1.121, Acc 0.569
Round 241, Average loss 1.309, Acc 0.569
Round 242, Average loss 1.132, Acc 0.569
Round 243, Average loss 1.231, Acc 0.569
Round 244, Average loss 1.145, Acc 0.569
Round 245, Average loss 1.165, Acc 0.569
Round 246, Average loss 1.065, Acc 0.569
Round 247, Average loss 1.157, Acc 0.569
Round 248, Average loss 1.111, Acc 0.569
Round 249, Average loss 1.360, Acc 0.569
Round 250, Average loss 1.121, Acc 0.569
Round 251, Average loss 1.291, Acc 0.569
Round 252, Average loss 1.148, Acc 0.569
Round 253, Average loss 1.211, Acc 0.569
Round 254, Average loss 1.029, Acc 0.569
Round 255, Average loss 1.262, Acc 0.569
Round 256, Average loss 1.087, Acc 0.569
Round 257, Average loss 1.199, Acc 0.569
Round 258, Average loss 1.114, Acc 0.569
0.003812798742493501
Round 259, Average loss 1.318, Acc 0.569
Round 260, Average loss 1.124, Acc 0.569
Round 261, Average loss 1.322, Acc 0.569
Round 262, Average loss 1.035, Acc 0.569
Round 263, Average loss 1.303, Acc 0.569
Round 264, Average loss 1.146, Acc 0.569
Round 265, Average loss 1.225, Acc 0.569
Round 266, Average loss 1.091, Acc 0.569
Round 267, Average loss 1.237, Acc 0.569
Round 268, Average loss 1.021, Acc 0.569
Round 269, Average loss 1.301, Acc 0.569
Round 270, Average loss 1.155, Acc 0.569
Round 271, Average loss 1.203, Acc 0.569
Round 272, Average loss 1.082, Acc 0.569
Round 273, Average loss 1.236, Acc 0.569
Round 274, Average loss 1.147, Acc 0.569
Round 275, Average loss 1.216, Acc 0.569
Round 276, Average loss 1.089, Acc 0.569
Round 277, Average loss 1.117, Acc 0.569
Round 278, Average loss 1.082, Acc 0.569
0.003431518868244151
Round 279, Average loss 1.251, Acc 0.569
Round 280, Average loss 1.009, Acc 0.569
Round 281, Average loss 1.153, Acc 0.569
Round 282, Average loss 1.030, Acc 0.569
Round 283, Average loss 1.137, Acc 0.569
Round 284, Average loss 1.045, Acc 0.569
Round 285, Average loss 1.201, Acc 0.569
Round 286, Average loss 1.065, Acc 0.569
Round 287, Average loss 1.206, Acc 0.569
Round 288, Average loss 1.061, Acc 0.569
Round 289, Average loss 1.307, Acc 0.569
Round 290, Average loss 1.057, Acc 0.569
Round 291, Average loss 1.209, Acc 0.569
Round 292, Average loss 1.022, Acc 0.569
Round 293, Average loss 1.197, Acc 0.569
Round 294, Average loss 1.053, Acc 0.569
Round 295, Average loss 1.174, Acc 0.569
Round 296, Average loss 1.006, Acc 0.569
Round 297, Average loss 1.262, Acc 0.569
Round 298, Average loss 1.054, Acc 0.569
0.0030883669814197362
Round 299, Average loss 1.210, Acc 0.569
159.62069153785706 s
Memory used: 1651.38 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=20, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.84410065] and score 2 is 0.0
Round   0, Average loss 3.245, Acc 0.000
score 1 is [0.92413163] and score 2 is 0.0
Round   1, Average loss 3.245, Acc 0.000
score 1 is [0.84241134] and score 2 is 0.0
Round   2, Average loss 3.163, Acc 0.000
score 1 is [0.80851847] and score 2 is 0.0
Round   3, Average loss 3.044, Acc 0.000
score 1 is [0.84948564] and score 2 is 0.0
Round   4, Average loss 3.167, Acc 0.000
11.381094932556152 s
Memory used: 1679.16 MB

3e-2 + 30
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=30, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.212, Acc 0.570
Round   1, Average loss 2.665, Acc 0.571
Round   2, Average loss 1.584, Acc 0.581
Round   3, Average loss 1.113, Acc 0.677
Round   4, Average loss 0.826, Acc 0.569
Round   5, Average loss 1.141, Acc 0.754
Round   6, Average loss 0.873, Acc 0.196
Round   7, Average loss 2.041, Acc 0.786
Round   8, Average loss 0.881, Acc 0.217
Round   9, Average loss 1.641, Acc 0.768
Round  10, Average loss 0.694, Acc 0.904
Round  11, Average loss 0.940, Acc 0.217
Round  12, Average loss 1.606, Acc 0.217
Round  13, Average loss 1.185, Acc 0.217
Round  14, Average loss 1.953, Acc 0.785
Round  15, Average loss 0.844, Acc 0.786
Round  16, Average loss 0.819, Acc 0.786
Round  17, Average loss 1.165, Acc 0.217
Round  18, Average loss 5.285, Acc 0.217
0.0135
Round  19, Average loss 1.840, Acc 0.217
Round  20, Average loss 1.311, Acc 0.785
Round  21, Average loss 0.775, Acc 0.786
Round  22, Average loss 0.529, Acc 0.786
Round  23, Average loss 0.711, Acc 0.217
Round  24, Average loss 3.263, Acc 0.785
Round  25, Average loss 0.823, Acc 0.786
Round  26, Average loss 0.790, Acc 0.217
Round  27, Average loss 2.003, Acc 0.786
Round  28, Average loss 0.746, Acc 0.786
Round  29, Average loss 1.004, Acc 0.785
Round  30, Average loss 1.032, Acc 0.786
Round  31, Average loss 0.994, Acc 0.786
Round  32, Average loss 1.395, Acc 0.785
Round  33, Average loss 1.334, Acc 0.785
Round  34, Average loss 1.041, Acc 0.785
Round  35, Average loss 1.783, Acc 0.785
Round  36, Average loss 0.955, Acc 0.785
Round  37, Average loss 1.296, Acc 0.786
Round  38, Average loss 0.942, Acc 0.785
0.01215
Round  39, Average loss 1.381, Acc 0.786
Round  40, Average loss 0.923, Acc 0.785
Round  41, Average loss 1.557, Acc 0.786
Round  42, Average loss 0.880, Acc 0.785
Round  43, Average loss 1.251, Acc 0.786
Round  44, Average loss 0.999, Acc 0.785
Round  45, Average loss 1.358, Acc 0.786
Round  46, Average loss 0.970, Acc 0.785
Round  47, Average loss 1.019, Acc 0.786
Round  48, Average loss 0.984, Acc 0.217
Round  49, Average loss 1.308, Acc 0.786
Round  50, Average loss 0.631, Acc 0.785
Round  51, Average loss 0.770, Acc 0.929
Round  52, Average loss 0.415, Acc 0.923
Round  53, Average loss 0.596, Acc 0.923
Round  54, Average loss 0.468, Acc 0.357
Round  55, Average loss 1.344, Acc 0.785
Round  56, Average loss 0.592, Acc 0.360
Round  57, Average loss 1.410, Acc 0.785
Round  58, Average loss 0.751, Acc 0.358
0.010935
Round  59, Average loss 1.940, Acc 0.934
Round  60, Average loss 0.616, Acc 0.217
Round  61, Average loss 1.715, Acc 0.931
Round  62, Average loss 0.476, Acc 0.217
Round  63, Average loss 1.887, Acc 0.855
Round  64, Average loss 0.495, Acc 0.217
Round  65, Average loss 2.112, Acc 0.785
Round  66, Average loss 0.791, Acc 0.217
Round  67, Average loss 1.383, Acc 0.921
Round  68, Average loss 0.525, Acc 0.342
Round  69, Average loss 1.327, Acc 0.924
Round  70, Average loss 0.467, Acc 0.250
Round  71, Average loss 1.763, Acc 0.901
Round  72, Average loss 0.605, Acc 0.859
Round  73, Average loss 0.656, Acc 0.930
Round  74, Average loss 0.698, Acc 0.931
Round  75, Average loss 0.716, Acc 0.929
Round  76, Average loss 0.610, Acc 0.875
Round  77, Average loss 0.659, Acc 0.927
Round  78, Average loss 0.655, Acc 0.921
0.009841500000000001
Round  79, Average loss 0.629, Acc 0.935
Round  80, Average loss 0.511, Acc 0.931
Round  81, Average loss 0.712, Acc 0.938
Round  82, Average loss 0.441, Acc 0.929
Round  83, Average loss 0.618, Acc 0.961
Round  84, Average loss 0.448, Acc 0.937
Round  85, Average loss 0.392, Acc 0.929
Round  86, Average loss 0.531, Acc 0.925
Round  87, Average loss 0.717, Acc 0.926
Round  88, Average loss 0.658, Acc 0.931
Round  89, Average loss 0.815, Acc 0.932
Round  90, Average loss 0.402, Acc 0.936
Round  91, Average loss 0.645, Acc 0.934
Round  92, Average loss 0.608, Acc 0.941
Round  93, Average loss 0.829, Acc 0.918
Round  94, Average loss 0.593, Acc 0.929
Round  95, Average loss 0.608, Acc 0.336
Round  96, Average loss 1.076, Acc 0.937
Round  97, Average loss 0.449, Acc 0.929
Round  98, Average loss 0.837, Acc 0.942
0.008857350000000002
Round  99, Average loss 0.505, Acc 0.941
Round 100, Average loss 0.437, Acc 0.959
Round 101, Average loss 0.419, Acc 0.785
Round 102, Average loss 0.752, Acc 0.933
Round 103, Average loss 0.734, Acc 0.785
Round 104, Average loss 0.692, Acc 0.785
Round 105, Average loss 0.725, Acc 0.949
Round 106, Average loss 0.601, Acc 0.785
Round 107, Average loss 1.055, Acc 0.921
Round 108, Average loss 0.553, Acc 0.785
Round 109, Average loss 0.636, Acc 0.928
Round 110, Average loss 0.551, Acc 0.785
Round 111, Average loss 0.815, Acc 0.938
Round 112, Average loss 0.413, Acc 0.822
Round 113, Average loss 0.652, Acc 0.959
Round 114, Average loss 0.376, Acc 0.896
Round 115, Average loss 0.732, Acc 0.961
Round 116, Average loss 0.375, Acc 0.785
Round 117, Average loss 0.895, Acc 0.939
Round 118, Average loss 0.465, Acc 0.785
0.007971615000000001
Round 119, Average loss 1.175, Acc 0.918
Round 120, Average loss 0.572, Acc 0.785
Round 121, Average loss 0.813, Acc 0.938
Round 122, Average loss 0.456, Acc 0.785
Round 123, Average loss 0.636, Acc 0.938
Round 124, Average loss 0.434, Acc 0.792
Round 125, Average loss 0.590, Acc 0.960
Round 126, Average loss 0.418, Acc 0.923
Round 127, Average loss 0.572, Acc 0.968
Round 128, Average loss 0.452, Acc 0.794
Round 129, Average loss 0.582, Acc 0.968
Round 130, Average loss 0.406, Acc 0.796
Round 131, Average loss 0.712, Acc 0.968
Round 132, Average loss 0.304, Acc 0.796
Round 133, Average loss 0.419, Acc 0.968
Round 134, Average loss 0.365, Acc 0.793
Round 135, Average loss 0.435, Acc 0.968
Round 136, Average loss 0.313, Acc 0.786
Round 137, Average loss 0.615, Acc 0.967
Round 138, Average loss 0.306, Acc 0.790
0.007174453500000001
Round 139, Average loss 0.456, Acc 0.968
Round 140, Average loss 0.423, Acc 0.787
Round 141, Average loss 0.545, Acc 0.968
Round 142, Average loss 0.383, Acc 0.792
Round 143, Average loss 0.605, Acc 0.969
Round 144, Average loss 0.317, Acc 0.797
Round 145, Average loss 0.480, Acc 0.969
Round 146, Average loss 0.333, Acc 0.791
Round 147, Average loss 0.595, Acc 0.969
Round 148, Average loss 0.335, Acc 0.790
Round 149, Average loss 0.556, Acc 0.969
Round 150, Average loss 0.348, Acc 0.790
Round 151, Average loss 0.629, Acc 0.969
Round 152, Average loss 0.414, Acc 0.797
Round 153, Average loss 0.569, Acc 0.969
Round 154, Average loss 0.413, Acc 0.792
Round 155, Average loss 0.514, Acc 0.969
Round 156, Average loss 0.358, Acc 0.790
Round 157, Average loss 0.751, Acc 0.960
Round 158, Average loss 0.386, Acc 0.790
0.006457008150000001
Round 159, Average loss 0.671, Acc 0.955
Round 160, Average loss 0.374, Acc 0.797
Round 161, Average loss 0.699, Acc 0.957
Round 162, Average loss 0.467, Acc 0.792
Round 163, Average loss 0.813, Acc 0.958
Round 164, Average loss 0.473, Acc 0.792
Round 165, Average loss 0.794, Acc 0.958
Round 166, Average loss 0.329, Acc 0.798
Round 167, Average loss 0.778, Acc 0.956
Round 168, Average loss 0.442, Acc 0.910
Round 169, Average loss 0.576, Acc 0.956
Round 170, Average loss 0.397, Acc 0.796
Round 171, Average loss 0.684, Acc 0.947
Round 172, Average loss 0.380, Acc 0.844
Round 173, Average loss 0.680, Acc 0.930
Round 174, Average loss 0.493, Acc 0.792
Round 175, Average loss 0.864, Acc 0.924
Round 176, Average loss 0.533, Acc 0.806
Round 177, Average loss 0.959, Acc 0.927
Round 178, Average loss 0.445, Acc 0.881
0.005811307335000002
Round 179, Average loss 0.593, Acc 0.911
Round 180, Average loss 0.417, Acc 0.845
Round 181, Average loss 0.815, Acc 0.911
Round 182, Average loss 0.582, Acc 0.889
Round 183, Average loss 0.820, Acc 0.902
Round 184, Average loss 0.526, Acc 0.914
Round 185, Average loss 0.628, Acc 0.809
Round 186, Average loss 0.615, Acc 0.926
Round 187, Average loss 0.494, Acc 0.792
Round 188, Average loss 0.937, Acc 0.924
Round 189, Average loss 0.408, Acc 0.842
Round 190, Average loss 0.808, Acc 0.924
Round 191, Average loss 0.413, Acc 0.801
Round 192, Average loss 1.050, Acc 0.906
Round 193, Average loss 0.647, Acc 0.267
Round 194, Average loss 0.933, Acc 0.909
Round 195, Average loss 0.677, Acc 0.805
Round 196, Average loss 0.961, Acc 0.914
Round 197, Average loss 0.631, Acc 0.268
Round 198, Average loss 1.173, Acc 0.920
0.005230176601500001
Round 199, Average loss 0.427, Acc 0.270
Round 200, Average loss 0.889, Acc 0.919
Round 201, Average loss 0.596, Acc 0.318
Round 202, Average loss 0.916, Acc 0.903
Round 203, Average loss 0.609, Acc 0.862
Round 204, Average loss 0.881, Acc 0.842
Round 205, Average loss 0.705, Acc 0.926
Round 206, Average loss 0.678, Acc 0.856
Round 207, Average loss 0.711, Acc 0.940
Round 208, Average loss 0.440, Acc 0.341
Round 209, Average loss 0.894, Acc 0.962
Round 210, Average loss 0.388, Acc 0.338
Round 211, Average loss 0.822, Acc 0.960
Round 212, Average loss 0.464, Acc 0.334
Round 213, Average loss 0.950, Acc 0.962
Round 214, Average loss 0.442, Acc 0.338
Round 215, Average loss 0.877, Acc 0.961
Round 216, Average loss 0.395, Acc 0.335
Round 217, Average loss 0.908, Acc 0.956
Round 218, Average loss 0.461, Acc 0.278
0.004707158941350001
Round 219, Average loss 0.916, Acc 0.942
Round 220, Average loss 0.417, Acc 0.826
Round 221, Average loss 0.874, Acc 0.944
Round 222, Average loss 0.567, Acc 0.799
Round 223, Average loss 0.764, Acc 0.928
Round 224, Average loss 0.438, Acc 0.851
Round 225, Average loss 0.809, Acc 0.955
Round 226, Average loss 0.477, Acc 0.909
Round 227, Average loss 0.765, Acc 0.956
Round 228, Average loss 0.501, Acc 0.899
Round 229, Average loss 0.710, Acc 0.953
Round 230, Average loss 0.427, Acc 0.863
Round 231, Average loss 0.647, Acc 0.950
Round 232, Average loss 0.431, Acc 0.849
Round 233, Average loss 0.666, Acc 0.959
Round 234, Average loss 0.433, Acc 0.854
Round 235, Average loss 0.646, Acc 0.959
Round 236, Average loss 0.326, Acc 0.919
Round 237, Average loss 0.565, Acc 0.965
Round 238, Average loss 0.322, Acc 0.931
0.004236443047215001
Round 239, Average loss 0.478, Acc 0.970
Round 240, Average loss 0.385, Acc 0.945
Round 241, Average loss 0.521, Acc 0.977
Round 242, Average loss 0.427, Acc 0.934
Round 243, Average loss 0.516, Acc 0.979
Round 244, Average loss 0.332, Acc 0.944
Round 245, Average loss 0.581, Acc 0.981
Round 246, Average loss 0.347, Acc 0.974
Round 247, Average loss 0.408, Acc 0.981
Round 248, Average loss 0.358, Acc 0.978
Round 249, Average loss 0.564, Acc 0.978
Round 250, Average loss 0.403, Acc 0.977
Round 251, Average loss 0.432, Acc 0.981
Round 252, Average loss 0.346, Acc 0.963
Round 253, Average loss 0.607, Acc 0.981
Round 254, Average loss 0.323, Acc 0.973
Round 255, Average loss 0.591, Acc 0.981
Round 256, Average loss 0.445, Acc 0.977
Round 257, Average loss 0.558, Acc 0.921
Round 258, Average loss 0.426, Acc 0.979
0.003812798742493501
Round 259, Average loss 0.388, Acc 0.980
Round 260, Average loss 0.406, Acc 0.976
Round 261, Average loss 0.323, Acc 0.966
Round 262, Average loss 0.508, Acc 0.961
Round 263, Average loss 0.526, Acc 0.964
Round 264, Average loss 0.456, Acc 0.956
Round 265, Average loss 0.589, Acc 0.963
Round 266, Average loss 0.485, Acc 0.948
Round 267, Average loss 0.402, Acc 0.963
Round 268, Average loss 0.550, Acc 0.964
Round 269, Average loss 0.592, Acc 0.965
Round 270, Average loss 0.450, Acc 0.962
Round 271, Average loss 0.448, Acc 0.960
Round 272, Average loss 0.417, Acc 0.964
Round 273, Average loss 0.459, Acc 0.906
Round 274, Average loss 0.527, Acc 0.950
Round 275, Average loss 0.627, Acc 0.905
Round 276, Average loss 0.496, Acc 0.954
Round 277, Average loss 0.552, Acc 0.927
Round 278, Average loss 0.562, Acc 0.942
0.003431518868244151
Round 279, Average loss 0.659, Acc 0.883
Round 280, Average loss 0.615, Acc 0.933
Round 281, Average loss 0.697, Acc 0.882
Round 282, Average loss 0.583, Acc 0.924
Round 283, Average loss 0.579, Acc 0.952
Round 284, Average loss 0.534, Acc 0.933
Round 285, Average loss 0.620, Acc 0.953
Round 286, Average loss 0.463, Acc 0.925
Round 287, Average loss 0.600, Acc 0.925
Round 288, Average loss 0.473, Acc 0.937
Round 289, Average loss 0.553, Acc 0.958
Round 290, Average loss 0.558, Acc 0.935
Round 291, Average loss 0.681, Acc 0.956
Round 292, Average loss 0.459, Acc 0.935
Round 293, Average loss 0.683, Acc 0.955
Round 294, Average loss 0.562, Acc 0.959
Round 295, Average loss 0.722, Acc 0.954
Round 296, Average loss 0.593, Acc 0.935
Round 297, Average loss 0.643, Acc 0.948
Round 298, Average loss 0.624, Acc 0.931
0.0030883669814197362
Round 299, Average loss 0.497, Acc 0.948
178.8079981803894 s
Memory used: 1668.17 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=30, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.86174023] and score 2 is 0.0
Round   0, Average loss 3.091, Acc 0.009
score 1 is [0.77747566] and score 2 is 0.0
Round   1, Average loss 3.070, Acc 0.009
score 1 is [0.8245861] and score 2 is 0.0
Round   2, Average loss 3.208, Acc 0.009
score 1 is [0.8740361] and score 2 is 0.0
Round   3, Average loss 3.208, Acc 0.009
score 1 is [0.7924352] and score 2 is 0.0
Round   4, Average loss 3.224, Acc 0.009
9.773089408874512 s
Memory used: 1684.18 MB

3e-2 + 40
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=40, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.180, Acc 0.785
Round   1, Average loss 2.755, Acc 0.569
Round   2, Average loss 1.698, Acc 0.569
Round   3, Average loss 1.210, Acc 0.569
Round   4, Average loss 0.836, Acc 0.745
Round   5, Average loss 0.832, Acc 0.787
Round   6, Average loss 0.982, Acc 0.784
Round   7, Average loss 0.762, Acc 0.770
Round   8, Average loss 1.128, Acc 0.757
Round   9, Average loss 0.670, Acc 0.773
Round  10, Average loss 1.159, Acc 0.766
Round  11, Average loss 0.599, Acc 0.925
Round  12, Average loss 1.087, Acc 0.744
Round  13, Average loss 0.624, Acc 0.977
Round  14, Average loss 1.139, Acc 0.745
Round  15, Average loss 0.600, Acc 0.955
Round  16, Average loss 1.098, Acc 0.749
Round  17, Average loss 0.525, Acc 0.974
Round  18, Average loss 1.039, Acc 0.800
0.0135
Round  19, Average loss 0.530, Acc 0.929
Round  20, Average loss 0.883, Acc 0.916
Round  21, Average loss 0.327, Acc 0.935
Round  22, Average loss 0.788, Acc 0.890
Round  23, Average loss 0.355, Acc 0.970
Round  24, Average loss 0.687, Acc 0.967
Round  25, Average loss 0.200, Acc 0.960
Round  26, Average loss 0.519, Acc 0.977
Round  27, Average loss 0.290, Acc 0.939
Round  28, Average loss 0.353, Acc 0.911
Round  29, Average loss 0.507, Acc 0.981
Round  30, Average loss 0.148, Acc 0.982
Round  31, Average loss 0.651, Acc 0.943
Round  32, Average loss 0.344, Acc 0.965
Round  33, Average loss 0.303, Acc 0.933
Round  34, Average loss 0.618, Acc 0.936
Round  35, Average loss 0.448, Acc 0.859
Round  36, Average loss 0.418, Acc 0.978
Round  37, Average loss 0.204, Acc 0.372
Round  38, Average loss 1.234, Acc 0.953
0.01215
Round  39, Average loss 0.488, Acc 0.975
Round  40, Average loss 0.243, Acc 0.923
Round  41, Average loss 0.498, Acc 0.978
Round  42, Average loss 0.656, Acc 0.914
Round  43, Average loss 0.575, Acc 0.975
Round  44, Average loss 0.264, Acc 0.929
Round  45, Average loss 0.289, Acc 0.943
Round  46, Average loss 0.221, Acc 0.956
Round  47, Average loss 0.230, Acc 0.906
Round  48, Average loss 0.331, Acc 0.965
Round  49, Average loss 0.151, Acc 0.876
Round  50, Average loss 0.464, Acc 0.973
Round  51, Average loss 0.199, Acc 0.904
Round  52, Average loss 0.463, Acc 0.954
Round  53, Average loss 0.190, Acc 0.909
Round  54, Average loss 0.362, Acc 0.976
Round  55, Average loss 0.151, Acc 0.980
Round  56, Average loss 0.210, Acc 0.980
Round  57, Average loss 0.160, Acc 0.412
Round  58, Average loss 1.033, Acc 0.935
0.010935
Round  59, Average loss 0.210, Acc 0.980
Round  60, Average loss 0.188, Acc 0.977
Round  61, Average loss 0.265, Acc 0.976
Round  62, Average loss 0.205, Acc 0.975
Round  63, Average loss 0.212, Acc 0.970
Round  64, Average loss 0.160, Acc 0.980
Round  65, Average loss 0.220, Acc 0.949
Round  66, Average loss 0.297, Acc 0.978
Round  67, Average loss 0.207, Acc 0.955
Round  68, Average loss 0.205, Acc 0.981
Round  69, Average loss 0.186, Acc 0.976
Round  70, Average loss 0.117, Acc 0.954
Round  71, Average loss 0.307, Acc 0.981
Round  72, Average loss 0.289, Acc 0.942
Round  73, Average loss 0.270, Acc 0.981
Round  74, Average loss 0.213, Acc 0.963
Round  75, Average loss 0.262, Acc 0.979
Round  76, Average loss 0.296, Acc 0.975
Round  77, Average loss 0.265, Acc 0.940
Round  78, Average loss 0.330, Acc 0.966
0.009841500000000001
Round  79, Average loss 0.284, Acc 0.980
Round  80, Average loss 0.226, Acc 0.977
Round  81, Average loss 0.213, Acc 0.973
Round  82, Average loss 0.209, Acc 0.976
Round  83, Average loss 0.299, Acc 0.955
Round  84, Average loss 0.306, Acc 0.953
Round  85, Average loss 0.233, Acc 0.978
Round  86, Average loss 0.196, Acc 0.955
Round  87, Average loss 0.290, Acc 0.981
Round  88, Average loss 0.261, Acc 0.957
Round  89, Average loss 0.210, Acc 0.981
Round  90, Average loss 0.291, Acc 0.978
Round  91, Average loss 0.387, Acc 0.980
Round  92, Average loss 0.236, Acc 0.413
Round  93, Average loss 0.906, Acc 0.977
Round  94, Average loss 0.263, Acc 0.980
Round  95, Average loss 0.400, Acc 0.980
Round  96, Average loss 0.239, Acc 0.961
Round  97, Average loss 0.268, Acc 0.980
Round  98, Average loss 0.225, Acc 0.965
0.008857350000000002
Round  99, Average loss 0.249, Acc 0.978
Round 100, Average loss 0.315, Acc 0.971
Round 101, Average loss 0.210, Acc 0.957
Round 102, Average loss 0.244, Acc 0.977
Round 103, Average loss 0.307, Acc 0.954
Round 104, Average loss 0.298, Acc 0.979
Round 105, Average loss 0.234, Acc 0.944
Round 106, Average loss 0.290, Acc 0.976
Round 107, Average loss 0.289, Acc 0.971
Round 108, Average loss 0.267, Acc 0.961
Round 109, Average loss 0.183, Acc 0.980
Round 110, Average loss 0.272, Acc 0.963
Round 111, Average loss 0.321, Acc 0.979
Round 112, Average loss 0.234, Acc 0.970
Round 113, Average loss 0.190, Acc 0.945
Round 114, Average loss 0.382, Acc 0.977
Round 115, Average loss 0.246, Acc 0.962
Round 116, Average loss 0.237, Acc 0.964
Round 117, Average loss 0.199, Acc 0.952
Round 118, Average loss 0.331, Acc 0.975
0.007971615000000001
Round 119, Average loss 0.213, Acc 0.955
Round 120, Average loss 0.196, Acc 0.969
Round 121, Average loss 0.227, Acc 0.975
Round 122, Average loss 0.198, Acc 0.972
Round 123, Average loss 0.146, Acc 0.979
Round 124, Average loss 0.150, Acc 0.980
Round 125, Average loss 0.129, Acc 0.965
Round 126, Average loss 0.258, Acc 0.980
Round 127, Average loss 0.170, Acc 0.981
Round 128, Average loss 0.309, Acc 0.980
Round 129, Average loss 0.202, Acc 0.979
Round 130, Average loss 0.204, Acc 0.975
Round 131, Average loss 0.224, Acc 0.981
Round 132, Average loss 0.198, Acc 0.979
Round 133, Average loss 0.281, Acc 0.979
Round 134, Average loss 0.158, Acc 0.974
Round 135, Average loss 0.189, Acc 0.980
Round 136, Average loss 0.206, Acc 0.979
Round 137, Average loss 0.074, Acc 0.980
Round 138, Average loss 0.184, Acc 0.979
0.007174453500000001
Round 139, Average loss 0.355, Acc 0.970
Round 140, Average loss 0.272, Acc 0.980
Round 141, Average loss 0.276, Acc 0.969
Round 142, Average loss 0.205, Acc 0.979
Round 143, Average loss 0.219, Acc 0.962
Round 144, Average loss 0.185, Acc 0.980
Round 145, Average loss 0.235, Acc 0.960
Round 146, Average loss 0.263, Acc 0.978
Round 147, Average loss 0.113, Acc 0.971
Round 148, Average loss 0.118, Acc 0.979
Round 149, Average loss 0.175, Acc 0.969
Round 150, Average loss 0.251, Acc 0.978
Round 151, Average loss 0.122, Acc 0.968
Round 152, Average loss 0.265, Acc 0.979
Round 153, Average loss 0.178, Acc 0.963
Round 154, Average loss 0.198, Acc 0.978
Round 155, Average loss 0.253, Acc 0.976
Round 156, Average loss 0.389, Acc 0.967
Round 157, Average loss 0.292, Acc 0.979
Round 158, Average loss 0.137, Acc 0.969
0.006457008150000001
Round 159, Average loss 0.132, Acc 0.978
Round 160, Average loss 0.093, Acc 0.965
Round 161, Average loss 0.252, Acc 0.978
Round 162, Average loss 0.175, Acc 0.975
Round 163, Average loss 0.139, Acc 0.978
Round 164, Average loss 0.224, Acc 0.969
Round 165, Average loss 0.160, Acc 0.977
Round 166, Average loss 0.155, Acc 0.980
Round 167, Average loss 0.172, Acc 0.968
Round 168, Average loss 0.255, Acc 0.977
Round 169, Average loss 0.193, Acc 0.970
Round 170, Average loss 0.222, Acc 0.980
Round 171, Average loss 0.182, Acc 0.970
Round 172, Average loss 0.269, Acc 0.978
Round 173, Average loss 0.188, Acc 0.968
Round 174, Average loss 0.263, Acc 0.979
Round 175, Average loss 0.233, Acc 0.969
Round 176, Average loss 0.144, Acc 0.981
Round 177, Average loss 0.193, Acc 0.968
Round 178, Average loss 0.274, Acc 0.977
0.005811307335000002
Round 179, Average loss 0.136, Acc 0.981
Round 180, Average loss 0.251, Acc 0.969
Round 181, Average loss 0.147, Acc 0.981
Round 182, Average loss 0.232, Acc 0.969
Round 183, Average loss 0.153, Acc 0.968
Round 184, Average loss 0.189, Acc 0.969
Round 185, Average loss 0.269, Acc 0.970
Round 186, Average loss 0.194, Acc 0.969
Round 187, Average loss 0.218, Acc 0.981
Round 188, Average loss 0.220, Acc 0.969
Round 189, Average loss 0.179, Acc 0.980
Round 190, Average loss 0.144, Acc 0.970
Round 191, Average loss 0.165, Acc 0.981
Round 192, Average loss 0.120, Acc 0.970
Round 193, Average loss 0.218, Acc 0.981
Round 194, Average loss 0.138, Acc 0.970
Round 195, Average loss 0.265, Acc 0.981
Round 196, Average loss 0.169, Acc 0.970
Round 197, Average loss 0.139, Acc 0.980
Round 198, Average loss 0.195, Acc 0.971
0.005230176601500001
Round 199, Average loss 0.138, Acc 0.981
Round 200, Average loss 0.204, Acc 0.971
Round 201, Average loss 0.173, Acc 0.981
Round 202, Average loss 0.202, Acc 0.972
Round 203, Average loss 0.173, Acc 0.981
Round 204, Average loss 0.214, Acc 0.971
Round 205, Average loss 0.207, Acc 0.981
Round 206, Average loss 0.224, Acc 0.971
Round 207, Average loss 0.208, Acc 0.981
Round 208, Average loss 0.196, Acc 0.971
Round 209, Average loss 0.255, Acc 0.978
Round 210, Average loss 0.342, Acc 0.976
Round 211, Average loss 0.191, Acc 0.981
Round 212, Average loss 0.183, Acc 0.971
Round 213, Average loss 0.216, Acc 0.981
Round 214, Average loss 0.237, Acc 0.969
Round 215, Average loss 0.152, Acc 0.980
Round 216, Average loss 0.141, Acc 0.981
Round 217, Average loss 0.117, Acc 0.971
Round 218, Average loss 0.180, Acc 0.980
0.004707158941350001
Round 219, Average loss 0.090, Acc 0.976
Round 220, Average loss 0.176, Acc 0.981
Round 221, Average loss 0.208, Acc 0.972
Round 222, Average loss 0.116, Acc 0.981
Round 223, Average loss 0.145, Acc 0.969
Round 224, Average loss 0.181, Acc 0.979
Round 225, Average loss 0.152, Acc 0.981
Round 226, Average loss 0.128, Acc 0.977
Round 227, Average loss 0.168, Acc 0.970
Round 228, Average loss 0.182, Acc 0.980
Round 229, Average loss 0.145, Acc 0.975
Round 230, Average loss 0.160, Acc 0.979
Round 231, Average loss 0.170, Acc 0.980
Round 232, Average loss 0.219, Acc 0.965
Round 233, Average loss 0.145, Acc 0.981
Round 234, Average loss 0.226, Acc 0.976
Round 235, Average loss 0.079, Acc 0.978
Round 236, Average loss 0.161, Acc 0.977
Round 237, Average loss 0.206, Acc 0.980
Round 238, Average loss 0.127, Acc 0.978
0.004236443047215001
Round 239, Average loss 0.176, Acc 0.980
Round 240, Average loss 0.179, Acc 0.978
Round 241, Average loss 0.167, Acc 0.981
Round 242, Average loss 0.164, Acc 0.978
Round 243, Average loss 0.149, Acc 0.981
Round 244, Average loss 0.152, Acc 0.946
Round 245, Average loss 0.231, Acc 0.980
Round 246, Average loss 0.284, Acc 0.966
Round 247, Average loss 0.172, Acc 0.981
Round 248, Average loss 0.150, Acc 0.981
Round 249, Average loss 0.290, Acc 0.977
Round 250, Average loss 0.160, Acc 0.981
Round 251, Average loss 0.159, Acc 0.977
Round 252, Average loss 0.133, Acc 0.971
Round 253, Average loss 0.148, Acc 0.980
Round 254, Average loss 0.146, Acc 0.981
Round 255, Average loss 0.209, Acc 0.972
Round 256, Average loss 0.096, Acc 0.978
Round 257, Average loss 0.108, Acc 0.981
Round 258, Average loss 0.237, Acc 0.974
0.003812798742493501
Round 259, Average loss 0.201, Acc 0.981
Round 260, Average loss 0.214, Acc 0.982
Round 261, Average loss 0.109, Acc 0.981
Round 262, Average loss 0.134, Acc 0.982
Round 263, Average loss 0.128, Acc 0.983
Round 264, Average loss 0.135, Acc 0.980
Round 265, Average loss 0.089, Acc 0.981
Round 266, Average loss 0.159, Acc 0.981
Round 267, Average loss 0.193, Acc 0.981
Round 268, Average loss 0.218, Acc 0.979
Round 269, Average loss 0.136, Acc 0.981
Round 270, Average loss 0.160, Acc 0.979
Round 271, Average loss 0.187, Acc 0.977
Round 272, Average loss 0.248, Acc 0.981
Round 273, Average loss 0.218, Acc 0.982
Round 274, Average loss 0.134, Acc 0.981
Round 275, Average loss 0.144, Acc 0.981
Round 276, Average loss 0.234, Acc 0.978
Round 277, Average loss 0.204, Acc 0.981
Round 278, Average loss 0.136, Acc 0.977
0.003431518868244151
Round 279, Average loss 0.160, Acc 0.981
Round 280, Average loss 0.189, Acc 0.974
Round 281, Average loss 0.153, Acc 0.981
Round 282, Average loss 0.183, Acc 0.976
Round 283, Average loss 0.159, Acc 0.981
Round 284, Average loss 0.094, Acc 0.981
Round 285, Average loss 0.169, Acc 0.973
Round 286, Average loss 0.223, Acc 0.981
Round 287, Average loss 0.222, Acc 0.979
Round 288, Average loss 0.166, Acc 0.981
Round 289, Average loss 0.160, Acc 0.972
Round 290, Average loss 0.124, Acc 0.981
Round 291, Average loss 0.150, Acc 0.975
Round 292, Average loss 0.195, Acc 0.981
Round 293, Average loss 0.146, Acc 0.972
Round 294, Average loss 0.158, Acc 0.981
Round 295, Average loss 0.115, Acc 0.974
Round 296, Average loss 0.155, Acc 0.978
Round 297, Average loss 0.119, Acc 0.981
Round 298, Average loss 0.151, Acc 0.976
0.0030883669814197362
Round 299, Average loss 0.195, Acc 0.981
197.21541476249695 s
Memory used: 1667.24 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=40, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.88289887] and score 2 is 0.0
Round   0, Average loss 3.144, Acc 0.000
score 1 is [0.7777009] and score 2 is 0.0
Round   1, Average loss 3.153, Acc 0.000
score 1 is [0.93342644] and score 2 is 0.0
Round   2, Average loss 3.144, Acc 0.000
score 1 is [0.8722634] and score 2 is 0.0
Round   3, Average loss 3.195, Acc 0.000
score 1 is [0.8832067] and score 2 is 0.0
Round   4, Average loss 3.215, Acc 0.000
10.882074356079102 s
Memory used: 1659.73 MB

3e-2 + 50
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=50, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.146, Acc 0.569
Round   1, Average loss 2.581, Acc 0.569
Round   2, Average loss 1.637, Acc 0.569
Round   3, Average loss 1.055, Acc 0.744
Round   4, Average loss 0.829, Acc 0.744
Round   5, Average loss 0.646, Acc 0.757
Round   6, Average loss 0.639, Acc 0.792
Round   7, Average loss 0.489, Acc 0.916
Round   8, Average loss 0.554, Acc 0.785
Round   9, Average loss 0.585, Acc 0.968
Round  10, Average loss 0.446, Acc 0.789
Round  11, Average loss 0.637, Acc 0.969
Round  12, Average loss 0.422, Acc 0.793
Round  13, Average loss 0.628, Acc 0.967
Round  14, Average loss 0.581, Acc 0.805
Round  15, Average loss 0.451, Acc 0.970
Round  16, Average loss 0.495, Acc 0.833
Round  17, Average loss 0.373, Acc 0.970
Round  18, Average loss 0.536, Acc 0.931
0.0135
Round  19, Average loss 0.378, Acc 0.969
Round  20, Average loss 0.435, Acc 0.928
Round  21, Average loss 0.357, Acc 0.923
Round  22, Average loss 0.365, Acc 0.968
Round  23, Average loss 0.344, Acc 0.912
Round  24, Average loss 0.327, Acc 0.929
Round  25, Average loss 0.347, Acc 0.934
Round  26, Average loss 0.286, Acc 0.966
Round  27, Average loss 0.224, Acc 0.935
Round  28, Average loss 0.231, Acc 0.944
Round  29, Average loss 0.233, Acc 0.960
Round  30, Average loss 0.232, Acc 0.945
Round  31, Average loss 0.233, Acc 0.978
Round  32, Average loss 0.243, Acc 0.961
Round  33, Average loss 0.322, Acc 0.961
Round  34, Average loss 0.250, Acc 0.962
Round  35, Average loss 0.264, Acc 0.940
Round  36, Average loss 0.368, Acc 0.931
Round  37, Average loss 0.296, Acc 0.938
Round  38, Average loss 0.323, Acc 0.950
0.01215
Round  39, Average loss 0.235, Acc 0.913
Round  40, Average loss 0.419, Acc 0.961
Round  41, Average loss 0.197, Acc 0.982
Round  42, Average loss 0.335, Acc 0.971
Round  43, Average loss 0.363, Acc 0.964
Round  44, Average loss 0.220, Acc 0.936
Round  45, Average loss 0.332, Acc 0.969
Round  46, Average loss 0.175, Acc 0.980
Round  47, Average loss 0.140, Acc 0.972
Round  48, Average loss 0.201, Acc 0.979
Round  49, Average loss 0.147, Acc 0.981
Round  50, Average loss 0.239, Acc 0.978
Round  51, Average loss 0.152, Acc 0.979
Round  52, Average loss 0.153, Acc 0.973
Round  53, Average loss 0.175, Acc 0.975
Round  54, Average loss 0.174, Acc 0.978
Round  55, Average loss 0.168, Acc 0.973
Round  56, Average loss 0.180, Acc 0.976
Round  57, Average loss 0.274, Acc 0.973
Round  58, Average loss 0.219, Acc 0.975
0.010935
Round  59, Average loss 0.301, Acc 0.966
Round  60, Average loss 0.207, Acc 0.979
Round  61, Average loss 0.170, Acc 0.971
Round  62, Average loss 0.087, Acc 0.981
Round  63, Average loss 0.177, Acc 0.943
Round  64, Average loss 0.269, Acc 0.979
Round  65, Average loss 0.161, Acc 0.981
Round  66, Average loss 0.262, Acc 0.971
Round  67, Average loss 0.171, Acc 0.980
Round  68, Average loss 0.216, Acc 0.970
Round  69, Average loss 0.133, Acc 0.981
Round  70, Average loss 0.200, Acc 0.977
Round  71, Average loss 0.159, Acc 0.976
Round  72, Average loss 0.099, Acc 0.978
Round  73, Average loss 0.230, Acc 0.972
Round  74, Average loss 0.234, Acc 0.982
Round  75, Average loss 0.168, Acc 0.954
Round  76, Average loss 0.236, Acc 0.980
Round  77, Average loss 0.213, Acc 0.969
Round  78, Average loss 0.206, Acc 0.980
0.009841500000000001
Round  79, Average loss 0.176, Acc 0.978
Round  80, Average loss 0.137, Acc 0.981
Round  81, Average loss 0.139, Acc 0.983
Round  82, Average loss 0.090, Acc 0.982
Round  83, Average loss 0.130, Acc 0.982
Round  84, Average loss 0.129, Acc 0.981
Round  85, Average loss 0.111, Acc 0.966
Round  86, Average loss 0.133, Acc 0.980
Round  87, Average loss 0.066, Acc 0.981
Round  88, Average loss 0.158, Acc 0.981
Round  89, Average loss 0.134, Acc 0.981
Round  90, Average loss 0.195, Acc 0.981
Round  91, Average loss 0.194, Acc 0.981
Round  92, Average loss 0.203, Acc 0.979
Round  93, Average loss 0.121, Acc 0.981
Round  94, Average loss 0.259, Acc 0.981
Round  95, Average loss 0.160, Acc 0.981
Round  96, Average loss 0.183, Acc 0.981
Round  97, Average loss 0.235, Acc 0.981
Round  98, Average loss 0.060, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.197, Acc 0.981
Round 100, Average loss 0.170, Acc 0.981
Round 101, Average loss 0.147, Acc 0.960
Round 102, Average loss 0.222, Acc 0.981
Round 103, Average loss 0.158, Acc 0.979
Round 104, Average loss 0.136, Acc 0.981
Round 105, Average loss 0.312, Acc 0.981
Round 106, Average loss 0.136, Acc 0.981
Round 107, Average loss 0.153, Acc 0.981
Round 108, Average loss 0.164, Acc 0.972
Round 109, Average loss 0.131, Acc 0.981
Round 110, Average loss 0.207, Acc 0.981
Round 111, Average loss 0.095, Acc 0.981
Round 112, Average loss 0.175, Acc 0.982
Round 113, Average loss 0.079, Acc 0.982
Round 114, Average loss 0.098, Acc 0.981
Round 115, Average loss 0.157, Acc 0.981
Round 116, Average loss 0.155, Acc 0.982
Round 117, Average loss 0.173, Acc 0.981
Round 118, Average loss 0.177, Acc 0.982
0.007971615000000001
Round 119, Average loss 0.098, Acc 0.981
Round 120, Average loss 0.124, Acc 0.981
Round 121, Average loss 0.108, Acc 0.981
Round 122, Average loss 0.112, Acc 0.981
Round 123, Average loss 0.132, Acc 0.981
Round 124, Average loss 0.080, Acc 0.981
Round 125, Average loss 0.168, Acc 0.981
Round 126, Average loss 0.110, Acc 0.982
Round 127, Average loss 0.208, Acc 0.982
Round 128, Average loss 0.110, Acc 0.982
Round 129, Average loss 0.130, Acc 0.979
Round 130, Average loss 0.111, Acc 0.982
Round 131, Average loss 0.118, Acc 0.981
Round 132, Average loss 0.160, Acc 0.982
Round 133, Average loss 0.149, Acc 0.981
Round 134, Average loss 0.123, Acc 0.981
Round 135, Average loss 0.117, Acc 0.981
Round 136, Average loss 0.102, Acc 0.982
Round 137, Average loss 0.104, Acc 0.981
Round 138, Average loss 0.101, Acc 0.981
0.007174453500000001
Round 139, Average loss 0.154, Acc 0.979
Round 140, Average loss 0.131, Acc 0.981
Round 141, Average loss 0.086, Acc 0.981
Round 142, Average loss 0.099, Acc 0.983
Round 143, Average loss 0.143, Acc 0.981
Round 144, Average loss 0.086, Acc 0.982
Round 145, Average loss 0.126, Acc 0.981
Round 146, Average loss 0.092, Acc 0.981
Round 147, Average loss 0.138, Acc 0.982
Round 148, Average loss 0.099, Acc 0.982
Round 149, Average loss 0.127, Acc 0.983
Round 150, Average loss 0.094, Acc 0.982
Round 151, Average loss 0.121, Acc 0.982
Round 152, Average loss 0.082, Acc 0.982
Round 153, Average loss 0.142, Acc 0.982
Round 154, Average loss 0.103, Acc 0.982
Round 155, Average loss 0.093, Acc 0.982
Round 156, Average loss 0.082, Acc 0.982
Round 157, Average loss 0.113, Acc 0.982
Round 158, Average loss 0.139, Acc 0.982
0.006457008150000001
Round 159, Average loss 0.140, Acc 0.982
Round 160, Average loss 0.131, Acc 0.982
Round 161, Average loss 0.087, Acc 0.982
Round 162, Average loss 0.146, Acc 0.983
Round 163, Average loss 0.143, Acc 0.982
Round 164, Average loss 0.135, Acc 0.982
Round 165, Average loss 0.090, Acc 0.982
Round 166, Average loss 0.083, Acc 0.982
Round 167, Average loss 0.123, Acc 0.982
Round 168, Average loss 0.138, Acc 0.979
Round 169, Average loss 0.138, Acc 0.982
Round 170, Average loss 0.178, Acc 0.982
Round 171, Average loss 0.103, Acc 0.982
Round 172, Average loss 0.098, Acc 0.982
Round 173, Average loss 0.079, Acc 0.982
Round 174, Average loss 0.118, Acc 0.981
Round 175, Average loss 0.091, Acc 0.982
Round 176, Average loss 0.088, Acc 0.981
Round 177, Average loss 0.105, Acc 0.982
Round 178, Average loss 0.149, Acc 0.981
0.005811307335000002
Round 179, Average loss 0.073, Acc 0.981
Round 180, Average loss 0.106, Acc 0.980
Round 181, Average loss 0.091, Acc 0.980
Round 182, Average loss 0.101, Acc 0.982
Round 183, Average loss 0.067, Acc 0.981
Round 184, Average loss 0.131, Acc 0.982
Round 185, Average loss 0.112, Acc 0.982
Round 186, Average loss 0.081, Acc 0.981
Round 187, Average loss 0.108, Acc 0.981
Round 188, Average loss 0.163, Acc 0.978
Round 189, Average loss 0.123, Acc 0.980
Round 190, Average loss 0.120, Acc 0.978
Round 191, Average loss 0.129, Acc 0.981
Round 192, Average loss 0.110, Acc 0.980
Round 193, Average loss 0.092, Acc 0.982
Round 194, Average loss 0.065, Acc 0.982
Round 195, Average loss 0.106, Acc 0.981
Round 196, Average loss 0.168, Acc 0.980
Round 197, Average loss 0.148, Acc 0.980
Round 198, Average loss 0.081, Acc 0.980
0.005230176601500001
Round 199, Average loss 0.088, Acc 0.981
Round 200, Average loss 0.103, Acc 0.980
Round 201, Average loss 0.070, Acc 0.980
Round 202, Average loss 0.117, Acc 0.980
Round 203, Average loss 0.113, Acc 0.981
Round 204, Average loss 0.105, Acc 0.980
Round 205, Average loss 0.117, Acc 0.980
Round 206, Average loss 0.099, Acc 0.980
Round 207, Average loss 0.101, Acc 0.980
Round 208, Average loss 0.088, Acc 0.980
Round 209, Average loss 0.117, Acc 0.981
Round 210, Average loss 0.104, Acc 0.981
Round 211, Average loss 0.124, Acc 0.980
Round 212, Average loss 0.116, Acc 0.980
Round 213, Average loss 0.110, Acc 0.981
Round 214, Average loss 0.090, Acc 0.980
Round 215, Average loss 0.112, Acc 0.980
Round 216, Average loss 0.078, Acc 0.981
Round 217, Average loss 0.106, Acc 0.981
Round 218, Average loss 0.077, Acc 0.981
0.004707158941350001
Round 219, Average loss 0.077, Acc 0.981
Round 220, Average loss 0.121, Acc 0.981
Round 221, Average loss 0.109, Acc 0.981
Round 222, Average loss 0.064, Acc 0.982
Round 223, Average loss 0.119, Acc 0.982
Round 224, Average loss 0.083, Acc 0.982
Round 225, Average loss 0.084, Acc 0.981
Round 226, Average loss 0.108, Acc 0.981
Round 227, Average loss 0.067, Acc 0.981
Round 228, Average loss 0.140, Acc 0.980
Round 229, Average loss 0.112, Acc 0.980
Round 230, Average loss 0.073, Acc 0.980
Round 231, Average loss 0.101, Acc 0.980
Round 232, Average loss 0.097, Acc 0.980
Round 233, Average loss 0.121, Acc 0.980
Round 234, Average loss 0.140, Acc 0.978
Round 235, Average loss 0.087, Acc 0.980
Round 236, Average loss 0.138, Acc 0.980
Round 237, Average loss 0.125, Acc 0.980
Round 238, Average loss 0.099, Acc 0.980
0.004236443047215001
Round 239, Average loss 0.171, Acc 0.980
Round 240, Average loss 0.101, Acc 0.981
Round 241, Average loss 0.113, Acc 0.980
Round 242, Average loss 0.090, Acc 0.980
Round 243, Average loss 0.085, Acc 0.980
Round 244, Average loss 0.074, Acc 0.980
Round 245, Average loss 0.120, Acc 0.980
Round 246, Average loss 0.112, Acc 0.979
Round 247, Average loss 0.118, Acc 0.979
Round 248, Average loss 0.096, Acc 0.979
Round 249, Average loss 0.125, Acc 0.979
Round 250, Average loss 0.116, Acc 0.979
Round 251, Average loss 0.113, Acc 0.979
Round 252, Average loss 0.122, Acc 0.979
Round 253, Average loss 0.093, Acc 0.981
Round 254, Average loss 0.132, Acc 0.980
Round 255, Average loss 0.101, Acc 0.980
Round 256, Average loss 0.101, Acc 0.981
Round 257, Average loss 0.125, Acc 0.980
Round 258, Average loss 0.070, Acc 0.981
0.003812798742493501
Round 259, Average loss 0.158, Acc 0.981
Round 260, Average loss 0.108, Acc 0.980
Round 261, Average loss 0.112, Acc 0.980
Round 262, Average loss 0.056, Acc 0.980
Round 263, Average loss 0.143, Acc 0.981
Round 264, Average loss 0.067, Acc 0.981
Round 265, Average loss 0.106, Acc 0.981
Round 266, Average loss 0.072, Acc 0.981
Round 267, Average loss 0.076, Acc 0.981
Round 268, Average loss 0.092, Acc 0.981
Round 269, Average loss 0.100, Acc 0.981
Round 270, Average loss 0.084, Acc 0.981
Round 271, Average loss 0.119, Acc 0.982
Round 272, Average loss 0.111, Acc 0.982
Round 273, Average loss 0.154, Acc 0.981
Round 274, Average loss 0.089, Acc 0.981
Round 275, Average loss 0.099, Acc 0.981
Round 276, Average loss 0.073, Acc 0.981
Round 277, Average loss 0.111, Acc 0.981
Round 278, Average loss 0.065, Acc 0.981
0.003431518868244151
Round 279, Average loss 0.088, Acc 0.977
Round 280, Average loss 0.087, Acc 0.982
Round 281, Average loss 0.097, Acc 0.983
Round 282, Average loss 0.127, Acc 0.981
Round 283, Average loss 0.077, Acc 0.982
Round 284, Average loss 0.098, Acc 0.982
Round 285, Average loss 0.088, Acc 0.982
Round 286, Average loss 0.053, Acc 0.983
Round 287, Average loss 0.137, Acc 0.983
Round 288, Average loss 0.062, Acc 0.983
Round 289, Average loss 0.112, Acc 0.982
Round 290, Average loss 0.106, Acc 0.982
Round 291, Average loss 0.113, Acc 0.983
Round 292, Average loss 0.103, Acc 0.981
Round 293, Average loss 0.098, Acc 0.982
Round 294, Average loss 0.041, Acc 0.981
Round 295, Average loss 0.105, Acc 0.982
Round 296, Average loss 0.093, Acc 0.981
Round 297, Average loss 0.071, Acc 0.981
Round 298, Average loss 0.094, Acc 0.981
0.0030883669814197362
Round 299, Average loss 0.073, Acc 0.981
221.95268034934998 s
Memory used: 1650.12 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=50, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.9203272] and score 2 is 0.0
Round   0, Average loss 3.193, Acc 0.001
score 1 is [0.9188277] and score 2 is 0.0
Round   1, Average loss 3.194, Acc 0.001
score 1 is [0.8653622] and score 2 is 0.0
Round   2, Average loss 3.193, Acc 0.001
score 1 is [0.86899173] and score 2 is 0.0
Round   3, Average loss 3.193, Acc 0.001
score 1 is [0.8304485] and score 2 is 0.0
Round   4, Average loss 3.193, Acc 0.001
12.10189414024353 s
Memory used: 1677.09 MB

3e-2 + 60
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=60, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.165, Acc 0.642
Round   1, Average loss 2.765, Acc 0.569
Round   2, Average loss 1.756, Acc 0.569
Round   3, Average loss 1.026, Acc 0.569
Round   4, Average loss 0.803, Acc 0.981
Round   5, Average loss 0.860, Acc 0.760
Round   6, Average loss 0.647, Acc 0.933
Round   7, Average loss 0.699, Acc 0.785
Round   8, Average loss 0.502, Acc 0.978
Round   9, Average loss 0.589, Acc 0.787
Round  10, Average loss 0.474, Acc 0.980
Round  11, Average loss 0.663, Acc 0.806
Round  12, Average loss 0.496, Acc 0.975
Round  13, Average loss 0.675, Acc 0.869
Round  14, Average loss 0.440, Acc 0.413
Round  15, Average loss 0.626, Acc 0.870
Round  16, Average loss 0.321, Acc 0.980
Round  17, Average loss 0.482, Acc 0.938
Round  18, Average loss 0.251, Acc 0.980
0.0135
Round  19, Average loss 0.549, Acc 0.939
Round  20, Average loss 0.218, Acc 0.940
Round  21, Average loss 0.500, Acc 0.961
Round  22, Average loss 0.185, Acc 0.977
Round  23, Average loss 0.290, Acc 0.940
Round  24, Average loss 0.207, Acc 0.949
Round  25, Average loss 0.196, Acc 0.982
Round  26, Average loss 0.583, Acc 0.942
Round  27, Average loss 0.204, Acc 0.981
Round  28, Average loss 0.593, Acc 0.941
Round  29, Average loss 0.256, Acc 0.982
Round  30, Average loss 0.465, Acc 0.961
Round  31, Average loss 0.246, Acc 0.981
Round  32, Average loss 0.382, Acc 0.955
Round  33, Average loss 0.269, Acc 0.981
Round  34, Average loss 0.349, Acc 0.959
Round  35, Average loss 0.182, Acc 0.981
Round  36, Average loss 0.287, Acc 0.960
Round  37, Average loss 0.223, Acc 0.981
Round  38, Average loss 0.310, Acc 0.967
0.01215
Round  39, Average loss 0.212, Acc 0.980
Round  40, Average loss 0.233, Acc 0.967
Round  41, Average loss 0.227, Acc 0.976
Round  42, Average loss 0.231, Acc 0.966
Round  43, Average loss 0.217, Acc 0.979
Round  44, Average loss 0.108, Acc 0.970
Round  45, Average loss 0.222, Acc 0.981
Round  46, Average loss 0.214, Acc 0.977
Round  47, Average loss 0.133, Acc 0.981
Round  48, Average loss 0.160, Acc 0.975
Round  49, Average loss 0.171, Acc 0.981
Round  50, Average loss 0.147, Acc 0.979
Round  51, Average loss 0.169, Acc 0.977
Round  52, Average loss 0.121, Acc 0.981
Round  53, Average loss 0.242, Acc 0.971
Round  54, Average loss 0.235, Acc 0.981
Round  55, Average loss 0.181, Acc 0.970
Round  56, Average loss 0.188, Acc 0.980
Round  57, Average loss 0.166, Acc 0.980
Round  58, Average loss 0.167, Acc 0.981
0.010935
Round  59, Average loss 0.140, Acc 0.976
Round  60, Average loss 0.133, Acc 0.981
Round  61, Average loss 0.185, Acc 0.974
Round  62, Average loss 0.189, Acc 0.981
Round  63, Average loss 0.251, Acc 0.975
Round  64, Average loss 0.198, Acc 0.982
Round  65, Average loss 0.252, Acc 0.971
Round  66, Average loss 0.182, Acc 0.981
Round  67, Average loss 0.205, Acc 0.972
Round  68, Average loss 0.247, Acc 0.980
Round  69, Average loss 0.178, Acc 0.979
Round  70, Average loss 0.213, Acc 0.977
Round  71, Average loss 0.205, Acc 0.978
Round  72, Average loss 0.199, Acc 0.981
Round  73, Average loss 0.355, Acc 0.974
Round  74, Average loss 0.163, Acc 0.979
Round  75, Average loss 0.235, Acc 0.975
Round  76, Average loss 0.181, Acc 0.979
Round  77, Average loss 0.158, Acc 0.969
Round  78, Average loss 0.233, Acc 0.978
0.009841500000000001
Round  79, Average loss 0.211, Acc 0.975
Round  80, Average loss 0.265, Acc 0.979
Round  81, Average loss 0.180, Acc 0.975
Round  82, Average loss 0.173, Acc 0.977
Round  83, Average loss 0.159, Acc 0.980
Round  84, Average loss 0.187, Acc 0.979
Round  85, Average loss 0.158, Acc 0.977
Round  86, Average loss 0.117, Acc 0.980
Round  87, Average loss 0.252, Acc 0.978
Round  88, Average loss 0.193, Acc 0.981
Round  89, Average loss 0.105, Acc 0.979
Round  90, Average loss 0.138, Acc 0.981
Round  91, Average loss 0.183, Acc 0.978
Round  92, Average loss 0.175, Acc 0.981
Round  93, Average loss 0.090, Acc 0.981
Round  94, Average loss 0.255, Acc 0.981
Round  95, Average loss 0.073, Acc 0.978
Round  96, Average loss 0.181, Acc 0.981
Round  97, Average loss 0.282, Acc 0.974
Round  98, Average loss 0.179, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.147, Acc 0.976
Round 100, Average loss 0.144, Acc 0.981
Round 101, Average loss 0.108, Acc 0.977
Round 102, Average loss 0.119, Acc 0.980
Round 103, Average loss 0.195, Acc 0.981
Round 104, Average loss 0.193, Acc 0.976
Round 105, Average loss 0.131, Acc 0.980
Round 106, Average loss 0.215, Acc 0.979
Round 107, Average loss 0.243, Acc 0.978
Round 108, Average loss 0.110, Acc 0.981
Round 109, Average loss 0.135, Acc 0.976
Round 110, Average loss 0.119, Acc 0.978
Round 111, Average loss 0.160, Acc 0.980
Round 112, Average loss 0.276, Acc 0.978
Round 113, Average loss 0.208, Acc 0.980
Round 114, Average loss 0.223, Acc 0.978
Round 115, Average loss 0.119, Acc 0.981
Round 116, Average loss 0.225, Acc 0.976
Round 117, Average loss 0.198, Acc 0.981
Round 118, Average loss 0.115, Acc 0.975
0.007971615000000001
Round 119, Average loss 0.117, Acc 0.981
Round 120, Average loss 0.104, Acc 0.976
Round 121, Average loss 0.181, Acc 0.980
Round 122, Average loss 0.170, Acc 0.977
Round 123, Average loss 0.188, Acc 0.981
Round 124, Average loss 0.258, Acc 0.976
Round 125, Average loss 0.170, Acc 0.981
Round 126, Average loss 0.154, Acc 0.977
Round 127, Average loss 0.168, Acc 0.981
Round 128, Average loss 0.234, Acc 0.976
Round 129, Average loss 0.171, Acc 0.982
Round 130, Average loss 0.152, Acc 0.980
Round 131, Average loss 0.152, Acc 0.979
Round 132, Average loss 0.184, Acc 0.980
Round 133, Average loss 0.124, Acc 0.979
Round 134, Average loss 0.168, Acc 0.980
Round 135, Average loss 0.217, Acc 0.980
Round 136, Average loss 0.193, Acc 0.981
Round 137, Average loss 0.150, Acc 0.980
Round 138, Average loss 0.128, Acc 0.980
0.007174453500000001
Round 139, Average loss 0.289, Acc 0.983
Round 140, Average loss 0.120, Acc 0.969
Round 141, Average loss 0.140, Acc 0.981
Round 142, Average loss 0.178, Acc 0.976
Round 143, Average loss 0.109, Acc 0.981
Round 144, Average loss 0.125, Acc 0.979
Round 145, Average loss 0.191, Acc 0.981
Round 146, Average loss 0.192, Acc 0.978
Round 147, Average loss 0.160, Acc 0.981
Round 148, Average loss 0.159, Acc 0.981
Round 149, Average loss 0.186, Acc 0.982
Round 150, Average loss 0.141, Acc 0.982
Round 151, Average loss 0.092, Acc 0.981
Round 152, Average loss 0.179, Acc 0.984
Round 153, Average loss 0.071, Acc 0.981
Round 154, Average loss 0.193, Acc 0.983
Round 155, Average loss 0.176, Acc 0.981
Round 156, Average loss 0.097, Acc 0.983
Round 157, Average loss 0.069, Acc 0.982
Round 158, Average loss 0.105, Acc 0.981
0.006457008150000001
Round 159, Average loss 0.167, Acc 0.980
Round 160, Average loss 0.102, Acc 0.981
Round 161, Average loss 0.145, Acc 0.981
Round 162, Average loss 0.193, Acc 0.983
Round 163, Average loss 0.149, Acc 0.983
Round 164, Average loss 0.149, Acc 0.982
Round 165, Average loss 0.150, Acc 0.983
Round 166, Average loss 0.181, Acc 0.980
Round 167, Average loss 0.180, Acc 0.983
Round 168, Average loss 0.167, Acc 0.984
Round 169, Average loss 0.177, Acc 0.982
Round 170, Average loss 0.064, Acc 0.980
Round 171, Average loss 0.116, Acc 0.982
Round 172, Average loss 0.195, Acc 0.981
Round 173, Average loss 0.188, Acc 0.981
Round 174, Average loss 0.124, Acc 0.981
Round 175, Average loss 0.106, Acc 0.981
Round 176, Average loss 0.084, Acc 0.982
Round 177, Average loss 0.193, Acc 0.981
Round 178, Average loss 0.225, Acc 0.983
0.005811307335000002
Round 179, Average loss 0.154, Acc 0.982
Round 180, Average loss 0.146, Acc 0.983
Round 181, Average loss 0.113, Acc 0.983
Round 182, Average loss 0.116, Acc 0.980
Round 183, Average loss 0.155, Acc 0.983
Round 184, Average loss 0.185, Acc 0.983
Round 185, Average loss 0.137, Acc 0.983
Round 186, Average loss 0.163, Acc 0.981
Round 187, Average loss 0.090, Acc 0.982
Round 188, Average loss 0.130, Acc 0.983
Round 189, Average loss 0.118, Acc 0.983
Round 190, Average loss 0.215, Acc 0.982
Round 191, Average loss 0.182, Acc 0.982
Round 192, Average loss 0.132, Acc 0.982
Round 193, Average loss 0.155, Acc 0.982
Round 194, Average loss 0.121, Acc 0.981
Round 195, Average loss 0.118, Acc 0.984
Round 196, Average loss 0.084, Acc 0.985
Round 197, Average loss 0.088, Acc 0.982
Round 198, Average loss 0.062, Acc 0.981
0.005230176601500001
Round 199, Average loss 0.126, Acc 0.981
Round 200, Average loss 0.072, Acc 0.982
Round 201, Average loss 0.061, Acc 0.981
Round 202, Average loss 0.114, Acc 0.981
Round 203, Average loss 0.082, Acc 0.980
Round 204, Average loss 0.114, Acc 0.981
Round 205, Average loss 0.224, Acc 0.981
Round 206, Average loss 0.151, Acc 0.981
Round 207, Average loss 0.078, Acc 0.981
Round 208, Average loss 0.218, Acc 0.981
Round 209, Average loss 0.090, Acc 0.981
Round 210, Average loss 0.096, Acc 0.981
Round 211, Average loss 0.134, Acc 0.981
Round 212, Average loss 0.178, Acc 0.981
Round 213, Average loss 0.213, Acc 0.981
Round 214, Average loss 0.179, Acc 0.981
Round 215, Average loss 0.092, Acc 0.981
Round 216, Average loss 0.169, Acc 0.981
Round 217, Average loss 0.131, Acc 0.981
Round 218, Average loss 0.130, Acc 0.981
0.004707158941350001
Round 219, Average loss 0.106, Acc 0.983
Round 220, Average loss 0.154, Acc 0.981
Round 221, Average loss 0.078, Acc 0.981
Round 222, Average loss 0.120, Acc 0.981
Round 223, Average loss 0.102, Acc 0.983
Round 224, Average loss 0.100, Acc 0.981
Round 225, Average loss 0.071, Acc 0.983
Round 226, Average loss 0.083, Acc 0.983
Round 227, Average loss 0.079, Acc 0.982
Round 228, Average loss 0.119, Acc 0.983
Round 229, Average loss 0.192, Acc 0.984
Round 230, Average loss 0.123, Acc 0.984
Round 231, Average loss 0.098, Acc 0.984
Round 232, Average loss 0.092, Acc 0.985
Round 233, Average loss 0.137, Acc 0.985
Round 234, Average loss 0.112, Acc 0.985
Round 235, Average loss 0.073, Acc 0.985
Round 236, Average loss 0.073, Acc 0.984
Round 237, Average loss 0.093, Acc 0.984
Round 238, Average loss 0.080, Acc 0.984
0.004236443047215001
Round 239, Average loss 0.067, Acc 0.982
Round 240, Average loss 0.127, Acc 0.984
Round 241, Average loss 0.114, Acc 0.983
Round 242, Average loss 0.115, Acc 0.983
Round 243, Average loss 0.162, Acc 0.984
Round 244, Average loss 0.096, Acc 0.984
Round 245, Average loss 0.107, Acc 0.983
Round 246, Average loss 0.039, Acc 0.983
Round 247, Average loss 0.134, Acc 0.985
Round 248, Average loss 0.068, Acc 0.984
Round 249, Average loss 0.086, Acc 0.984
Round 250, Average loss 0.104, Acc 0.983
Round 251, Average loss 0.110, Acc 0.983
Round 252, Average loss 0.165, Acc 0.984
Round 253, Average loss 0.156, Acc 0.985
Round 254, Average loss 0.100, Acc 0.985
Round 255, Average loss 0.120, Acc 0.985
Round 256, Average loss 0.076, Acc 0.985
Round 257, Average loss 0.145, Acc 0.985
Round 258, Average loss 0.066, Acc 0.983
0.003812798742493501
Round 259, Average loss 0.070, Acc 0.985
Round 260, Average loss 0.126, Acc 0.983
Round 261, Average loss 0.124, Acc 0.985
Round 262, Average loss 0.088, Acc 0.985
Round 263, Average loss 0.068, Acc 0.985
Round 264, Average loss 0.061, Acc 0.985
Round 265, Average loss 0.081, Acc 0.984
Round 266, Average loss 0.131, Acc 0.985
Round 267, Average loss 0.107, Acc 0.985
Round 268, Average loss 0.074, Acc 0.984
Round 269, Average loss 0.098, Acc 0.983
Round 270, Average loss 0.118, Acc 0.983
Round 271, Average loss 0.096, Acc 0.985
Round 272, Average loss 0.058, Acc 0.985
Round 273, Average loss 0.074, Acc 0.986
Round 274, Average loss 0.062, Acc 0.985
Round 275, Average loss 0.093, Acc 0.985
Round 276, Average loss 0.060, Acc 0.985
Round 277, Average loss 0.092, Acc 0.985
Round 278, Average loss 0.081, Acc 0.985
0.003431518868244151
Round 279, Average loss 0.088, Acc 0.985
Round 280, Average loss 0.145, Acc 0.984
Round 281, Average loss 0.082, Acc 0.982
Round 282, Average loss 0.090, Acc 0.985
Round 283, Average loss 0.113, Acc 0.985
Round 284, Average loss 0.068, Acc 0.985
Round 285, Average loss 0.081, Acc 0.985
Round 286, Average loss 0.061, Acc 0.985
Round 287, Average loss 0.096, Acc 0.985
Round 288, Average loss 0.055, Acc 0.985
Round 289, Average loss 0.058, Acc 0.985
Round 290, Average loss 0.077, Acc 0.985
Round 291, Average loss 0.057, Acc 0.985
Round 292, Average loss 0.099, Acc 0.986
Round 293, Average loss 0.151, Acc 0.985
Round 294, Average loss 0.111, Acc 0.985
Round 295, Average loss 0.119, Acc 0.985
Round 296, Average loss 0.089, Acc 0.985
Round 297, Average loss 0.107, Acc 0.985
Round 298, Average loss 0.077, Acc 0.985
0.0030883669814197362
Round 299, Average loss 0.077, Acc 0.984
227.4976761341095 s
Memory used: 1659.21 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=60, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.79579663] and score 2 is 0.0
Round   0, Average loss 3.043, Acc 0.000
score 1 is [0.6205995] and score 2 is 0.0
Round   1, Average loss 3.143, Acc 0.000
score 1 is [0.8685874] and score 2 is 0.0
Round   2, Average loss 3.042, Acc 0.000
score 1 is [0.6323626] and score 2 is 0.0
Round   3, Average loss 3.178, Acc 0.000
score 1 is [0.7387979] and score 2 is 0.0
Round   4, Average loss 3.156, Acc 0.000
11.06462287902832 s
Memory used: 1682.34 MB

3e-2 + 70
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=70, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.112, Acc 0.569
Round   1, Average loss 2.536, Acc 0.569
Round   2, Average loss 1.460, Acc 0.569
Round   3, Average loss 0.927, Acc 0.699
Round   4, Average loss 0.826, Acc 0.888
Round   5, Average loss 0.708, Acc 0.784
Round   6, Average loss 0.675, Acc 0.958
Round   7, Average loss 0.516, Acc 0.786
Round   8, Average loss 0.576, Acc 0.980
Round   9, Average loss 0.501, Acc 0.806
Round  10, Average loss 0.463, Acc 0.924
Round  11, Average loss 0.345, Acc 0.811
Round  12, Average loss 0.405, Acc 0.966
Round  13, Average loss 0.356, Acc 0.933
Round  14, Average loss 0.277, Acc 0.940
Round  15, Average loss 0.402, Acc 0.936
Round  16, Average loss 0.271, Acc 0.940
Round  17, Average loss 0.340, Acc 0.934
Round  18, Average loss 0.226, Acc 0.967
0.0135
Round  19, Average loss 0.228, Acc 0.936
Round  20, Average loss 0.263, Acc 0.956
Round  21, Average loss 0.235, Acc 0.938
Round  22, Average loss 0.200, Acc 0.979
Round  23, Average loss 0.181, Acc 0.955
Round  24, Average loss 0.212, Acc 0.959
Round  25, Average loss 0.188, Acc 0.955
Round  26, Average loss 0.203, Acc 0.981
Round  27, Average loss 0.202, Acc 0.956
Round  28, Average loss 0.147, Acc 0.980
Round  29, Average loss 0.206, Acc 0.961
Round  30, Average loss 0.189, Acc 0.981
Round  31, Average loss 0.157, Acc 0.959
Round  32, Average loss 0.182, Acc 0.982
Round  33, Average loss 0.132, Acc 0.959
Round  34, Average loss 0.194, Acc 0.981
Round  35, Average loss 0.177, Acc 0.959
Round  36, Average loss 0.194, Acc 0.981
Round  37, Average loss 0.090, Acc 0.960
Round  38, Average loss 0.156, Acc 0.981
0.01215
Round  39, Average loss 0.152, Acc 0.973
Round  40, Average loss 0.125, Acc 0.981
Round  41, Average loss 0.142, Acc 0.977
Round  42, Average loss 0.136, Acc 0.981
Round  43, Average loss 0.171, Acc 0.975
Round  44, Average loss 0.113, Acc 0.981
Round  45, Average loss 0.128, Acc 0.968
Round  46, Average loss 0.130, Acc 0.984
Round  47, Average loss 0.114, Acc 0.978
Round  48, Average loss 0.136, Acc 0.984
Round  49, Average loss 0.186, Acc 0.979
Round  50, Average loss 0.118, Acc 0.982
Round  51, Average loss 0.114, Acc 0.981
Round  52, Average loss 0.091, Acc 0.981
Round  53, Average loss 0.116, Acc 0.978
Round  54, Average loss 0.067, Acc 0.980
Round  55, Average loss 0.116, Acc 0.979
Round  56, Average loss 0.130, Acc 0.982
Round  57, Average loss 0.135, Acc 0.980
Round  58, Average loss 0.121, Acc 0.981
0.010935
Round  59, Average loss 0.101, Acc 0.980
Round  60, Average loss 0.099, Acc 0.968
Round  61, Average loss 0.090, Acc 0.981
Round  62, Average loss 0.100, Acc 0.980
Round  63, Average loss 0.096, Acc 0.982
Round  64, Average loss 0.089, Acc 0.977
Round  65, Average loss 0.103, Acc 0.983
Round  66, Average loss 0.082, Acc 0.981
Round  67, Average loss 0.079, Acc 0.981
Round  68, Average loss 0.137, Acc 0.984
Round  69, Average loss 0.122, Acc 0.980
Round  70, Average loss 0.161, Acc 0.981
Round  71, Average loss 0.077, Acc 0.982
Round  72, Average loss 0.093, Acc 0.970
Round  73, Average loss 0.156, Acc 0.984
Round  74, Average loss 0.117, Acc 0.978
Round  75, Average loss 0.132, Acc 0.982
Round  76, Average loss 0.089, Acc 0.979
Round  77, Average loss 0.119, Acc 0.981
Round  78, Average loss 0.123, Acc 0.980
0.009841500000000001
Round  79, Average loss 0.116, Acc 0.984
Round  80, Average loss 0.065, Acc 0.979
Round  81, Average loss 0.113, Acc 0.983
Round  82, Average loss 0.115, Acc 0.983
Round  83, Average loss 0.056, Acc 0.984
Round  84, Average loss 0.083, Acc 0.984
Round  85, Average loss 0.077, Acc 0.984
Round  86, Average loss 0.084, Acc 0.980
Round  87, Average loss 0.098, Acc 0.983
Round  88, Average loss 0.093, Acc 0.982
Round  89, Average loss 0.073, Acc 0.984
Round  90, Average loss 0.071, Acc 0.983
Round  91, Average loss 0.088, Acc 0.981
Round  92, Average loss 0.099, Acc 0.982
Round  93, Average loss 0.077, Acc 0.982
Round  94, Average loss 0.068, Acc 0.970
Round  95, Average loss 0.141, Acc 0.984
Round  96, Average loss 0.098, Acc 0.985
Round  97, Average loss 0.073, Acc 0.984
Round  98, Average loss 0.062, Acc 0.983
0.008857350000000002
Round  99, Average loss 0.054, Acc 0.984
Round 100, Average loss 0.112, Acc 0.984
Round 101, Average loss 0.092, Acc 0.984
Round 102, Average loss 0.089, Acc 0.984
Round 103, Average loss 0.075, Acc 0.984
Round 104, Average loss 0.117, Acc 0.983
Round 105, Average loss 0.061, Acc 0.984
Round 106, Average loss 0.076, Acc 0.982
Round 107, Average loss 0.097, Acc 0.984
Round 108, Average loss 0.093, Acc 0.974
Round 109, Average loss 0.109, Acc 0.984
Round 110, Average loss 0.100, Acc 0.985
Round 111, Average loss 0.122, Acc 0.984
Round 112, Average loss 0.069, Acc 0.983
Round 113, Average loss 0.072, Acc 0.984
Round 114, Average loss 0.073, Acc 0.982
Round 115, Average loss 0.078, Acc 0.983
Round 116, Average loss 0.104, Acc 0.985
Round 117, Average loss 0.082, Acc 0.982
Round 118, Average loss 0.078, Acc 0.983
0.007971615000000001
Round 119, Average loss 0.077, Acc 0.980
Round 120, Average loss 0.072, Acc 0.982
Round 121, Average loss 0.056, Acc 0.982
Round 122, Average loss 0.089, Acc 0.983
Round 123, Average loss 0.063, Acc 0.981
Round 124, Average loss 0.105, Acc 0.984
Round 125, Average loss 0.053, Acc 0.985
Round 126, Average loss 0.140, Acc 0.982
Round 127, Average loss 0.088, Acc 0.984
Round 128, Average loss 0.107, Acc 0.982
Round 129, Average loss 0.100, Acc 0.984
Round 130, Average loss 0.095, Acc 0.982
Round 131, Average loss 0.091, Acc 0.983
Round 132, Average loss 0.065, Acc 0.984
Round 133, Average loss 0.073, Acc 0.984
Round 134, Average loss 0.034, Acc 0.985
Round 135, Average loss 0.158, Acc 0.982
Round 136, Average loss 0.080, Acc 0.986
Round 137, Average loss 0.138, Acc 0.983
Round 138, Average loss 0.132, Acc 0.983
0.007174453500000001
Round 139, Average loss 0.113, Acc 0.986
Round 140, Average loss 0.099, Acc 0.984
Round 141, Average loss 0.057, Acc 0.982
Round 142, Average loss 0.065, Acc 0.982
Round 143, Average loss 0.122, Acc 0.984
Round 144, Average loss 0.090, Acc 0.985
Round 145, Average loss 0.124, Acc 0.986
Round 146, Average loss 0.090, Acc 0.984
Round 147, Average loss 0.085, Acc 0.985
Round 148, Average loss 0.083, Acc 0.982
Round 149, Average loss 0.124, Acc 0.975
Round 150, Average loss 0.073, Acc 0.984
Round 151, Average loss 0.054, Acc 0.984
Round 152, Average loss 0.091, Acc 0.983
Round 153, Average loss 0.105, Acc 0.984
Round 154, Average loss 0.104, Acc 0.986
Round 155, Average loss 0.087, Acc 0.985
Round 156, Average loss 0.132, Acc 0.987
Round 157, Average loss 0.084, Acc 0.987
Round 158, Average loss 0.078, Acc 0.984
0.006457008150000001
Round 159, Average loss 0.083, Acc 0.985
Round 160, Average loss 0.079, Acc 0.986
Round 161, Average loss 0.092, Acc 0.985
Round 162, Average loss 0.090, Acc 0.986
Round 163, Average loss 0.102, Acc 0.985
Round 164, Average loss 0.087, Acc 0.985
Round 165, Average loss 0.058, Acc 0.985
Round 166, Average loss 0.083, Acc 0.985
Round 167, Average loss 0.091, Acc 0.987
Round 168, Average loss 0.059, Acc 0.985
Round 169, Average loss 0.060, Acc 0.985
Round 170, Average loss 0.076, Acc 0.985
Round 171, Average loss 0.126, Acc 0.984
Round 172, Average loss 0.104, Acc 0.987
Round 173, Average loss 0.054, Acc 0.986
Round 174, Average loss 0.045, Acc 0.983
Round 175, Average loss 0.108, Acc 0.985
Round 176, Average loss 0.101, Acc 0.986
Round 177, Average loss 0.053, Acc 0.980
Round 178, Average loss 0.092, Acc 0.985
0.005811307335000002
Round 179, Average loss 0.068, Acc 0.986
Round 180, Average loss 0.070, Acc 0.985
Round 181, Average loss 0.070, Acc 0.986
Round 182, Average loss 0.077, Acc 0.984
Round 183, Average loss 0.099, Acc 0.987
Round 184, Average loss 0.107, Acc 0.987
Round 185, Average loss 0.126, Acc 0.986
Round 186, Average loss 0.077, Acc 0.985
Round 187, Average loss 0.047, Acc 0.985
Round 188, Average loss 0.078, Acc 0.985
Round 189, Average loss 0.136, Acc 0.986
Round 190, Average loss 0.059, Acc 0.987
Round 191, Average loss 0.063, Acc 0.985
Round 192, Average loss 0.036, Acc 0.986
Round 193, Average loss 0.100, Acc 0.985
Round 194, Average loss 0.085, Acc 0.986
Round 195, Average loss 0.047, Acc 0.985
Round 196, Average loss 0.069, Acc 0.987
Round 197, Average loss 0.095, Acc 0.985
Round 198, Average loss 0.048, Acc 0.986
0.005230176601500001
Round 199, Average loss 0.080, Acc 0.987
Round 200, Average loss 0.080, Acc 0.982
Round 201, Average loss 0.051, Acc 0.986
Round 202, Average loss 0.065, Acc 0.985
Round 203, Average loss 0.060, Acc 0.986
Round 204, Average loss 0.088, Acc 0.987
Round 205, Average loss 0.091, Acc 0.985
Round 206, Average loss 0.100, Acc 0.988
Round 207, Average loss 0.084, Acc 0.985
Round 208, Average loss 0.077, Acc 0.986
Round 209, Average loss 0.069, Acc 0.985
Round 210, Average loss 0.054, Acc 0.983
Round 211, Average loss 0.059, Acc 0.985
Round 212, Average loss 0.059, Acc 0.984
Round 213, Average loss 0.085, Acc 0.981
Round 214, Average loss 0.067, Acc 0.981
Round 215, Average loss 0.084, Acc 0.982
Round 216, Average loss 0.078, Acc 0.978
Round 217, Average loss 0.118, Acc 0.985
Round 218, Average loss 0.061, Acc 0.984
0.004707158941350001
Round 219, Average loss 0.055, Acc 0.984
Round 220, Average loss 0.105, Acc 0.985
Round 221, Average loss 0.065, Acc 0.984
Round 222, Average loss 0.069, Acc 0.984
Round 223, Average loss 0.094, Acc 0.982
Round 224, Average loss 0.074, Acc 0.986
Round 225, Average loss 0.085, Acc 0.987
Round 226, Average loss 0.086, Acc 0.985
Round 227, Average loss 0.081, Acc 0.986
Round 228, Average loss 0.116, Acc 0.985
Round 229, Average loss 0.092, Acc 0.987
Round 230, Average loss 0.098, Acc 0.986
Round 231, Average loss 0.072, Acc 0.987
Round 232, Average loss 0.084, Acc 0.988
Round 233, Average loss 0.054, Acc 0.985
Round 234, Average loss 0.074, Acc 0.988
Round 235, Average loss 0.060, Acc 0.986
Round 236, Average loss 0.070, Acc 0.988
Round 237, Average loss 0.067, Acc 0.986
Round 238, Average loss 0.068, Acc 0.988
0.004236443047215001
Round 239, Average loss 0.097, Acc 0.984
Round 240, Average loss 0.107, Acc 0.987
Round 241, Average loss 0.058, Acc 0.985
Round 242, Average loss 0.090, Acc 0.988
Round 243, Average loss 0.058, Acc 0.986
Round 244, Average loss 0.044, Acc 0.985
Round 245, Average loss 0.040, Acc 0.986
Round 246, Average loss 0.064, Acc 0.987
Round 247, Average loss 0.070, Acc 0.984
Round 248, Average loss 0.046, Acc 0.984
Round 249, Average loss 0.068, Acc 0.988
Round 250, Average loss 0.053, Acc 0.987
Round 251, Average loss 0.074, Acc 0.987
Round 252, Average loss 0.059, Acc 0.986
Round 253, Average loss 0.075, Acc 0.983
Round 254, Average loss 0.077, Acc 0.983
Round 255, Average loss 0.070, Acc 0.984
Round 256, Average loss 0.089, Acc 0.988
Round 257, Average loss 0.074, Acc 0.985
Round 258, Average loss 0.062, Acc 0.988
0.003812798742493501
Round 259, Average loss 0.076, Acc 0.986
Round 260, Average loss 0.072, Acc 0.987
Round 261, Average loss 0.064, Acc 0.985
Round 262, Average loss 0.086, Acc 0.987
Round 263, Average loss 0.070, Acc 0.986
Round 264, Average loss 0.088, Acc 0.987
Round 265, Average loss 0.078, Acc 0.984
Round 266, Average loss 0.070, Acc 0.986
Round 267, Average loss 0.067, Acc 0.985
Round 268, Average loss 0.062, Acc 0.985
Round 269, Average loss 0.070, Acc 0.988
Round 270, Average loss 0.067, Acc 0.988
Round 271, Average loss 0.055, Acc 0.988
Round 272, Average loss 0.078, Acc 0.985
Round 273, Average loss 0.063, Acc 0.988
Round 274, Average loss 0.063, Acc 0.987
Round 275, Average loss 0.063, Acc 0.982
Round 276, Average loss 0.058, Acc 0.986
Round 277, Average loss 0.028, Acc 0.986
Round 278, Average loss 0.066, Acc 0.987
0.003431518868244151
Round 279, Average loss 0.077, Acc 0.987
Round 280, Average loss 0.103, Acc 0.985
Round 281, Average loss 0.087, Acc 0.987
Round 282, Average loss 0.051, Acc 0.987
Round 283, Average loss 0.070, Acc 0.987
Round 284, Average loss 0.060, Acc 0.984
Round 285, Average loss 0.096, Acc 0.987
Round 286, Average loss 0.094, Acc 0.986
Round 287, Average loss 0.064, Acc 0.987
Round 288, Average loss 0.053, Acc 0.985
Round 289, Average loss 0.064, Acc 0.985
Round 290, Average loss 0.071, Acc 0.987
Round 291, Average loss 0.072, Acc 0.987
Round 292, Average loss 0.080, Acc 0.987
Round 293, Average loss 0.063, Acc 0.987
Round 294, Average loss 0.069, Acc 0.984
Round 295, Average loss 0.039, Acc 0.987
Round 296, Average loss 0.094, Acc 0.987
Round 297, Average loss 0.070, Acc 0.987
Round 298, Average loss 0.099, Acc 0.985
0.0030883669814197362
Round 299, Average loss 0.063, Acc 0.986
255.9653286933899 s
Memory used: 1667.45 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=70, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.70950603] and score 2 is 0.0
Round   0, Average loss 3.094, Acc 0.002
score 1 is [0.70140475] and score 2 is 0.0
Round   1, Average loss 3.241, Acc 0.002
score 1 is [0.8633509] and score 2 is 0.0
Round   2, Average loss 3.097, Acc 0.002
score 1 is [0.8534795] and score 2 is 0.0
Round   3, Average loss 3.104, Acc 0.002
score 1 is [0.7772907] and score 2 is 0.0
Round   4, Average loss 3.241, Acc 0.002
11.614969730377197 s
Memory used: 1663.52 MB

3e-2 + 80
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=80, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.171, Acc 0.569
Round   1, Average loss 2.573, Acc 0.569
Round   2, Average loss 1.331, Acc 0.569
Round   3, Average loss 0.905, Acc 0.940
Round   4, Average loss 0.985, Acc 0.715
Round   5, Average loss 0.690, Acc 0.964
Round   6, Average loss 0.723, Acc 0.727
Round   7, Average loss 0.731, Acc 0.975
Round   8, Average loss 0.635, Acc 0.753
Round   9, Average loss 0.576, Acc 0.977
Round  10, Average loss 0.582, Acc 0.801
Round  11, Average loss 0.477, Acc 0.978
Round  12, Average loss 0.505, Acc 0.939
Round  13, Average loss 0.304, Acc 0.979
Round  14, Average loss 0.446, Acc 0.940
Round  15, Average loss 0.239, Acc 0.981
Round  16, Average loss 0.325, Acc 0.937
Round  17, Average loss 0.241, Acc 0.954
Round  18, Average loss 0.281, Acc 0.940
0.0135
Round  19, Average loss 0.256, Acc 0.982
Round  20, Average loss 0.189, Acc 0.942
Round  21, Average loss 0.166, Acc 0.982
Round  22, Average loss 0.216, Acc 0.941
Round  23, Average loss 0.229, Acc 0.982
Round  24, Average loss 0.158, Acc 0.946
Round  25, Average loss 0.143, Acc 0.981
Round  26, Average loss 0.134, Acc 0.945
Round  27, Average loss 0.195, Acc 0.982
Round  28, Average loss 0.181, Acc 0.946
Round  29, Average loss 0.157, Acc 0.982
Round  30, Average loss 0.156, Acc 0.955
Round  31, Average loss 0.224, Acc 0.977
Round  32, Average loss 0.140, Acc 0.944
Round  33, Average loss 0.216, Acc 0.962
Round  34, Average loss 0.176, Acc 0.981
Round  35, Average loss 0.108, Acc 0.973
Round  36, Average loss 0.079, Acc 0.980
Round  37, Average loss 0.217, Acc 0.979
Round  38, Average loss 0.180, Acc 0.981
0.01215
Round  39, Average loss 0.099, Acc 0.973
Round  40, Average loss 0.177, Acc 0.982
Round  41, Average loss 0.104, Acc 0.980
Round  42, Average loss 0.082, Acc 0.982
Round  43, Average loss 0.149, Acc 0.980
Round  44, Average loss 0.088, Acc 0.982
Round  45, Average loss 0.138, Acc 0.980
Round  46, Average loss 0.116, Acc 0.981
Round  47, Average loss 0.110, Acc 0.948
Round  48, Average loss 0.179, Acc 0.969
Round  49, Average loss 0.102, Acc 0.982
Round  50, Average loss 0.093, Acc 0.979
Round  51, Average loss 0.117, Acc 0.982
Round  52, Average loss 0.091, Acc 0.976
Round  53, Average loss 0.108, Acc 0.982
Round  54, Average loss 0.127, Acc 0.983
Round  55, Average loss 0.125, Acc 0.983
Round  56, Average loss 0.102, Acc 0.981
Round  57, Average loss 0.110, Acc 0.981
Round  58, Average loss 0.116, Acc 0.978
0.010935
Round  59, Average loss 0.079, Acc 0.981
Round  60, Average loss 0.164, Acc 0.981
Round  61, Average loss 0.110, Acc 0.982
Round  62, Average loss 0.154, Acc 0.982
Round  63, Average loss 0.062, Acc 0.981
Round  64, Average loss 0.168, Acc 0.981
Round  65, Average loss 0.115, Acc 0.982
Round  66, Average loss 0.095, Acc 0.981
Round  67, Average loss 0.131, Acc 0.981
Round  68, Average loss 0.097, Acc 0.982
Round  69, Average loss 0.076, Acc 0.981
Round  70, Average loss 0.110, Acc 0.982
Round  71, Average loss 0.113, Acc 0.981
Round  72, Average loss 0.170, Acc 0.982
Round  73, Average loss 0.113, Acc 0.981
Round  74, Average loss 0.069, Acc 0.981
Round  75, Average loss 0.054, Acc 0.983
Round  76, Average loss 0.147, Acc 0.986
Round  77, Average loss 0.147, Acc 0.982
Round  78, Average loss 0.085, Acc 0.983
0.009841500000000001
Round  79, Average loss 0.122, Acc 0.982
Round  80, Average loss 0.080, Acc 0.984
Round  81, Average loss 0.139, Acc 0.984
Round  82, Average loss 0.065, Acc 0.982
Round  83, Average loss 0.148, Acc 0.982
Round  84, Average loss 0.147, Acc 0.981
Round  85, Average loss 0.128, Acc 0.984
Round  86, Average loss 0.084, Acc 0.982
Round  87, Average loss 0.109, Acc 0.983
Round  88, Average loss 0.087, Acc 0.986
Round  89, Average loss 0.131, Acc 0.984
Round  90, Average loss 0.051, Acc 0.983
Round  91, Average loss 0.121, Acc 0.982
Round  92, Average loss 0.083, Acc 0.984
Round  93, Average loss 0.106, Acc 0.984
Round  94, Average loss 0.087, Acc 0.982
Round  95, Average loss 0.110, Acc 0.982
Round  96, Average loss 0.072, Acc 0.983
Round  97, Average loss 0.081, Acc 0.962
Round  98, Average loss 0.148, Acc 0.982
0.008857350000000002
Round  99, Average loss 0.095, Acc 0.984
Round 100, Average loss 0.091, Acc 0.984
Round 101, Average loss 0.065, Acc 0.982
Round 102, Average loss 0.100, Acc 0.985
Round 103, Average loss 0.087, Acc 0.984
Round 104, Average loss 0.078, Acc 0.985
Round 105, Average loss 0.054, Acc 0.984
Round 106, Average loss 0.117, Acc 0.983
Round 107, Average loss 0.064, Acc 0.983
Round 108, Average loss 0.064, Acc 0.984
Round 109, Average loss 0.094, Acc 0.985
Round 110, Average loss 0.078, Acc 0.984
Round 111, Average loss 0.043, Acc 0.961
Round 112, Average loss 0.165, Acc 0.985
Round 113, Average loss 0.080, Acc 0.985
Round 114, Average loss 0.066, Acc 0.982
Round 115, Average loss 0.087, Acc 0.986
Round 116, Average loss 0.119, Acc 0.983
Round 117, Average loss 0.059, Acc 0.984
Round 118, Average loss 0.088, Acc 0.984
0.007971615000000001
Round 119, Average loss 0.133, Acc 0.984
Round 120, Average loss 0.103, Acc 0.985
Round 121, Average loss 0.112, Acc 0.984
Round 122, Average loss 0.077, Acc 0.982
Round 123, Average loss 0.080, Acc 0.962
Round 124, Average loss 0.155, Acc 0.984
Round 125, Average loss 0.063, Acc 0.985
Round 126, Average loss 0.104, Acc 0.983
Round 127, Average loss 0.063, Acc 0.987
Round 128, Average loss 0.068, Acc 0.985
Round 129, Average loss 0.077, Acc 0.983
Round 130, Average loss 0.099, Acc 0.985
Round 131, Average loss 0.098, Acc 0.985
Round 132, Average loss 0.079, Acc 0.982
Round 133, Average loss 0.067, Acc 0.982
Round 134, Average loss 0.097, Acc 0.984
Round 135, Average loss 0.084, Acc 0.984
Round 136, Average loss 0.063, Acc 0.984
Round 137, Average loss 0.101, Acc 0.984
Round 138, Average loss 0.143, Acc 0.984
0.007174453500000001
Round 139, Average loss 0.114, Acc 0.983
Round 140, Average loss 0.082, Acc 0.982
Round 141, Average loss 0.073, Acc 0.984
Round 142, Average loss 0.087, Acc 0.986
Round 143, Average loss 0.078, Acc 0.983
Round 144, Average loss 0.105, Acc 0.985
Round 145, Average loss 0.074, Acc 0.984
Round 146, Average loss 0.073, Acc 0.986
Round 147, Average loss 0.049, Acc 0.984
Round 148, Average loss 0.083, Acc 0.987
Round 149, Average loss 0.092, Acc 0.976
Round 150, Average loss 0.128, Acc 0.984
Round 151, Average loss 0.051, Acc 0.985
Round 152, Average loss 0.067, Acc 0.984
Round 153, Average loss 0.142, Acc 0.983
Round 154, Average loss 0.057, Acc 0.984
Round 155, Average loss 0.055, Acc 0.984
Round 156, Average loss 0.061, Acc 0.983
Round 157, Average loss 0.065, Acc 0.986
Round 158, Average loss 0.067, Acc 0.984
0.006457008150000001
Round 159, Average loss 0.079, Acc 0.984
Round 160, Average loss 0.080, Acc 0.988
Round 161, Average loss 0.103, Acc 0.984
Round 162, Average loss 0.057, Acc 0.987
Round 163, Average loss 0.040, Acc 0.985
Round 164, Average loss 0.065, Acc 0.984
Round 165, Average loss 0.056, Acc 0.982
Round 166, Average loss 0.037, Acc 0.985
Round 167, Average loss 0.097, Acc 0.988
Round 168, Average loss 0.072, Acc 0.984
Round 169, Average loss 0.047, Acc 0.986
Round 170, Average loss 0.069, Acc 0.985
Round 171, Average loss 0.075, Acc 0.987
Round 172, Average loss 0.072, Acc 0.985
Round 173, Average loss 0.088, Acc 0.984
Round 174, Average loss 0.093, Acc 0.984
Round 175, Average loss 0.075, Acc 0.984
Round 176, Average loss 0.074, Acc 0.985
Round 177, Average loss 0.120, Acc 0.983
Round 178, Average loss 0.069, Acc 0.985
0.005811307335000002
Round 179, Average loss 0.043, Acc 0.983
Round 180, Average loss 0.079, Acc 0.986
Round 181, Average loss 0.097, Acc 0.985
Round 182, Average loss 0.068, Acc 0.986
Round 183, Average loss 0.063, Acc 0.987
Round 184, Average loss 0.082, Acc 0.985
Round 185, Average loss 0.050, Acc 0.983
Round 186, Average loss 0.078, Acc 0.983
Round 187, Average loss 0.050, Acc 0.984
Round 188, Average loss 0.089, Acc 0.987
Round 189, Average loss 0.076, Acc 0.983
Round 190, Average loss 0.092, Acc 0.983
Round 191, Average loss 0.074, Acc 0.985
Round 192, Average loss 0.107, Acc 0.984
Round 193, Average loss 0.087, Acc 0.984
Round 194, Average loss 0.068, Acc 0.987
Round 195, Average loss 0.037, Acc 0.983
Round 196, Average loss 0.090, Acc 0.988
Round 197, Average loss 0.089, Acc 0.985
Round 198, Average loss 0.048, Acc 0.986
0.005230176601500001
Round 199, Average loss 0.055, Acc 0.987
Round 200, Average loss 0.053, Acc 0.987
Round 201, Average loss 0.126, Acc 0.985
Round 202, Average loss 0.060, Acc 0.984
Round 203, Average loss 0.097, Acc 0.985
Round 204, Average loss 0.066, Acc 0.985
Round 205, Average loss 0.090, Acc 0.986
Round 206, Average loss 0.062, Acc 0.986
Round 207, Average loss 0.055, Acc 0.984
Round 208, Average loss 0.114, Acc 0.980
Round 209, Average loss 0.087, Acc 0.985
Round 210, Average loss 0.070, Acc 0.986
Round 211, Average loss 0.065, Acc 0.985
Round 212, Average loss 0.106, Acc 0.982
Round 213, Average loss 0.105, Acc 0.983
Round 214, Average loss 0.057, Acc 0.986
Round 215, Average loss 0.051, Acc 0.984
Round 216, Average loss 0.039, Acc 0.985
Round 217, Average loss 0.074, Acc 0.984
Round 218, Average loss 0.068, Acc 0.985
0.004707158941350001
Round 219, Average loss 0.078, Acc 0.984
Round 220, Average loss 0.077, Acc 0.985
Round 221, Average loss 0.063, Acc 0.985
Round 222, Average loss 0.142, Acc 0.986
Round 223, Average loss 0.086, Acc 0.986
Round 224, Average loss 0.093, Acc 0.985
Round 225, Average loss 0.080, Acc 0.985
Round 226, Average loss 0.052, Acc 0.985
Round 227, Average loss 0.068, Acc 0.984
Round 228, Average loss 0.055, Acc 0.985
Round 229, Average loss 0.065, Acc 0.985
Round 230, Average loss 0.091, Acc 0.985
Round 231, Average loss 0.102, Acc 0.984
Round 232, Average loss 0.066, Acc 0.985
Round 233, Average loss 0.059, Acc 0.986
Round 234, Average loss 0.097, Acc 0.984
Round 235, Average loss 0.053, Acc 0.986
Round 236, Average loss 0.052, Acc 0.985
Round 237, Average loss 0.043, Acc 0.984
Round 238, Average loss 0.096, Acc 0.985
0.004236443047215001
Round 239, Average loss 0.090, Acc 0.987
Round 240, Average loss 0.072, Acc 0.986
Round 241, Average loss 0.060, Acc 0.984
Round 242, Average loss 0.109, Acc 0.987
Round 243, Average loss 0.080, Acc 0.986
Round 244, Average loss 0.061, Acc 0.985
Round 245, Average loss 0.095, Acc 0.986
Round 246, Average loss 0.064, Acc 0.987
Round 247, Average loss 0.075, Acc 0.986
Round 248, Average loss 0.079, Acc 0.984
Round 249, Average loss 0.063, Acc 0.984
Round 250, Average loss 0.068, Acc 0.984
Round 251, Average loss 0.043, Acc 0.986
Round 252, Average loss 0.103, Acc 0.984
Round 253, Average loss 0.128, Acc 0.987
Round 254, Average loss 0.079, Acc 0.984
Round 255, Average loss 0.041, Acc 0.986
Round 256, Average loss 0.093, Acc 0.987
Round 257, Average loss 0.086, Acc 0.984
Round 258, Average loss 0.075, Acc 0.987
0.003812798742493501
Round 259, Average loss 0.049, Acc 0.986
Round 260, Average loss 0.064, Acc 0.984
Round 261, Average loss 0.070, Acc 0.987
Round 262, Average loss 0.082, Acc 0.986
Round 263, Average loss 0.042, Acc 0.985
Round 264, Average loss 0.066, Acc 0.987
Round 265, Average loss 0.079, Acc 0.987
Round 266, Average loss 0.050, Acc 0.986
Round 267, Average loss 0.048, Acc 0.987
Round 268, Average loss 0.059, Acc 0.986
Round 269, Average loss 0.086, Acc 0.986
Round 270, Average loss 0.064, Acc 0.986
Round 271, Average loss 0.049, Acc 0.985
Round 272, Average loss 0.048, Acc 0.984
Round 273, Average loss 0.073, Acc 0.988
Round 274, Average loss 0.054, Acc 0.987
Round 275, Average loss 0.053, Acc 0.987
Round 276, Average loss 0.074, Acc 0.987
Round 277, Average loss 0.068, Acc 0.987
Round 278, Average loss 0.052, Acc 0.987
0.003431518868244151
Round 279, Average loss 0.097, Acc 0.985
Round 280, Average loss 0.095, Acc 0.985
Round 281, Average loss 0.064, Acc 0.986
Round 282, Average loss 0.063, Acc 0.985
Round 283, Average loss 0.136, Acc 0.987
Round 284, Average loss 0.062, Acc 0.986
Round 285, Average loss 0.029, Acc 0.983
Round 286, Average loss 0.073, Acc 0.984
Round 287, Average loss 0.063, Acc 0.983
Round 288, Average loss 0.079, Acc 0.983
Round 289, Average loss 0.086, Acc 0.984
Round 290, Average loss 0.061, Acc 0.984
Round 291, Average loss 0.127, Acc 0.984
Round 292, Average loss 0.067, Acc 0.985
Round 293, Average loss 0.059, Acc 0.987
Round 294, Average loss 0.042, Acc 0.986
Round 295, Average loss 0.056, Acc 0.984
Round 296, Average loss 0.038, Acc 0.983
Round 297, Average loss 0.088, Acc 0.983
Round 298, Average loss 0.064, Acc 0.986
0.0030883669814197362
Round 299, Average loss 0.067, Acc 0.986
254.81911492347717 s
Memory used: 1677.53 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=80, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.7650529] and score 2 is 0.0
Round   0, Average loss 3.155, Acc 0.568
score 1 is [0.893834] and score 2 is 0.0
Round   1, Average loss 3.000, Acc 0.568
score 1 is [0.7967411] and score 2 is 0.0
Round   2, Average loss 3.000, Acc 0.568
score 1 is [0.5914007] and score 2 is 0.0
Round   3, Average loss 3.000, Acc 0.568
score 1 is [0.78717494] and score 2 is 0.0
Round   4, Average loss 3.000, Acc 0.568
10.932917356491089 s
Memory used: 1666.66 MB

3e-2 + 90
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=90, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.146, Acc 0.744
Round   1, Average loss 2.627, Acc 0.744
Round   2, Average loss 1.481, Acc 0.700
Round   3, Average loss 0.805, Acc 0.744
Round   4, Average loss 0.712, Acc 0.413
Round   5, Average loss 1.050, Acc 0.744
Round   6, Average loss 0.679, Acc 0.979
Round   7, Average loss 0.590, Acc 0.583
Round   8, Average loss 0.831, Acc 0.958
Round   9, Average loss 0.504, Acc 0.715
Round  10, Average loss 0.715, Acc 0.979
Round  11, Average loss 0.533, Acc 0.769
Round  12, Average loss 0.678, Acc 0.980
Round  13, Average loss 0.560, Acc 0.788
Round  14, Average loss 0.636, Acc 0.982
Round  15, Average loss 0.487, Acc 0.811
Round  16, Average loss 0.435, Acc 0.982
Round  17, Average loss 0.569, Acc 0.824
Round  18, Average loss 0.313, Acc 0.981
0.0135
Round  19, Average loss 0.443, Acc 0.934
Round  20, Average loss 0.253, Acc 0.981
Round  21, Average loss 0.375, Acc 0.935
Round  22, Average loss 0.208, Acc 0.982
Round  23, Average loss 0.351, Acc 0.938
Round  24, Average loss 0.214, Acc 0.981
Round  25, Average loss 0.239, Acc 0.955
Round  26, Average loss 0.181, Acc 0.981
Round  27, Average loss 0.284, Acc 0.959
Round  28, Average loss 0.156, Acc 0.980
Round  29, Average loss 0.317, Acc 0.967
Round  30, Average loss 0.106, Acc 0.981
Round  31, Average loss 0.137, Acc 0.971
Round  32, Average loss 0.123, Acc 0.980
Round  33, Average loss 0.193, Acc 0.959
Round  34, Average loss 0.137, Acc 0.982
Round  35, Average loss 0.183, Acc 0.959
Round  36, Average loss 0.134, Acc 0.966
Round  37, Average loss 0.150, Acc 0.962
Round  38, Average loss 0.121, Acc 0.982
0.01215
Round  39, Average loss 0.129, Acc 0.971
Round  40, Average loss 0.138, Acc 0.982
Round  41, Average loss 0.174, Acc 0.969
Round  42, Average loss 0.157, Acc 0.982
Round  43, Average loss 0.135, Acc 0.973
Round  44, Average loss 0.151, Acc 0.980
Round  45, Average loss 0.212, Acc 0.973
Round  46, Average loss 0.170, Acc 0.981
Round  47, Average loss 0.154, Acc 0.973
Round  48, Average loss 0.164, Acc 0.981
Round  49, Average loss 0.140, Acc 0.974
Round  50, Average loss 0.151, Acc 0.981
Round  51, Average loss 0.181, Acc 0.975
Round  52, Average loss 0.121, Acc 0.980
Round  53, Average loss 0.124, Acc 0.979
Round  54, Average loss 0.122, Acc 0.981
Round  55, Average loss 0.163, Acc 0.932
Round  56, Average loss 0.223, Acc 0.981
Round  57, Average loss 0.126, Acc 0.979
Round  58, Average loss 0.142, Acc 0.979
0.010935
Round  59, Average loss 0.137, Acc 0.982
Round  60, Average loss 0.125, Acc 0.981
Round  61, Average loss 0.161, Acc 0.979
Round  62, Average loss 0.093, Acc 0.983
Round  63, Average loss 0.151, Acc 0.927
Round  64, Average loss 0.250, Acc 0.982
Round  65, Average loss 0.085, Acc 0.979
Round  66, Average loss 0.154, Acc 0.983
Round  67, Average loss 0.139, Acc 0.952
Round  68, Average loss 0.144, Acc 0.982
Round  69, Average loss 0.123, Acc 0.980
Round  70, Average loss 0.089, Acc 0.981
Round  71, Average loss 0.114, Acc 0.981
Round  72, Average loss 0.095, Acc 0.979
Round  73, Average loss 0.085, Acc 0.982
Round  74, Average loss 0.084, Acc 0.976
Round  75, Average loss 0.098, Acc 0.984
Round  76, Average loss 0.117, Acc 0.970
Round  77, Average loss 0.156, Acc 0.983
Round  78, Average loss 0.121, Acc 0.973
0.009841500000000001
Round  79, Average loss 0.116, Acc 0.981
Round  80, Average loss 0.156, Acc 0.982
Round  81, Average loss 0.103, Acc 0.985
Round  82, Average loss 0.044, Acc 0.983
Round  83, Average loss 0.090, Acc 0.982
Round  84, Average loss 0.117, Acc 0.979
Round  85, Average loss 0.105, Acc 0.983
Round  86, Average loss 0.148, Acc 0.973
Round  87, Average loss 0.155, Acc 0.982
Round  88, Average loss 0.100, Acc 0.978
Round  89, Average loss 0.088, Acc 0.983
Round  90, Average loss 0.087, Acc 0.978
Round  91, Average loss 0.134, Acc 0.983
Round  92, Average loss 0.107, Acc 0.980
Round  93, Average loss 0.107, Acc 0.984
Round  94, Average loss 0.116, Acc 0.982
Round  95, Average loss 0.112, Acc 0.983
Round  96, Average loss 0.121, Acc 0.981
Round  97, Average loss 0.063, Acc 0.984
Round  98, Average loss 0.065, Acc 0.982
0.008857350000000002
Round  99, Average loss 0.102, Acc 0.984
Round 100, Average loss 0.148, Acc 0.983
Round 101, Average loss 0.083, Acc 0.981
Round 102, Average loss 0.077, Acc 0.983
Round 103, Average loss 0.102, Acc 0.984
Round 104, Average loss 0.133, Acc 0.984
Round 105, Average loss 0.096, Acc 0.984
Round 106, Average loss 0.109, Acc 0.985
Round 107, Average loss 0.077, Acc 0.984
Round 108, Average loss 0.096, Acc 0.982
Round 109, Average loss 0.102, Acc 0.984
Round 110, Average loss 0.073, Acc 0.982
Round 111, Average loss 0.091, Acc 0.984
Round 112, Average loss 0.054, Acc 0.985
Round 113, Average loss 0.118, Acc 0.984
Round 114, Average loss 0.091, Acc 0.986
Round 115, Average loss 0.126, Acc 0.985
Round 116, Average loss 0.049, Acc 0.984
Round 117, Average loss 0.120, Acc 0.986
Round 118, Average loss 0.065, Acc 0.984
0.007971615000000001
Round 119, Average loss 0.088, Acc 0.984
Round 120, Average loss 0.104, Acc 0.984
Round 121, Average loss 0.104, Acc 0.985
Round 122, Average loss 0.050, Acc 0.984
Round 123, Average loss 0.058, Acc 0.986
Round 124, Average loss 0.079, Acc 0.984
Round 125, Average loss 0.068, Acc 0.985
Round 126, Average loss 0.089, Acc 0.983
Round 127, Average loss 0.100, Acc 0.983
Round 128, Average loss 0.056, Acc 0.986
Round 129, Average loss 0.095, Acc 0.984
Round 130, Average loss 0.102, Acc 0.986
Round 131, Average loss 0.103, Acc 0.985
Round 132, Average loss 0.059, Acc 0.984
Round 133, Average loss 0.081, Acc 0.983
Round 134, Average loss 0.070, Acc 0.986
Round 135, Average loss 0.118, Acc 0.983
Round 136, Average loss 0.084, Acc 0.984
Round 137, Average loss 0.078, Acc 0.983
Round 138, Average loss 0.099, Acc 0.985
0.007174453500000001
Round 139, Average loss 0.058, Acc 0.985
Round 140, Average loss 0.046, Acc 0.984
Round 141, Average loss 0.070, Acc 0.985
Round 142, Average loss 0.080, Acc 0.986
Round 143, Average loss 0.081, Acc 0.985
Round 144, Average loss 0.050, Acc 0.985
Round 145, Average loss 0.073, Acc 0.987
Round 146, Average loss 0.083, Acc 0.984
Round 147, Average loss 0.076, Acc 0.987
Round 148, Average loss 0.058, Acc 0.984
Round 149, Average loss 0.095, Acc 0.987
Round 150, Average loss 0.065, Acc 0.988
Round 151, Average loss 0.088, Acc 0.985
Round 152, Average loss 0.048, Acc 0.984
Round 153, Average loss 0.035, Acc 0.985
Round 154, Average loss 0.062, Acc 0.984
Round 155, Average loss 0.078, Acc 0.986
Round 156, Average loss 0.090, Acc 0.985
Round 157, Average loss 0.096, Acc 0.985
Round 158, Average loss 0.120, Acc 0.985
0.006457008150000001
Round 159, Average loss 0.100, Acc 0.987
Round 160, Average loss 0.071, Acc 0.986
Round 161, Average loss 0.069, Acc 0.986
Round 162, Average loss 0.067, Acc 0.985
Round 163, Average loss 0.083, Acc 0.985
Round 164, Average loss 0.077, Acc 0.985
Round 165, Average loss 0.077, Acc 0.987
Round 166, Average loss 0.119, Acc 0.988
Round 167, Average loss 0.099, Acc 0.988
Round 168, Average loss 0.085, Acc 0.986
Round 169, Average loss 0.107, Acc 0.985
Round 170, Average loss 0.044, Acc 0.986
Round 171, Average loss 0.107, Acc 0.987
Round 172, Average loss 0.071, Acc 0.986
Round 173, Average loss 0.119, Acc 0.986
Round 174, Average loss 0.050, Acc 0.985
Round 175, Average loss 0.110, Acc 0.976
Round 176, Average loss 0.090, Acc 0.987
Round 177, Average loss 0.053, Acc 0.984
Round 178, Average loss 0.089, Acc 0.984
0.005811307335000002
Round 179, Average loss 0.120, Acc 0.988
Round 180, Average loss 0.094, Acc 0.986
Round 181, Average loss 0.077, Acc 0.987
Round 182, Average loss 0.040, Acc 0.986
Round 183, Average loss 0.085, Acc 0.986
Round 184, Average loss 0.084, Acc 0.986
Round 185, Average loss 0.118, Acc 0.986
Round 186, Average loss 0.038, Acc 0.986
Round 187, Average loss 0.069, Acc 0.986
Round 188, Average loss 0.076, Acc 0.980
Round 189, Average loss 0.080, Acc 0.988
Round 190, Average loss 0.067, Acc 0.988
Round 191, Average loss 0.117, Acc 0.985
Round 192, Average loss 0.052, Acc 0.987
Round 193, Average loss 0.043, Acc 0.986
Round 194, Average loss 0.106, Acc 0.986
Round 195, Average loss 0.122, Acc 0.987
Round 196, Average loss 0.043, Acc 0.988
Round 197, Average loss 0.073, Acc 0.984
Round 198, Average loss 0.102, Acc 0.987
0.005230176601500001
Round 199, Average loss 0.036, Acc 0.988
Round 200, Average loss 0.086, Acc 0.987
Round 201, Average loss 0.084, Acc 0.987
Round 202, Average loss 0.058, Acc 0.987
Round 203, Average loss 0.048, Acc 0.984
Round 204, Average loss 0.054, Acc 0.983
Round 205, Average loss 0.065, Acc 0.986
Round 206, Average loss 0.084, Acc 0.986
Round 207, Average loss 0.096, Acc 0.986
Round 208, Average loss 0.057, Acc 0.986
Round 209, Average loss 0.052, Acc 0.986
Round 210, Average loss 0.122, Acc 0.986
Round 211, Average loss 0.065, Acc 0.987
Round 212, Average loss 0.053, Acc 0.986
Round 213, Average loss 0.107, Acc 0.986
Round 214, Average loss 0.094, Acc 0.986
Round 215, Average loss 0.105, Acc 0.987
Round 216, Average loss 0.060, Acc 0.987
Round 217, Average loss 0.095, Acc 0.988
Round 218, Average loss 0.081, Acc 0.987
0.004707158941350001
Round 219, Average loss 0.089, Acc 0.987
Round 220, Average loss 0.080, Acc 0.986
Round 221, Average loss 0.052, Acc 0.986
Round 222, Average loss 0.059, Acc 0.986
Round 223, Average loss 0.046, Acc 0.987
Round 224, Average loss 0.045, Acc 0.987
Round 225, Average loss 0.054, Acc 0.987
Round 226, Average loss 0.052, Acc 0.987
Round 227, Average loss 0.058, Acc 0.987
Round 228, Average loss 0.028, Acc 0.986
Round 229, Average loss 0.082, Acc 0.988
Round 230, Average loss 0.024, Acc 0.986
Round 231, Average loss 0.060, Acc 0.986
Round 232, Average loss 0.028, Acc 0.988
Round 233, Average loss 0.074, Acc 0.989
Round 234, Average loss 0.047, Acc 0.989
Round 235, Average loss 0.057, Acc 0.990
Round 236, Average loss 0.048, Acc 0.988
Round 237, Average loss 0.073, Acc 0.988
Round 238, Average loss 0.039, Acc 0.987
0.004236443047215001
Round 239, Average loss 0.069, Acc 0.989
Round 240, Average loss 0.053, Acc 0.989
Round 241, Average loss 0.087, Acc 0.988
Round 242, Average loss 0.058, Acc 0.989
Round 243, Average loss 0.054, Acc 0.988
Round 244, Average loss 0.039, Acc 0.987
Round 245, Average loss 0.100, Acc 0.987
Round 246, Average loss 0.076, Acc 0.988
Round 247, Average loss 0.075, Acc 0.987
Round 248, Average loss 0.063, Acc 0.989
Round 249, Average loss 0.039, Acc 0.989
Round 250, Average loss 0.044, Acc 0.987
Round 251, Average loss 0.088, Acc 0.989
Round 252, Average loss 0.049, Acc 0.987
Round 253, Average loss 0.058, Acc 0.988
Round 254, Average loss 0.061, Acc 0.987
Round 255, Average loss 0.060, Acc 0.988
Round 256, Average loss 0.087, Acc 0.989
Round 257, Average loss 0.035, Acc 0.988
Round 258, Average loss 0.065, Acc 0.989
0.003812798742493501
Round 259, Average loss 0.089, Acc 0.989
Round 260, Average loss 0.057, Acc 0.990
Round 261, Average loss 0.060, Acc 0.988
Round 262, Average loss 0.048, Acc 0.988
Round 263, Average loss 0.056, Acc 0.989
Round 264, Average loss 0.036, Acc 0.988
Round 265, Average loss 0.057, Acc 0.988
Round 266, Average loss 0.063, Acc 0.988
Round 267, Average loss 0.046, Acc 0.989
Round 268, Average loss 0.069, Acc 0.989
Round 269, Average loss 0.032, Acc 0.986
Round 270, Average loss 0.028, Acc 0.989
Round 271, Average loss 0.068, Acc 0.989
Round 272, Average loss 0.074, Acc 0.988
Round 273, Average loss 0.062, Acc 0.988
Round 274, Average loss 0.063, Acc 0.987
Round 275, Average loss 0.081, Acc 0.988
Round 276, Average loss 0.074, Acc 0.989
Round 277, Average loss 0.094, Acc 0.987
Round 278, Average loss 0.069, Acc 0.990
0.003431518868244151
Round 279, Average loss 0.050, Acc 0.989
Round 280, Average loss 0.052, Acc 0.990
Round 281, Average loss 0.062, Acc 0.989
Round 282, Average loss 0.095, Acc 0.989
Round 283, Average loss 0.044, Acc 0.990
Round 284, Average loss 0.063, Acc 0.989
Round 285, Average loss 0.042, Acc 0.990
Round 286, Average loss 0.037, Acc 0.988
Round 287, Average loss 0.065, Acc 0.989
Round 288, Average loss 0.063, Acc 0.990
Round 289, Average loss 0.087, Acc 0.988
Round 290, Average loss 0.063, Acc 0.990
Round 291, Average loss 0.089, Acc 0.989
Round 292, Average loss 0.088, Acc 0.989
Round 293, Average loss 0.034, Acc 0.990
Round 294, Average loss 0.058, Acc 0.989
Round 295, Average loss 0.040, Acc 0.990
Round 296, Average loss 0.035, Acc 0.987
Round 297, Average loss 0.059, Acc 0.988
Round 298, Average loss 0.054, Acc 0.988
0.0030883669814197362
Round 299, Average loss 0.048, Acc 0.988
282.87414050102234 s
Memory used: 1684.07 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=90, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.83938885] and score 2 is 0.0
Round   0, Average loss 3.105, Acc 0.000
score 1 is [0.55874956] and score 2 is 0.0
Round   1, Average loss 3.094, Acc 0.000
score 1 is [0.7898846] and score 2 is 0.0
Round   2, Average loss 3.079, Acc 0.000
score 1 is [0.84990424] and score 2 is 0.0
Round   3, Average loss 3.100, Acc 0.000
score 1 is [0.7207568] and score 2 is 0.0
Round   4, Average loss 3.094, Acc 0.000
13.564711809158325 s
Memory used: 1678.98 MB

3e-2 + 100
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=100, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.149, Acc 0.569
Round   1, Average loss 2.602, Acc 0.569
Round   2, Average loss 1.390, Acc 0.569
Round   3, Average loss 0.858, Acc 0.413
Round   4, Average loss 1.121, Acc 0.709
Round   5, Average loss 0.721, Acc 0.407
Round   6, Average loss 0.955, Acc 0.744
Round   7, Average loss 0.672, Acc 0.975
Round   8, Average loss 0.825, Acc 0.749
Round   9, Average loss 0.529, Acc 0.971
Round  10, Average loss 0.727, Acc 0.755
Round  11, Average loss 0.541, Acc 0.979
Round  12, Average loss 0.670, Acc 0.786
Round  13, Average loss 0.632, Acc 0.978
Round  14, Average loss 0.629, Acc 0.786
Round  15, Average loss 0.466, Acc 0.943
Round  16, Average loss 0.598, Acc 0.796
Round  17, Average loss 0.363, Acc 0.981
Round  18, Average loss 0.532, Acc 0.895
0.0135
Round  19, Average loss 0.317, Acc 0.981
Round  20, Average loss 0.405, Acc 0.939
Round  21, Average loss 0.178, Acc 0.981
Round  22, Average loss 0.324, Acc 0.943
Round  23, Average loss 0.191, Acc 0.981
Round  24, Average loss 0.281, Acc 0.943
Round  25, Average loss 0.174, Acc 0.982
Round  26, Average loss 0.271, Acc 0.941
Round  27, Average loss 0.200, Acc 0.981
Round  28, Average loss 0.238, Acc 0.944
Round  29, Average loss 0.172, Acc 0.981
Round  30, Average loss 0.210, Acc 0.962
Round  31, Average loss 0.159, Acc 0.981
Round  32, Average loss 0.182, Acc 0.964
Round  33, Average loss 0.190, Acc 0.980
Round  34, Average loss 0.170, Acc 0.964
Round  35, Average loss 0.122, Acc 0.981
Round  36, Average loss 0.142, Acc 0.965
Round  37, Average loss 0.180, Acc 0.965
Round  38, Average loss 0.207, Acc 0.964
0.01215
Round  39, Average loss 0.135, Acc 0.981
Round  40, Average loss 0.128, Acc 0.965
Round  41, Average loss 0.111, Acc 0.982
Round  42, Average loss 0.075, Acc 0.977
Round  43, Average loss 0.113, Acc 0.982
Round  44, Average loss 0.121, Acc 0.975
Round  45, Average loss 0.150, Acc 0.980
Round  46, Average loss 0.085, Acc 0.957
Round  47, Average loss 0.171, Acc 0.981
Round  48, Average loss 0.118, Acc 0.893
Round  49, Average loss 0.253, Acc 0.982
Round  50, Average loss 0.089, Acc 0.974
Round  51, Average loss 0.113, Acc 0.982
Round  52, Average loss 0.112, Acc 0.977
Round  53, Average loss 0.107, Acc 0.982
Round  54, Average loss 0.117, Acc 0.979
Round  55, Average loss 0.109, Acc 0.982
Round  56, Average loss 0.131, Acc 0.972
Round  57, Average loss 0.132, Acc 0.981
Round  58, Average loss 0.148, Acc 0.972
0.010935
Round  59, Average loss 0.104, Acc 0.981
Round  60, Average loss 0.121, Acc 0.982
Round  61, Average loss 0.098, Acc 0.981
Round  62, Average loss 0.075, Acc 0.980
Round  63, Average loss 0.106, Acc 0.981
Round  64, Average loss 0.163, Acc 0.980
Round  65, Average loss 0.096, Acc 0.981
Round  66, Average loss 0.102, Acc 0.983
Round  67, Average loss 0.062, Acc 0.981
Round  68, Average loss 0.069, Acc 0.984
Round  69, Average loss 0.076, Acc 0.964
Round  70, Average loss 0.138, Acc 0.981
Round  71, Average loss 0.113, Acc 0.978
Round  72, Average loss 0.118, Acc 0.981
Round  73, Average loss 0.178, Acc 0.968
Round  74, Average loss 0.128, Acc 0.981
Round  75, Average loss 0.162, Acc 0.984
Round  76, Average loss 0.087, Acc 0.982
Round  77, Average loss 0.114, Acc 0.987
Round  78, Average loss 0.094, Acc 0.981
0.009841500000000001
Round  79, Average loss 0.114, Acc 0.985
Round  80, Average loss 0.082, Acc 0.982
Round  81, Average loss 0.086, Acc 0.984
Round  82, Average loss 0.087, Acc 0.983
Round  83, Average loss 0.103, Acc 0.981
Round  84, Average loss 0.076, Acc 0.978
Round  85, Average loss 0.080, Acc 0.983
Round  86, Average loss 0.122, Acc 0.984
Round  87, Average loss 0.084, Acc 0.981
Round  88, Average loss 0.051, Acc 0.985
Round  89, Average loss 0.043, Acc 0.984
Round  90, Average loss 0.081, Acc 0.984
Round  91, Average loss 0.103, Acc 0.983
Round  92, Average loss 0.097, Acc 0.982
Round  93, Average loss 0.135, Acc 0.985
Round  94, Average loss 0.083, Acc 0.986
Round  95, Average loss 0.091, Acc 0.984
Round  96, Average loss 0.082, Acc 0.981
Round  97, Average loss 0.086, Acc 0.984
Round  98, Average loss 0.096, Acc 0.982
0.008857350000000002
Round  99, Average loss 0.115, Acc 0.988
Round 100, Average loss 0.049, Acc 0.984
Round 101, Average loss 0.115, Acc 0.987
Round 102, Average loss 0.072, Acc 0.982
Round 103, Average loss 0.114, Acc 0.986
Round 104, Average loss 0.069, Acc 0.982
Round 105, Average loss 0.089, Acc 0.986
Round 106, Average loss 0.046, Acc 0.982
Round 107, Average loss 0.071, Acc 0.986
Round 108, Average loss 0.075, Acc 0.984
Round 109, Average loss 0.085, Acc 0.986
Round 110, Average loss 0.076, Acc 0.982
Round 111, Average loss 0.098, Acc 0.987
Round 112, Average loss 0.079, Acc 0.984
Round 113, Average loss 0.110, Acc 0.985
Round 114, Average loss 0.072, Acc 0.982
Round 115, Average loss 0.089, Acc 0.985
Round 116, Average loss 0.049, Acc 0.982
Round 117, Average loss 0.038, Acc 0.982
Round 118, Average loss 0.078, Acc 0.986
0.007971615000000001
Round 119, Average loss 0.075, Acc 0.985
Round 120, Average loss 0.086, Acc 0.986
Round 121, Average loss 0.069, Acc 0.984
Round 122, Average loss 0.057, Acc 0.985
Round 123, Average loss 0.089, Acc 0.984
Round 124, Average loss 0.088, Acc 0.985
Round 125, Average loss 0.059, Acc 0.984
Round 126, Average loss 0.081, Acc 0.986
Round 127, Average loss 0.066, Acc 0.984
Round 128, Average loss 0.047, Acc 0.986
Round 129, Average loss 0.060, Acc 0.985
Round 130, Average loss 0.076, Acc 0.984
Round 131, Average loss 0.097, Acc 0.984
Round 132, Average loss 0.114, Acc 0.986
Round 133, Average loss 0.083, Acc 0.986
Round 134, Average loss 0.073, Acc 0.985
Round 135, Average loss 0.073, Acc 0.985
Round 136, Average loss 0.069, Acc 0.985
Round 137, Average loss 0.073, Acc 0.985
Round 138, Average loss 0.078, Acc 0.985
0.007174453500000001
Round 139, Average loss 0.085, Acc 0.985
Round 140, Average loss 0.065, Acc 0.986
Round 141, Average loss 0.067, Acc 0.983
Round 142, Average loss 0.056, Acc 0.985
Round 143, Average loss 0.072, Acc 0.982
Round 144, Average loss 0.069, Acc 0.985
Round 145, Average loss 0.058, Acc 0.985
Round 146, Average loss 0.057, Acc 0.985
Round 147, Average loss 0.044, Acc 0.982
Round 148, Average loss 0.058, Acc 0.984
Round 149, Average loss 0.073, Acc 0.985
Round 150, Average loss 0.036, Acc 0.985
Round 151, Average loss 0.085, Acc 0.986
Round 152, Average loss 0.056, Acc 0.982
Round 153, Average loss 0.075, Acc 0.982
Round 154, Average loss 0.067, Acc 0.982
Round 155, Average loss 0.081, Acc 0.987
Round 156, Average loss 0.110, Acc 0.985
Round 157, Average loss 0.072, Acc 0.986
Round 158, Average loss 0.049, Acc 0.984
0.006457008150000001
Round 159, Average loss 0.074, Acc 0.987
Round 160, Average loss 0.058, Acc 0.986
Round 161, Average loss 0.060, Acc 0.985
Round 162, Average loss 0.075, Acc 0.987
Round 163, Average loss 0.089, Acc 0.985
Round 164, Average loss 0.042, Acc 0.986
Round 165, Average loss 0.056, Acc 0.985
Round 166, Average loss 0.038, Acc 0.988
Round 167, Average loss 0.056, Acc 0.983
Round 168, Average loss 0.044, Acc 0.987
Round 169, Average loss 0.064, Acc 0.987
Round 170, Average loss 0.057, Acc 0.985
Round 171, Average loss 0.087, Acc 0.985
Round 172, Average loss 0.069, Acc 0.987
Round 173, Average loss 0.046, Acc 0.985
Round 174, Average loss 0.053, Acc 0.987
Round 175, Average loss 0.062, Acc 0.987
Round 176, Average loss 0.048, Acc 0.987
Round 177, Average loss 0.055, Acc 0.985
Round 178, Average loss 0.044, Acc 0.984
0.005811307335000002
Round 179, Average loss 0.059, Acc 0.985
Round 180, Average loss 0.048, Acc 0.988
Round 181, Average loss 0.065, Acc 0.985
Round 182, Average loss 0.056, Acc 0.983
Round 183, Average loss 0.084, Acc 0.988
Round 184, Average loss 0.041, Acc 0.987
Round 185, Average loss 0.095, Acc 0.986
Round 186, Average loss 0.080, Acc 0.986
Round 187, Average loss 0.089, Acc 0.987
Round 188, Average loss 0.033, Acc 0.987
Round 189, Average loss 0.069, Acc 0.985
Round 190, Average loss 0.079, Acc 0.984
Round 191, Average loss 0.098, Acc 0.984
Round 192, Average loss 0.065, Acc 0.989
Round 193, Average loss 0.057, Acc 0.984
Round 194, Average loss 0.057, Acc 0.985
Round 195, Average loss 0.070, Acc 0.985
Round 196, Average loss 0.027, Acc 0.989
Round 197, Average loss 0.065, Acc 0.989
Round 198, Average loss 0.062, Acc 0.986
0.005230176601500001
Round 199, Average loss 0.038, Acc 0.987
Round 200, Average loss 0.068, Acc 0.988
Round 201, Average loss 0.027, Acc 0.985
Round 202, Average loss 0.075, Acc 0.988
Round 203, Average loss 0.039, Acc 0.986
Round 204, Average loss 0.089, Acc 0.987
Round 205, Average loss 0.043, Acc 0.986
Round 206, Average loss 0.059, Acc 0.988
Round 207, Average loss 0.046, Acc 0.986
Round 208, Average loss 0.062, Acc 0.987
Round 209, Average loss 0.042, Acc 0.986
Round 210, Average loss 0.036, Acc 0.985
Round 211, Average loss 0.078, Acc 0.987
Round 212, Average loss 0.045, Acc 0.987
Round 213, Average loss 0.040, Acc 0.987
Round 214, Average loss 0.063, Acc 0.988
Round 215, Average loss 0.033, Acc 0.986
Round 216, Average loss 0.088, Acc 0.988
Round 217, Average loss 0.055, Acc 0.986
Round 218, Average loss 0.052, Acc 0.988
0.004707158941350001
Round 219, Average loss 0.036, Acc 0.986
Round 220, Average loss 0.066, Acc 0.987
Round 221, Average loss 0.068, Acc 0.985
Round 222, Average loss 0.059, Acc 0.986
Round 223, Average loss 0.047, Acc 0.988
Round 224, Average loss 0.088, Acc 0.987
Round 225, Average loss 0.084, Acc 0.987
Round 226, Average loss 0.066, Acc 0.987
Round 227, Average loss 0.038, Acc 0.987
Round 228, Average loss 0.051, Acc 0.987
Round 229, Average loss 0.043, Acc 0.986
Round 230, Average loss 0.061, Acc 0.987
Round 231, Average loss 0.048, Acc 0.988
Round 232, Average loss 0.055, Acc 0.989
Round 233, Average loss 0.067, Acc 0.988
Round 234, Average loss 0.056, Acc 0.989
Round 235, Average loss 0.038, Acc 0.988
Round 236, Average loss 0.031, Acc 0.988
Round 237, Average loss 0.073, Acc 0.989
Round 238, Average loss 0.045, Acc 0.986
0.004236443047215001
Round 239, Average loss 0.023, Acc 0.986
Round 240, Average loss 0.042, Acc 0.990
Round 241, Average loss 0.040, Acc 0.988
Round 242, Average loss 0.072, Acc 0.990
Round 243, Average loss 0.053, Acc 0.987
Round 244, Average loss 0.048, Acc 0.988
Round 245, Average loss 0.049, Acc 0.987
Round 246, Average loss 0.038, Acc 0.987
Round 247, Average loss 0.051, Acc 0.987
Round 248, Average loss 0.069, Acc 0.988
Round 249, Average loss 0.042, Acc 0.987
Round 250, Average loss 0.048, Acc 0.987
Round 251, Average loss 0.068, Acc 0.987
Round 252, Average loss 0.022, Acc 0.987
Round 253, Average loss 0.036, Acc 0.987
Round 254, Average loss 0.073, Acc 0.987
Round 255, Average loss 0.061, Acc 0.987
Round 256, Average loss 0.049, Acc 0.987
Round 257, Average loss 0.053, Acc 0.987
Round 258, Average loss 0.072, Acc 0.987
0.003812798742493501
Round 259, Average loss 0.043, Acc 0.987
Round 260, Average loss 0.035, Acc 0.987
Round 261, Average loss 0.066, Acc 0.988
Round 262, Average loss 0.078, Acc 0.988
Round 263, Average loss 0.067, Acc 0.989
Round 264, Average loss 0.059, Acc 0.989
Round 265, Average loss 0.026, Acc 0.988
Round 266, Average loss 0.039, Acc 0.988
Round 267, Average loss 0.040, Acc 0.986
Round 268, Average loss 0.082, Acc 0.989
Round 269, Average loss 0.052, Acc 0.985
Round 270, Average loss 0.079, Acc 0.989
Round 271, Average loss 0.053, Acc 0.988
Round 272, Average loss 0.035, Acc 0.989
Round 273, Average loss 0.049, Acc 0.989
Round 274, Average loss 0.047, Acc 0.986
Round 275, Average loss 0.037, Acc 0.986
Round 276, Average loss 0.072, Acc 0.988
Round 277, Average loss 0.063, Acc 0.985
Round 278, Average loss 0.035, Acc 0.987
0.003431518868244151
Round 279, Average loss 0.046, Acc 0.988
Round 280, Average loss 0.028, Acc 0.988
Round 281, Average loss 0.055, Acc 0.989
Round 282, Average loss 0.037, Acc 0.986
Round 283, Average loss 0.021, Acc 0.987
Round 284, Average loss 0.042, Acc 0.989
Round 285, Average loss 0.078, Acc 0.989
Round 286, Average loss 0.078, Acc 0.989
Round 287, Average loss 0.070, Acc 0.988
Round 288, Average loss 0.071, Acc 0.988
Round 289, Average loss 0.033, Acc 0.989
Round 290, Average loss 0.039, Acc 0.986
Round 291, Average loss 0.039, Acc 0.987
Round 292, Average loss 0.051, Acc 0.987
Round 293, Average loss 0.067, Acc 0.988
Round 294, Average loss 0.051, Acc 0.988
Round 295, Average loss 0.041, Acc 0.987
Round 296, Average loss 0.089, Acc 0.988
Round 297, Average loss 0.046, Acc 0.988
Round 298, Average loss 0.041, Acc 0.988
0.0030883669814197362
Round 299, Average loss 0.026, Acc 0.985
319.88766384124756 s
Memory used: 1665.04 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=100, defense_lr=0.03, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.76513577] and score 2 is 0.0
Round   0, Average loss 3.267, Acc 0.000
score 1 is [0.8200662] and score 2 is 0.0
Round   1, Average loss 3.268, Acc 0.000
score 1 is [0.8274357] and score 2 is 0.0
Round   2, Average loss 3.268, Acc 0.000
score 1 is [0.78752136] and score 2 is 0.0
Round   3, Average loss 3.268, Acc 0.000
score 1 is [0.6976156] and score 2 is 0.0
Round   4, Average loss 3.268, Acc 0.000
12.437600135803223 s
Memory used: 1681.87 MB

8e-2 + 10
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=10, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.134, Acc 0.569
Round   1, Average loss 2.586, Acc 0.569
Round   2, Average loss 1.535, Acc 0.569
Round   3, Average loss 1.060, Acc 0.569
Round   4, Average loss 1.025, Acc 0.569
Round   5, Average loss 1.107, Acc 0.569
Round   6, Average loss 1.114, Acc 0.569
Round   7, Average loss 1.658, Acc 0.569
Round   8, Average loss 3.189, Acc 0.569
Round   9, Average loss 1.430, Acc 0.569
Round  10, Average loss 2.464, Acc 0.569
Round  11, Average loss 1.923, Acc 0.569
Round  12, Average loss 2.735, Acc 0.705
Round  13, Average loss 1.350, Acc 0.569
Round  14, Average loss 2.363, Acc 0.764
Round  15, Average loss 1.429, Acc 0.196
Round  16, Average loss 4.097, Acc 0.590
Round  17, Average loss 1.461, Acc 0.196
Round  18, Average loss 3.490, Acc 0.569
0.0135
Round  19, Average loss 1.302, Acc 0.569
Round  20, Average loss 1.537, Acc 0.830
Round  21, Average loss 1.113, Acc 0.569
Round  22, Average loss 1.329, Acc 0.951
Round  23, Average loss 1.003, Acc 0.569
Round  24, Average loss 1.279, Acc 0.968
Round  25, Average loss 1.179, Acc 0.217
Round  26, Average loss 2.387, Acc 0.980
Round  27, Average loss 1.031, Acc 0.786
Round  28, Average loss 1.022, Acc 0.764
Round  29, Average loss 1.210, Acc 0.233
Round  30, Average loss 2.493, Acc 0.217
Round  31, Average loss 1.682, Acc 0.936
Round  32, Average loss 0.982, Acc 0.744
Round  33, Average loss 1.290, Acc 0.217
Round  34, Average loss 1.507, Acc 0.752
Round  35, Average loss 1.005, Acc 0.217
Round  36, Average loss 1.157, Acc 0.569
Round  37, Average loss 0.921, Acc 0.740
Round  38, Average loss 1.336, Acc 0.785
0.01215
Round  39, Average loss 1.136, Acc 0.370
Round  40, Average loss 1.331, Acc 0.783
Round  41, Average loss 0.996, Acc 0.196
Round  42, Average loss 1.249, Acc 0.744
Round  43, Average loss 0.777, Acc 0.569
Round  44, Average loss 1.052, Acc 0.744
Round  45, Average loss 1.013, Acc 0.217
Round  46, Average loss 1.260, Acc 0.739
Round  47, Average loss 0.996, Acc 0.569
Round  48, Average loss 1.178, Acc 0.569
Round  49, Average loss 0.992, Acc 0.569
Round  50, Average loss 1.253, Acc 0.744
Round  51, Average loss 0.984, Acc 0.569
Round  52, Average loss 1.324, Acc 0.742
Round  53, Average loss 1.026, Acc 0.740
Round  54, Average loss 1.165, Acc 0.745
Round  55, Average loss 0.780, Acc 0.569
Round  56, Average loss 1.372, Acc 0.745
Round  57, Average loss 0.726, Acc 0.744
Round  58, Average loss 0.989, Acc 0.569
0.010935
Round  59, Average loss 1.349, Acc 0.746
Round  60, Average loss 0.936, Acc 0.967
Round  61, Average loss 0.931, Acc 0.569
Round  62, Average loss 1.099, Acc 0.761
Round  63, Average loss 1.092, Acc 0.569
Round  64, Average loss 1.216, Acc 0.757
Round  65, Average loss 1.031, Acc 0.569
Round  66, Average loss 1.207, Acc 0.755
Round  67, Average loss 1.095, Acc 0.569
Round  68, Average loss 1.176, Acc 0.741
Round  69, Average loss 0.900, Acc 0.569
Round  70, Average loss 1.176, Acc 0.743
Round  71, Average loss 0.931, Acc 0.732
Round  72, Average loss 1.017, Acc 0.569
Round  73, Average loss 1.312, Acc 0.606
Round  74, Average loss 0.907, Acc 0.569
Round  75, Average loss 1.366, Acc 0.569
Round  76, Average loss 1.604, Acc 0.569
Round  77, Average loss 1.337, Acc 0.569
Round  78, Average loss 1.698, Acc 0.743
0.009841500000000001
Round  79, Average loss 1.210, Acc 0.744
Round  80, Average loss 0.951, Acc 0.907
Round  81, Average loss 0.604, Acc 0.776
Round  82, Average loss 0.642, Acc 0.786
Round  83, Average loss 0.757, Acc 0.400
Round  84, Average loss 1.301, Acc 0.946
Round  85, Average loss 0.707, Acc 0.764
Round  86, Average loss 1.056, Acc 0.217
Round  87, Average loss 1.394, Acc 0.764
Round  88, Average loss 1.110, Acc 0.977
Round  89, Average loss 1.202, Acc 0.786
Round  90, Average loss 0.896, Acc 0.569
Round  91, Average loss 1.075, Acc 0.845
Round  92, Average loss 0.953, Acc 0.744
Round  93, Average loss 0.879, Acc 0.810
Round  94, Average loss 0.792, Acc 0.696
Round  95, Average loss 0.913, Acc 0.936
Round  96, Average loss 0.937, Acc 0.608
Round  97, Average loss 0.835, Acc 0.745
Round  98, Average loss 0.854, Acc 0.859
0.008857350000000002
Round  99, Average loss 0.795, Acc 0.952
Round 100, Average loss 1.268, Acc 0.786
Round 101, Average loss 0.795, Acc 0.764
Round 102, Average loss 1.060, Acc 0.785
Round 103, Average loss 0.874, Acc 0.765
Round 104, Average loss 1.092, Acc 0.785
Round 105, Average loss 1.140, Acc 0.747
Round 106, Average loss 1.055, Acc 0.744
Round 107, Average loss 1.033, Acc 0.924
Round 108, Average loss 1.024, Acc 0.785
Round 109, Average loss 0.971, Acc 0.806
Round 110, Average loss 0.984, Acc 0.764
Round 111, Average loss 1.196, Acc 0.791
Round 112, Average loss 0.977, Acc 0.590
Round 113, Average loss 1.096, Acc 0.787
Round 114, Average loss 1.114, Acc 0.569
Round 115, Average loss 1.027, Acc 0.803
Round 116, Average loss 1.130, Acc 0.569
Round 117, Average loss 1.011, Acc 0.813
Round 118, Average loss 1.145, Acc 0.569
0.007971615000000001
Round 119, Average loss 1.148, Acc 0.796
Round 120, Average loss 1.038, Acc 0.569
Round 121, Average loss 1.157, Acc 0.816
Round 122, Average loss 1.171, Acc 0.569
Round 123, Average loss 1.122, Acc 0.807
Round 124, Average loss 1.249, Acc 0.569
Round 125, Average loss 1.030, Acc 0.804
Round 126, Average loss 1.071, Acc 0.569
Round 127, Average loss 0.942, Acc 0.802
Round 128, Average loss 1.105, Acc 0.569
Round 129, Average loss 1.032, Acc 0.800
Round 130, Average loss 1.289, Acc 0.785
Round 131, Average loss 0.888, Acc 0.754
Round 132, Average loss 1.047, Acc 0.758
Round 133, Average loss 0.934, Acc 0.802
Round 134, Average loss 0.891, Acc 0.786
Round 135, Average loss 0.888, Acc 0.808
Round 136, Average loss 0.977, Acc 0.786
Round 137, Average loss 0.775, Acc 0.786
Round 138, Average loss 1.031, Acc 0.789
0.007174453500000001
Round 139, Average loss 0.847, Acc 0.981
Round 140, Average loss 0.853, Acc 0.787
Round 141, Average loss 0.820, Acc 0.821
Round 142, Average loss 0.815, Acc 0.786
Round 143, Average loss 0.757, Acc 0.973
Round 144, Average loss 0.900, Acc 0.786
Round 145, Average loss 0.788, Acc 0.952
Round 146, Average loss 0.811, Acc 0.786
Round 147, Average loss 0.681, Acc 0.915
Round 148, Average loss 0.786, Acc 0.789
Round 149, Average loss 0.663, Acc 0.969
Round 150, Average loss 0.843, Acc 0.932
Round 151, Average loss 0.785, Acc 0.785
Round 152, Average loss 0.889, Acc 0.982
Round 153, Average loss 1.042, Acc 0.785
Round 154, Average loss 1.040, Acc 0.787
Round 155, Average loss 0.928, Acc 0.956
Round 156, Average loss 0.973, Acc 0.955
Round 157, Average loss 0.696, Acc 0.982
Round 158, Average loss 0.558, Acc 0.762
0.006457008150000001
Round 159, Average loss 0.643, Acc 0.981
Round 160, Average loss 0.572, Acc 0.977
Round 161, Average loss 0.445, Acc 0.976
Round 162, Average loss 0.521, Acc 0.978
Round 163, Average loss 0.400, Acc 0.942
Round 164, Average loss 0.677, Acc 0.942
Round 165, Average loss 0.556, Acc 0.966
Round 166, Average loss 0.673, Acc 0.763
Round 167, Average loss 0.638, Acc 0.980
Round 168, Average loss 0.567, Acc 0.933
Round 169, Average loss 0.808, Acc 0.971
Round 170, Average loss 0.569, Acc 0.785
Round 171, Average loss 0.635, Acc 0.785
Round 172, Average loss 0.761, Acc 0.786
Round 173, Average loss 0.659, Acc 0.785
Round 174, Average loss 0.797, Acc 0.785
Round 175, Average loss 0.725, Acc 0.785
Round 176, Average loss 0.829, Acc 0.785
Round 177, Average loss 0.678, Acc 0.785
Round 178, Average loss 0.719, Acc 0.785
0.005811307335000002
Round 179, Average loss 0.882, Acc 0.752
Round 180, Average loss 0.890, Acc 0.785
Round 181, Average loss 0.955, Acc 0.785
Round 182, Average loss 0.777, Acc 0.785
Round 183, Average loss 0.673, Acc 0.785
Round 184, Average loss 0.664, Acc 0.786
Round 185, Average loss 0.627, Acc 0.786
Round 186, Average loss 0.541, Acc 0.786
Round 187, Average loss 0.558, Acc 0.786
Round 188, Average loss 0.447, Acc 0.786
Round 189, Average loss 0.629, Acc 0.786
Round 190, Average loss 0.475, Acc 0.834
Round 191, Average loss 0.496, Acc 0.786
Round 192, Average loss 0.558, Acc 0.802
Round 193, Average loss 0.510, Acc 0.795
Round 194, Average loss 0.612, Acc 0.842
Round 195, Average loss 0.601, Acc 0.786
Round 196, Average loss 0.640, Acc 0.786
Round 197, Average loss 0.637, Acc 0.786
Round 198, Average loss 0.665, Acc 0.786
0.005230176601500001
Round 199, Average loss 0.750, Acc 0.785
Round 200, Average loss 1.214, Acc 0.785
Round 201, Average loss 0.767, Acc 0.785
Round 202, Average loss 0.958, Acc 0.785
Round 203, Average loss 1.091, Acc 0.217
Round 204, Average loss 1.593, Acc 0.786
Round 205, Average loss 1.145, Acc 0.218
Round 206, Average loss 1.289, Acc 0.217
Round 207, Average loss 1.442, Acc 0.786
Round 208, Average loss 0.926, Acc 0.786
Round 209, Average loss 1.253, Acc 0.785
Round 210, Average loss 1.222, Acc 0.786
Round 211, Average loss 1.225, Acc 0.217
Round 212, Average loss 1.411, Acc 0.786
Round 213, Average loss 0.992, Acc 0.218
Round 214, Average loss 1.418, Acc 0.786
Round 215, Average loss 1.338, Acc 0.218
Round 216, Average loss 1.425, Acc 0.785
Round 217, Average loss 1.295, Acc 0.785
Round 218, Average loss 1.418, Acc 0.786
0.004707158941350001
Round 219, Average loss 1.110, Acc 0.786
Round 220, Average loss 1.342, Acc 0.786
Round 221, Average loss 1.083, Acc 0.785
Round 222, Average loss 1.205, Acc 0.786
Round 223, Average loss 1.179, Acc 0.786
Round 224, Average loss 1.170, Acc 0.786
Round 225, Average loss 1.229, Acc 0.217
Round 226, Average loss 1.216, Acc 0.786
Round 227, Average loss 1.309, Acc 0.786
Round 228, Average loss 1.341, Acc 0.218
Round 229, Average loss 1.240, Acc 0.786
Round 230, Average loss 1.003, Acc 0.218
Round 231, Average loss 1.265, Acc 0.786
Round 232, Average loss 1.173, Acc 0.785
Round 233, Average loss 1.108, Acc 0.786
Round 234, Average loss 0.936, Acc 0.786
Round 235, Average loss 1.047, Acc 0.786
Round 236, Average loss 0.999, Acc 0.786
Round 237, Average loss 1.188, Acc 0.786
Round 238, Average loss 1.124, Acc 0.217
0.004236443047215001
Round 239, Average loss 1.307, Acc 0.217
Round 240, Average loss 1.319, Acc 0.218
Round 241, Average loss 1.049, Acc 0.785
Round 242, Average loss 1.058, Acc 0.217
Round 243, Average loss 1.226, Acc 0.786
Round 244, Average loss 0.972, Acc 0.785
Round 245, Average loss 1.041, Acc 0.785
Round 246, Average loss 1.048, Acc 0.786
Round 247, Average loss 1.020, Acc 0.217
Round 248, Average loss 1.380, Acc 0.786
Round 249, Average loss 0.928, Acc 0.786
Round 250, Average loss 1.007, Acc 0.217
Round 251, Average loss 1.336, Acc 0.786
Round 252, Average loss 0.975, Acc 0.217
Round 253, Average loss 1.237, Acc 0.786
Round 254, Average loss 1.024, Acc 0.786
Round 255, Average loss 0.899, Acc 0.220
Round 256, Average loss 1.098, Acc 0.785
Round 257, Average loss 0.946, Acc 0.788
Round 258, Average loss 0.816, Acc 0.786
0.003812798742493501
Round 259, Average loss 0.970, Acc 0.217
Round 260, Average loss 1.159, Acc 0.786
Round 261, Average loss 0.973, Acc 0.786
Round 262, Average loss 1.083, Acc 0.786
Round 263, Average loss 1.112, Acc 0.786
Round 264, Average loss 0.902, Acc 0.786
Round 265, Average loss 0.884, Acc 0.786
Round 266, Average loss 1.105, Acc 0.785
Round 267, Average loss 1.073, Acc 0.786
Round 268, Average loss 0.914, Acc 0.786
Round 269, Average loss 0.847, Acc 0.230
Round 270, Average loss 1.178, Acc 0.786
Round 271, Average loss 0.879, Acc 0.785
Round 272, Average loss 1.049, Acc 0.786
Round 273, Average loss 0.771, Acc 0.786
Round 274, Average loss 0.844, Acc 0.786
Round 275, Average loss 0.965, Acc 0.786
Round 276, Average loss 1.093, Acc 0.786
Round 277, Average loss 1.176, Acc 0.786
Round 278, Average loss 1.250, Acc 0.786
0.003431518868244151
Round 279, Average loss 1.172, Acc 0.786
Round 280, Average loss 1.150, Acc 0.786
Round 281, Average loss 1.142, Acc 0.786
Round 282, Average loss 1.431, Acc 0.786
Round 283, Average loss 1.205, Acc 0.786
Round 284, Average loss 1.071, Acc 0.786
Round 285, Average loss 1.377, Acc 0.786
Round 286, Average loss 1.186, Acc 0.786
Round 287, Average loss 1.148, Acc 0.786
Round 288, Average loss 1.006, Acc 0.786
Round 289, Average loss 0.799, Acc 0.786
Round 290, Average loss 0.817, Acc 0.786
Round 291, Average loss 0.801, Acc 0.786
Round 292, Average loss 0.720, Acc 0.786
Round 293, Average loss 0.813, Acc 0.786
Round 294, Average loss 0.821, Acc 0.786
Round 295, Average loss 0.921, Acc 0.786
Round 296, Average loss 1.122, Acc 0.786
Round 297, Average loss 1.209, Acc 0.786
Round 298, Average loss 1.054, Acc 0.786
0.0030883669814197362
Round 299, Average loss 1.142, Acc 0.786
146.59705924987793 s
Memory used: 1658.88 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=10, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.96074826] and score 2 is 0.0
Round   0, Average loss 3.318, Acc 0.000
score 1 is [0.8399688] and score 2 is 0.0
Round   1, Average loss 3.100, Acc 0.000
score 1 is [0.93717754] and score 2 is 0.0
Round   2, Average loss 3.318, Acc 0.000
score 1 is [0.9223349] and score 2 is 0.0
Round   3, Average loss 3.119, Acc 0.000
score 1 is [0.91494966] and score 2 is 0.0
Round   4, Average loss 3.318, Acc 0.000
10.964461326599121 s
Memory used: 1701.69 MB

8e-2 + 20
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=20, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.160, Acc 0.569
Round   1, Average loss 2.631, Acc 0.569
Round   2, Average loss 1.713, Acc 0.569
Round   3, Average loss 1.309, Acc 0.742
Round   4, Average loss 1.365, Acc 0.569
Round   5, Average loss 1.050, Acc 0.743
Round   6, Average loss 1.282, Acc 0.743
Round   7, Average loss 0.970, Acc 0.744
Round   8, Average loss 1.110, Acc 0.744
Round   9, Average loss 0.759, Acc 0.744
Round  10, Average loss 1.037, Acc 0.744
Round  11, Average loss 0.744, Acc 0.744
Round  12, Average loss 1.084, Acc 0.744
Round  13, Average loss 0.695, Acc 0.744
Round  14, Average loss 1.073, Acc 0.744
Round  15, Average loss 0.776, Acc 0.741
Round  16, Average loss 1.045, Acc 0.744
Round  17, Average loss 0.726, Acc 0.744
Round  18, Average loss 0.860, Acc 0.744
0.0135
Round  19, Average loss 0.758, Acc 0.894
Round  20, Average loss 0.879, Acc 0.720
Round  21, Average loss 1.134, Acc 0.934
Round  22, Average loss 0.906, Acc 0.743
Round  23, Average loss 0.991, Acc 0.744
Round  24, Average loss 0.800, Acc 0.743
Round  25, Average loss 1.203, Acc 0.790
Round  26, Average loss 0.835, Acc 0.745
Round  27, Average loss 0.889, Acc 0.980
Round  28, Average loss 0.632, Acc 0.787
Round  29, Average loss 0.643, Acc 0.945
Round  30, Average loss 1.187, Acc 0.794
Round  31, Average loss 0.702, Acc 0.982
Round  32, Average loss 0.935, Acc 0.906
Round  33, Average loss 0.631, Acc 0.981
Round  34, Average loss 1.265, Acc 0.938
Round  35, Average loss 0.588, Acc 0.931
Round  36, Average loss 0.477, Acc 0.963
Round  37, Average loss 0.771, Acc 0.878
Round  38, Average loss 0.650, Acc 0.949
0.01215
Round  39, Average loss 0.496, Acc 0.881
Round  40, Average loss 0.534, Acc 0.946
Round  41, Average loss 0.595, Acc 0.903
Round  42, Average loss 0.538, Acc 0.941
Round  43, Average loss 0.382, Acc 0.943
Round  44, Average loss 0.618, Acc 0.943
Round  45, Average loss 0.377, Acc 0.966
Round  46, Average loss 0.792, Acc 0.978
Round  47, Average loss 0.699, Acc 0.943
Round  48, Average loss 0.570, Acc 0.967
Round  49, Average loss 0.337, Acc 0.941
Round  50, Average loss 0.577, Acc 0.944
Round  51, Average loss 0.585, Acc 0.965
Round  52, Average loss 0.369, Acc 0.943
Round  53, Average loss 0.770, Acc 0.944
Round  54, Average loss 0.363, Acc 0.942
Round  55, Average loss 0.555, Acc 0.966
Round  56, Average loss 0.409, Acc 0.942
Round  57, Average loss 0.640, Acc 0.962
Round  58, Average loss 0.397, Acc 0.944
0.010935
Round  59, Average loss 0.389, Acc 0.963
Round  60, Average loss 0.613, Acc 0.981
Round  61, Average loss 0.591, Acc 0.945
Round  62, Average loss 0.446, Acc 0.942
Round  63, Average loss 0.335, Acc 0.979
Round  64, Average loss 0.366, Acc 0.944
Round  65, Average loss 0.300, Acc 0.964
Round  66, Average loss 0.265, Acc 0.969
Round  67, Average loss 0.490, Acc 0.945
Round  68, Average loss 0.415, Acc 0.973
Round  69, Average loss 0.438, Acc 0.942
Round  70, Average loss 0.454, Acc 0.969
Round  71, Average loss 0.309, Acc 0.945
Round  72, Average loss 0.470, Acc 0.934
Round  73, Average loss 0.470, Acc 0.931
Round  74, Average loss 0.596, Acc 0.938
Round  75, Average loss 0.695, Acc 0.945
Round  76, Average loss 0.653, Acc 0.946
Round  77, Average loss 0.441, Acc 0.979
Round  78, Average loss 0.465, Acc 0.964
0.009841500000000001
Round  79, Average loss 0.609, Acc 0.967
Round  80, Average loss 0.453, Acc 0.963
Round  81, Average loss 0.414, Acc 0.902
Round  82, Average loss 0.699, Acc 0.965
Round  83, Average loss 0.403, Acc 0.959
Round  84, Average loss 0.384, Acc 0.967
Round  85, Average loss 0.345, Acc 0.342
Round  86, Average loss 1.722, Acc 0.973
Round  87, Average loss 0.386, Acc 0.950
Round  88, Average loss 0.363, Acc 0.948
Round  89, Average loss 0.381, Acc 0.961
Round  90, Average loss 0.308, Acc 0.964
Round  91, Average loss 0.328, Acc 0.978
Round  92, Average loss 0.273, Acc 0.976
Round  93, Average loss 0.506, Acc 0.980
Round  94, Average loss 0.506, Acc 0.979
Round  95, Average loss 0.340, Acc 0.978
Round  96, Average loss 0.364, Acc 0.959
Round  97, Average loss 0.329, Acc 0.977
Round  98, Average loss 0.329, Acc 0.969
0.008857350000000002
Round  99, Average loss 0.307, Acc 0.945
Round 100, Average loss 0.461, Acc 0.956
Round 101, Average loss 0.330, Acc 0.940
Round 102, Average loss 0.492, Acc 0.960
Round 103, Average loss 0.425, Acc 0.936
Round 104, Average loss 0.306, Acc 0.937
Round 105, Average loss 0.401, Acc 0.937
Round 106, Average loss 0.298, Acc 0.915
Round 107, Average loss 0.387, Acc 0.815
Round 108, Average loss 0.477, Acc 0.932
Round 109, Average loss 0.257, Acc 0.918
Round 110, Average loss 0.414, Acc 0.851
Round 111, Average loss 0.337, Acc 0.747
Round 112, Average loss 0.685, Acc 0.810
Round 113, Average loss 0.483, Acc 0.779
Round 114, Average loss 0.604, Acc 0.894
Round 115, Average loss 0.409, Acc 0.788
Round 116, Average loss 0.520, Acc 0.938
Round 117, Average loss 0.411, Acc 0.944
Round 118, Average loss 0.301, Acc 0.941
0.007971615000000001
Round 119, Average loss 0.347, Acc 0.965
Round 120, Average loss 0.246, Acc 0.394
Round 121, Average loss 0.647, Acc 0.942
Round 122, Average loss 0.298, Acc 0.980
Round 123, Average loss 0.345, Acc 0.940
Round 124, Average loss 0.370, Acc 0.957
Round 125, Average loss 0.282, Acc 0.940
Round 126, Average loss 0.261, Acc 0.918
Round 127, Average loss 0.236, Acc 0.960
Round 128, Average loss 0.295, Acc 0.400
Round 129, Average loss 1.871, Acc 0.932
Round 130, Average loss 0.390, Acc 0.411
Round 131, Average loss 0.620, Acc 0.939
Round 132, Average loss 0.335, Acc 0.973
Round 133, Average loss 0.471, Acc 0.932
Round 134, Average loss 0.431, Acc 0.969
Round 135, Average loss 0.355, Acc 0.890
Round 136, Average loss 0.366, Acc 0.966
Round 137, Average loss 0.308, Acc 0.890
Round 138, Average loss 0.371, Acc 0.960
0.007174453500000001
Round 139, Average loss 0.283, Acc 0.893
Round 140, Average loss 0.320, Acc 0.961
Round 141, Average loss 0.307, Acc 0.909
Round 142, Average loss 0.383, Acc 0.966
Round 143, Average loss 0.356, Acc 0.898
Round 144, Average loss 0.494, Acc 0.962
Round 145, Average loss 0.326, Acc 0.894
Round 146, Average loss 0.392, Acc 0.963
Round 147, Average loss 0.313, Acc 0.897
Round 148, Average loss 0.415, Acc 0.962
Round 149, Average loss 0.318, Acc 0.914
Round 150, Average loss 0.318, Acc 0.962
Round 151, Average loss 0.325, Acc 0.931
Round 152, Average loss 0.381, Acc 0.955
Round 153, Average loss 0.328, Acc 0.917
Round 154, Average loss 0.375, Acc 0.959
Round 155, Average loss 0.278, Acc 0.891
Round 156, Average loss 0.505, Acc 0.959
Round 157, Average loss 0.234, Acc 0.893
Round 158, Average loss 0.366, Acc 0.961
0.006457008150000001
Round 159, Average loss 0.301, Acc 0.936
Round 160, Average loss 0.410, Acc 0.960
Round 161, Average loss 0.343, Acc 0.936
Round 162, Average loss 0.344, Acc 0.966
Round 163, Average loss 0.314, Acc 0.936
Round 164, Average loss 0.391, Acc 0.968
Round 165, Average loss 0.369, Acc 0.933
Round 166, Average loss 0.346, Acc 0.968
Round 167, Average loss 0.326, Acc 0.932
Round 168, Average loss 0.384, Acc 0.967
Round 169, Average loss 0.274, Acc 0.931
Round 170, Average loss 0.333, Acc 0.970
Round 171, Average loss 0.373, Acc 0.931
Round 172, Average loss 0.312, Acc 0.970
Round 173, Average loss 0.369, Acc 0.931
Round 174, Average loss 0.350, Acc 0.970
Round 175, Average loss 0.410, Acc 0.932
Round 176, Average loss 0.394, Acc 0.975
Round 177, Average loss 0.505, Acc 0.931
Round 178, Average loss 0.400, Acc 0.976
0.005811307335000002
Round 179, Average loss 0.573, Acc 0.933
Round 180, Average loss 0.318, Acc 0.977
Round 181, Average loss 0.406, Acc 0.930
Round 182, Average loss 0.336, Acc 0.969
Round 183, Average loss 0.446, Acc 0.920
Round 184, Average loss 0.385, Acc 0.968
Round 185, Average loss 0.472, Acc 0.920
Round 186, Average loss 0.357, Acc 0.960
Round 187, Average loss 0.425, Acc 0.908
Round 188, Average loss 0.356, Acc 0.965
Round 189, Average loss 0.413, Acc 0.921
Round 190, Average loss 0.242, Acc 0.950
Round 191, Average loss 0.409, Acc 0.911
Round 192, Average loss 0.533, Acc 0.921
Round 193, Average loss 0.357, Acc 0.939
Round 194, Average loss 0.294, Acc 0.412
Round 195, Average loss 1.355, Acc 0.933
Round 196, Average loss 0.333, Acc 0.412
Round 197, Average loss 1.574, Acc 0.936
Round 198, Average loss 0.276, Acc 0.408
0.005230176601500001
Round 199, Average loss 1.317, Acc 0.932
Round 200, Average loss 0.280, Acc 0.409
Round 201, Average loss 1.237, Acc 0.930
Round 202, Average loss 0.302, Acc 0.939
Round 203, Average loss 0.248, Acc 0.935
Round 204, Average loss 0.411, Acc 0.958
Round 205, Average loss 0.345, Acc 0.930
Round 206, Average loss 0.290, Acc 0.950
Round 207, Average loss 0.264, Acc 0.937
Round 208, Average loss 0.268, Acc 0.977
Round 209, Average loss 0.550, Acc 0.936
Round 210, Average loss 0.305, Acc 0.977
Round 211, Average loss 0.363, Acc 0.932
Round 212, Average loss 0.347, Acc 0.970
Round 213, Average loss 0.354, Acc 0.930
Round 214, Average loss 0.331, Acc 0.962
Round 215, Average loss 0.357, Acc 0.937
Round 216, Average loss 0.296, Acc 0.973
Round 217, Average loss 0.417, Acc 0.935
Round 218, Average loss 0.330, Acc 0.975
0.004707158941350001
Round 219, Average loss 0.304, Acc 0.937
Round 220, Average loss 0.306, Acc 0.975
Round 221, Average loss 0.318, Acc 0.938
Round 222, Average loss 0.344, Acc 0.975
Round 223, Average loss 0.365, Acc 0.939
Round 224, Average loss 0.326, Acc 0.975
Round 225, Average loss 0.309, Acc 0.939
Round 226, Average loss 0.273, Acc 0.974
Round 227, Average loss 0.332, Acc 0.941
Round 228, Average loss 0.289, Acc 0.977
Round 229, Average loss 0.317, Acc 0.941
Round 230, Average loss 0.291, Acc 0.974
Round 231, Average loss 0.240, Acc 0.941
Round 232, Average loss 0.261, Acc 0.965
Round 233, Average loss 0.165, Acc 0.942
Round 234, Average loss 0.280, Acc 0.975
Round 235, Average loss 0.220, Acc 0.942
Round 236, Average loss 0.271, Acc 0.978
Round 237, Average loss 0.232, Acc 0.942
Round 238, Average loss 0.268, Acc 0.977
0.004236443047215001
Round 239, Average loss 0.249, Acc 0.943
Round 240, Average loss 0.178, Acc 0.974
Round 241, Average loss 0.132, Acc 0.978
Round 242, Average loss 0.259, Acc 0.960
Round 243, Average loss 0.225, Acc 0.980
Round 244, Average loss 0.196, Acc 0.945
Round 245, Average loss 0.235, Acc 0.979
Round 246, Average loss 0.194, Acc 0.945
Round 247, Average loss 0.194, Acc 0.978
Round 248, Average loss 0.206, Acc 0.960
Round 249, Average loss 0.152, Acc 0.980
Round 250, Average loss 0.235, Acc 0.960
Round 251, Average loss 0.214, Acc 0.978
Round 252, Average loss 0.251, Acc 0.960
Round 253, Average loss 0.150, Acc 0.978
Round 254, Average loss 0.221, Acc 0.961
Round 255, Average loss 0.244, Acc 0.980
Round 256, Average loss 0.191, Acc 0.961
Round 257, Average loss 0.188, Acc 0.980
Round 258, Average loss 0.148, Acc 0.961
0.003812798742493501
Round 259, Average loss 0.249, Acc 0.978
Round 260, Average loss 0.156, Acc 0.971
Round 261, Average loss 0.233, Acc 0.981
Round 262, Average loss 0.286, Acc 0.968
Round 263, Average loss 0.191, Acc 0.981
Round 264, Average loss 0.192, Acc 0.965
Round 265, Average loss 0.182, Acc 0.981
Round 266, Average loss 0.177, Acc 0.965
Round 267, Average loss 0.190, Acc 0.980
Round 268, Average loss 0.212, Acc 0.965
Round 269, Average loss 0.269, Acc 0.981
Round 270, Average loss 0.260, Acc 0.965
Round 271, Average loss 0.168, Acc 0.981
Round 272, Average loss 0.153, Acc 0.965
Round 273, Average loss 0.101, Acc 0.980
Round 274, Average loss 0.150, Acc 0.965
Round 275, Average loss 0.213, Acc 0.980
Round 276, Average loss 0.176, Acc 0.968
Round 277, Average loss 0.199, Acc 0.980
Round 278, Average loss 0.201, Acc 0.973
0.003431518868244151
Round 279, Average loss 0.146, Acc 0.980
Round 280, Average loss 0.189, Acc 0.974
Round 281, Average loss 0.160, Acc 0.965
Round 282, Average loss 0.165, Acc 0.975
Round 283, Average loss 0.178, Acc 0.981
Round 284, Average loss 0.193, Acc 0.972
Round 285, Average loss 0.182, Acc 0.981
Round 286, Average loss 0.268, Acc 0.973
Round 287, Average loss 0.189, Acc 0.981
Round 288, Average loss 0.157, Acc 0.976
Round 289, Average loss 0.115, Acc 0.982
Round 290, Average loss 0.169, Acc 0.974
Round 291, Average loss 0.251, Acc 0.981
Round 292, Average loss 0.134, Acc 0.976
Round 293, Average loss 0.171, Acc 0.982
Round 294, Average loss 0.220, Acc 0.975
Round 295, Average loss 0.268, Acc 0.981
Round 296, Average loss 0.131, Acc 0.975
Round 297, Average loss 0.199, Acc 0.981
Round 298, Average loss 0.162, Acc 0.980
0.0030883669814197362
Round 299, Average loss 0.150, Acc 0.982
164.62993669509888 s
Memory used: 1658.66 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=20, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.92009765] and score 2 is 0.0
Round   0, Average loss 3.172, Acc 0.000
score 1 is [0.9181144] and score 2 is 0.0
Round   1, Average loss 3.173, Acc 0.000
score 1 is [0.9547854] and score 2 is 0.0
Round   2, Average loss 3.173, Acc 0.000
score 1 is [0.9482586] and score 2 is 0.0
Round   3, Average loss 3.173, Acc 0.000
score 1 is [0.91794306] and score 2 is 0.0
Round   4, Average loss 3.173, Acc 0.000
11.602689027786255 s
Memory used: 1685.75 MB

8e-2 + 30
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=30, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.182, Acc 0.569
Round   1, Average loss 2.689, Acc 0.569
Round   2, Average loss 1.582, Acc 0.569
Round   3, Average loss 1.095, Acc 0.743
Round   4, Average loss 0.859, Acc 0.788
Round   5, Average loss 0.609, Acc 0.745
Round   6, Average loss 0.476, Acc 0.934
Round   7, Average loss 0.537, Acc 0.938
Round   8, Average loss 0.292, Acc 0.895
Round   9, Average loss 0.434, Acc 0.759
Round  10, Average loss 0.848, Acc 0.900
Round  11, Average loss 0.456, Acc 0.967
Round  12, Average loss 0.333, Acc 0.787
Round  13, Average loss 0.701, Acc 0.965
Round  14, Average loss 0.293, Acc 0.945
Round  15, Average loss 0.276, Acc 0.410
Round  16, Average loss 1.345, Acc 0.935
Round  17, Average loss 0.302, Acc 0.401
Round  18, Average loss 0.843, Acc 0.937
0.0135
Round  19, Average loss 0.432, Acc 0.969
Round  20, Average loss 0.460, Acc 0.937
Round  21, Average loss 0.376, Acc 0.968
Round  22, Average loss 0.260, Acc 0.940
Round  23, Average loss 0.359, Acc 0.969
Round  24, Average loss 0.199, Acc 0.981
Round  25, Average loss 0.317, Acc 0.929
Round  26, Average loss 0.373, Acc 0.952
Round  27, Average loss 0.367, Acc 0.932
Round  28, Average loss 0.334, Acc 0.930
Round  29, Average loss 0.323, Acc 0.977
Round  30, Average loss 0.216, Acc 0.965
Round  31, Average loss 0.356, Acc 0.930
Round  32, Average loss 0.341, Acc 0.751
Round  33, Average loss 0.429, Acc 0.968
Round  34, Average loss 0.196, Acc 0.413
Round  35, Average loss 1.542, Acc 0.954
Round  36, Average loss 0.293, Acc 0.960
Round  37, Average loss 0.465, Acc 0.918
Round  38, Average loss 0.749, Acc 0.940
0.01215
Round  39, Average loss 0.335, Acc 0.822
Round  40, Average loss 0.413, Acc 0.969
Round  41, Average loss 0.224, Acc 0.965
Round  42, Average loss 0.194, Acc 0.915
Round  43, Average loss 0.385, Acc 0.966
Round  44, Average loss 0.230, Acc 0.937
Round  45, Average loss 0.251, Acc 0.964
Round  46, Average loss 0.335, Acc 0.977
Round  47, Average loss 0.210, Acc 0.970
Round  48, Average loss 0.187, Acc 0.978
Round  49, Average loss 0.271, Acc 0.964
Round  50, Average loss 0.184, Acc 0.947
Round  51, Average loss 0.201, Acc 0.967
Round  52, Average loss 0.168, Acc 0.977
Round  53, Average loss 0.149, Acc 0.952
Round  54, Average loss 0.567, Acc 0.953
Round  55, Average loss 0.300, Acc 0.972
Round  56, Average loss 0.337, Acc 0.937
Round  57, Average loss 0.274, Acc 0.976
Round  58, Average loss 0.221, Acc 0.957
0.010935
Round  59, Average loss 0.241, Acc 0.976
Round  60, Average loss 0.225, Acc 0.963
Round  61, Average loss 0.236, Acc 0.976
Round  62, Average loss 0.399, Acc 0.965
Round  63, Average loss 0.173, Acc 0.957
Round  64, Average loss 0.336, Acc 0.964
Round  65, Average loss 0.289, Acc 0.977
Round  66, Average loss 0.453, Acc 0.977
Round  67, Average loss 0.180, Acc 0.981
Round  68, Average loss 0.282, Acc 0.977
Round  69, Average loss 0.211, Acc 0.979
Round  70, Average loss 0.213, Acc 0.978
Round  71, Average loss 0.132, Acc 0.979
Round  72, Average loss 0.168, Acc 0.969
Round  73, Average loss 0.446, Acc 0.979
Round  74, Average loss 0.238, Acc 0.979
Round  75, Average loss 0.144, Acc 0.967
Round  76, Average loss 0.204, Acc 0.966
Round  77, Average loss 0.276, Acc 0.979
Round  78, Average loss 0.212, Acc 0.977
0.009841500000000001
Round  79, Average loss 0.306, Acc 0.978
Round  80, Average loss 0.215, Acc 0.979
Round  81, Average loss 0.125, Acc 0.979
Round  82, Average loss 0.177, Acc 0.978
Round  83, Average loss 0.110, Acc 0.979
Round  84, Average loss 0.197, Acc 0.979
Round  85, Average loss 0.143, Acc 0.980
Round  86, Average loss 0.113, Acc 0.980
Round  87, Average loss 0.160, Acc 0.980
Round  88, Average loss 0.148, Acc 0.979
Round  89, Average loss 0.258, Acc 0.974
Round  90, Average loss 0.151, Acc 0.944
Round  91, Average loss 0.294, Acc 0.977
Round  92, Average loss 0.218, Acc 0.982
Round  93, Average loss 0.216, Acc 0.978
Round  94, Average loss 0.150, Acc 0.964
Round  95, Average loss 0.269, Acc 0.978
Round  96, Average loss 0.188, Acc 0.978
Round  97, Average loss 0.104, Acc 0.978
Round  98, Average loss 0.285, Acc 0.977
0.008857350000000002
Round  99, Average loss 0.158, Acc 0.979
Round 100, Average loss 0.169, Acc 0.977
Round 101, Average loss 0.289, Acc 0.963
Round 102, Average loss 0.212, Acc 0.979
Round 103, Average loss 0.151, Acc 0.979
Round 104, Average loss 0.157, Acc 0.981
Round 105, Average loss 0.142, Acc 0.974
Round 106, Average loss 0.268, Acc 0.982
Round 107, Average loss 0.170, Acc 0.979
Round 108, Average loss 0.216, Acc 0.811
Round 109, Average loss 0.350, Acc 0.979
Round 110, Average loss 0.281, Acc 0.981
Round 111, Average loss 0.354, Acc 0.968
Round 112, Average loss 0.312, Acc 0.981
Round 113, Average loss 0.248, Acc 0.979
Round 114, Average loss 0.166, Acc 0.979
Round 115, Average loss 0.159, Acc 0.981
Round 116, Average loss 0.195, Acc 0.979
Round 117, Average loss 0.180, Acc 0.977
Round 118, Average loss 0.170, Acc 0.977
0.007971615000000001
Round 119, Average loss 0.318, Acc 0.967
Round 120, Average loss 0.278, Acc 0.943
Round 121, Average loss 0.311, Acc 0.977
Round 122, Average loss 0.214, Acc 0.965
Round 123, Average loss 0.194, Acc 0.979
Round 124, Average loss 0.154, Acc 0.981
Round 125, Average loss 0.199, Acc 0.979
Round 126, Average loss 0.223, Acc 0.981
Round 127, Average loss 0.209, Acc 0.981
Round 128, Average loss 0.184, Acc 0.977
Round 129, Average loss 0.223, Acc 0.981
Round 130, Average loss 0.200, Acc 0.981
Round 131, Average loss 0.186, Acc 0.981
Round 132, Average loss 0.208, Acc 0.980
Round 133, Average loss 0.160, Acc 0.981
Round 134, Average loss 0.153, Acc 0.978
Round 135, Average loss 0.177, Acc 0.979
Round 136, Average loss 0.144, Acc 0.980
Round 137, Average loss 0.167, Acc 0.981
Round 138, Average loss 0.247, Acc 0.939
0.007174453500000001
Round 139, Average loss 0.274, Acc 0.981
Round 140, Average loss 0.120, Acc 0.977
Round 141, Average loss 0.165, Acc 0.980
Round 142, Average loss 0.133, Acc 0.981
Round 143, Average loss 0.141, Acc 0.981
Round 144, Average loss 0.226, Acc 0.980
Round 145, Average loss 0.147, Acc 0.981
Round 146, Average loss 0.254, Acc 0.981
Round 147, Average loss 0.190, Acc 0.980
Round 148, Average loss 0.161, Acc 0.980
Round 149, Average loss 0.164, Acc 0.981
Round 150, Average loss 0.174, Acc 0.979
Round 151, Average loss 0.155, Acc 0.981
Round 152, Average loss 0.144, Acc 0.981
Round 153, Average loss 0.215, Acc 0.981
Round 154, Average loss 0.130, Acc 0.981
Round 155, Average loss 0.224, Acc 0.981
Round 156, Average loss 0.203, Acc 0.981
Round 157, Average loss 0.131, Acc 0.981
Round 158, Average loss 0.127, Acc 0.980
0.006457008150000001
Round 159, Average loss 0.233, Acc 0.980
Round 160, Average loss 0.205, Acc 0.980
Round 161, Average loss 0.166, Acc 0.980
Round 162, Average loss 0.198, Acc 0.976
Round 163, Average loss 0.234, Acc 0.981
Round 164, Average loss 0.121, Acc 0.981
Round 165, Average loss 0.147, Acc 0.981
Round 166, Average loss 0.207, Acc 0.980
Round 167, Average loss 0.104, Acc 0.981
Round 168, Average loss 0.144, Acc 0.980
Round 169, Average loss 0.192, Acc 0.978
Round 170, Average loss 0.126, Acc 0.981
Round 171, Average loss 0.100, Acc 0.981
Round 172, Average loss 0.165, Acc 0.981
Round 173, Average loss 0.139, Acc 0.981
Round 174, Average loss 0.206, Acc 0.981
Round 175, Average loss 0.171, Acc 0.978
Round 176, Average loss 0.210, Acc 0.980
Round 177, Average loss 0.194, Acc 0.979
Round 178, Average loss 0.248, Acc 0.981
0.005811307335000002
Round 179, Average loss 0.243, Acc 0.980
Round 180, Average loss 0.150, Acc 0.979
Round 181, Average loss 0.168, Acc 0.980
Round 182, Average loss 0.137, Acc 0.981
Round 183, Average loss 0.185, Acc 0.980
Round 184, Average loss 0.210, Acc 0.981
Round 185, Average loss 0.146, Acc 0.979
Round 186, Average loss 0.232, Acc 0.978
Round 187, Average loss 0.142, Acc 0.980
Round 188, Average loss 0.147, Acc 0.978
Round 189, Average loss 0.118, Acc 0.980
Round 190, Average loss 0.169, Acc 0.980
Round 191, Average loss 0.123, Acc 0.981
Round 192, Average loss 0.183, Acc 0.981
Round 193, Average loss 0.253, Acc 0.978
Round 194, Average loss 0.177, Acc 0.980
Round 195, Average loss 0.175, Acc 0.979
Round 196, Average loss 0.140, Acc 0.977
Round 197, Average loss 0.215, Acc 0.954
Round 198, Average loss 0.278, Acc 0.979
0.005230176601500001
Round 199, Average loss 0.181, Acc 0.979
Round 200, Average loss 0.105, Acc 0.979
Round 201, Average loss 0.193, Acc 0.977
Round 202, Average loss 0.188, Acc 0.980
Round 203, Average loss 0.154, Acc 0.980
Round 204, Average loss 0.209, Acc 0.953
Round 205, Average loss 0.265, Acc 0.980
Round 206, Average loss 0.112, Acc 0.981
Round 207, Average loss 0.204, Acc 0.980
Round 208, Average loss 0.112, Acc 0.981
Round 209, Average loss 0.074, Acc 0.980
Round 210, Average loss 0.213, Acc 0.979
Round 211, Average loss 0.202, Acc 0.977
Round 212, Average loss 0.141, Acc 0.979
Round 213, Average loss 0.203, Acc 0.976
Round 214, Average loss 0.187, Acc 0.979
Round 215, Average loss 0.245, Acc 0.978
Round 216, Average loss 0.165, Acc 0.980
Round 217, Average loss 0.183, Acc 0.980
Round 218, Average loss 0.197, Acc 0.979
0.004707158941350001
Round 219, Average loss 0.146, Acc 0.979
Round 220, Average loss 0.224, Acc 0.979
Round 221, Average loss 0.192, Acc 0.980
Round 222, Average loss 0.197, Acc 0.980
Round 223, Average loss 0.128, Acc 0.976
Round 224, Average loss 0.138, Acc 0.980
Round 225, Average loss 0.156, Acc 0.976
Round 226, Average loss 0.130, Acc 0.978
Round 227, Average loss 0.165, Acc 0.979
Round 228, Average loss 0.141, Acc 0.979
Round 229, Average loss 0.207, Acc 0.973
Round 230, Average loss 0.130, Acc 0.979
Round 231, Average loss 0.178, Acc 0.979
Round 232, Average loss 0.160, Acc 0.977
Round 233, Average loss 0.192, Acc 0.979
Round 234, Average loss 0.208, Acc 0.971
Round 235, Average loss 0.112, Acc 0.977
Round 236, Average loss 0.076, Acc 0.979
Round 237, Average loss 0.264, Acc 0.979
Round 238, Average loss 0.145, Acc 0.972
0.004236443047215001
Round 239, Average loss 0.162, Acc 0.975
Round 240, Average loss 0.162, Acc 0.972
Round 241, Average loss 0.243, Acc 0.951
Round 242, Average loss 0.201, Acc 0.979
Round 243, Average loss 0.150, Acc 0.980
Round 244, Average loss 0.107, Acc 0.980
Round 245, Average loss 0.135, Acc 0.977
Round 246, Average loss 0.163, Acc 0.980
Round 247, Average loss 0.146, Acc 0.980
Round 248, Average loss 0.200, Acc 0.980
Round 249, Average loss 0.175, Acc 0.980
Round 250, Average loss 0.175, Acc 0.980
Round 251, Average loss 0.193, Acc 0.981
Round 252, Average loss 0.137, Acc 0.981
Round 253, Average loss 0.220, Acc 0.979
Round 254, Average loss 0.188, Acc 0.980
Round 255, Average loss 0.258, Acc 0.980
Round 256, Average loss 0.162, Acc 0.980
Round 257, Average loss 0.214, Acc 0.980
Round 258, Average loss 0.241, Acc 0.980
0.003812798742493501
Round 259, Average loss 0.147, Acc 0.979
Round 260, Average loss 0.144, Acc 0.979
Round 261, Average loss 0.153, Acc 0.980
Round 262, Average loss 0.142, Acc 0.980
Round 263, Average loss 0.181, Acc 0.980
Round 264, Average loss 0.176, Acc 0.979
Round 265, Average loss 0.164, Acc 0.977
Round 266, Average loss 0.285, Acc 0.968
Round 267, Average loss 0.225, Acc 0.979
Round 268, Average loss 0.165, Acc 0.978
Round 269, Average loss 0.231, Acc 0.980
Round 270, Average loss 0.159, Acc 0.980
Round 271, Average loss 0.146, Acc 0.980
Round 272, Average loss 0.242, Acc 0.980
Round 273, Average loss 0.224, Acc 0.980
Round 274, Average loss 0.174, Acc 0.980
Round 275, Average loss 0.204, Acc 0.980
Round 276, Average loss 0.234, Acc 0.980
Round 277, Average loss 0.193, Acc 0.979
Round 278, Average loss 0.162, Acc 0.980
0.003431518868244151
Round 279, Average loss 0.151, Acc 0.980
Round 280, Average loss 0.210, Acc 0.980
Round 281, Average loss 0.296, Acc 0.980
Round 282, Average loss 0.238, Acc 0.980
Round 283, Average loss 0.157, Acc 0.980
Round 284, Average loss 0.163, Acc 0.980
Round 285, Average loss 0.137, Acc 0.980
Round 286, Average loss 0.105, Acc 0.981
Round 287, Average loss 0.144, Acc 0.980
Round 288, Average loss 0.243, Acc 0.979
Round 289, Average loss 0.082, Acc 0.980
Round 290, Average loss 0.195, Acc 0.979
Round 291, Average loss 0.227, Acc 0.980
Round 292, Average loss 0.278, Acc 0.980
Round 293, Average loss 0.166, Acc 0.978
Round 294, Average loss 0.224, Acc 0.979
Round 295, Average loss 0.208, Acc 0.980
Round 296, Average loss 0.226, Acc 0.981
Round 297, Average loss 0.219, Acc 0.980
Round 298, Average loss 0.181, Acc 0.980
0.0030883669814197362
Round 299, Average loss 0.193, Acc 0.980
181.0518035888672 s
Memory used: 1653.77 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=30, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.86548626] and score 2 is 0.0
Round   0, Average loss 3.098, Acc 0.000
score 1 is [0.89341027] and score 2 is 0.0
Round   1, Average loss 3.151, Acc 0.000
score 1 is [0.8846363] and score 2 is 0.0
Round   2, Average loss 3.096, Acc 0.000
score 1 is [0.9451758] and score 2 is 0.0
Round   3, Average loss 3.170, Acc 0.000
score 1 is [0.76994544] and score 2 is 0.0
Round   4, Average loss 3.172, Acc 0.000
11.691519498825073 s
Memory used: 1647.06 MB

8e-2 + 40
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=40, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.164, Acc 0.722
Round   1, Average loss 2.721, Acc 0.569
Round   2, Average loss 1.769, Acc 0.569
Round   3, Average loss 1.203, Acc 0.569
Round   4, Average loss 0.891, Acc 0.650
Round   5, Average loss 0.742, Acc 0.771
Round   6, Average loss 0.606, Acc 0.946
Round   7, Average loss 0.400, Acc 0.699
Round   8, Average loss 0.751, Acc 0.971
Round   9, Average loss 0.387, Acc 0.793
Round  10, Average loss 0.411, Acc 0.967
Round  11, Average loss 0.163, Acc 0.914
Round  12, Average loss 0.315, Acc 0.981
Round  13, Average loss 0.322, Acc 0.932
Round  14, Average loss 0.225, Acc 0.981
Round  15, Average loss 0.368, Acc 0.937
Round  16, Average loss 0.186, Acc 0.965
Round  17, Average loss 0.197, Acc 0.978
Round  18, Average loss 0.224, Acc 0.962
0.0135
Round  19, Average loss 0.239, Acc 0.945
Round  20, Average loss 0.154, Acc 0.978
Round  21, Average loss 0.154, Acc 0.980
Round  22, Average loss 0.167, Acc 0.961
Round  23, Average loss 0.157, Acc 0.943
Round  24, Average loss 0.247, Acc 0.980
Round  25, Average loss 0.101, Acc 0.980
Round  26, Average loss 0.193, Acc 0.968
Round  27, Average loss 0.139, Acc 0.957
Round  28, Average loss 0.244, Acc 0.978
Round  29, Average loss 0.113, Acc 0.978
Round  30, Average loss 0.137, Acc 0.979
Round  31, Average loss 0.205, Acc 0.972
Round  32, Average loss 0.178, Acc 0.955
Round  33, Average loss 0.238, Acc 0.981
Round  34, Average loss 0.177, Acc 0.964
Round  35, Average loss 0.176, Acc 0.981
Round  36, Average loss 0.142, Acc 0.943
Round  37, Average loss 0.189, Acc 0.981
Round  38, Average loss 0.128, Acc 0.958
0.01215
Round  39, Average loss 0.253, Acc 0.981
Round  40, Average loss 0.126, Acc 0.976
Round  41, Average loss 0.197, Acc 0.981
Round  42, Average loss 0.123, Acc 0.964
Round  43, Average loss 0.187, Acc 0.981
Round  44, Average loss 0.131, Acc 0.978
Round  45, Average loss 0.168, Acc 0.981
Round  46, Average loss 0.161, Acc 0.972
Round  47, Average loss 0.126, Acc 0.979
Round  48, Average loss 0.124, Acc 0.977
Round  49, Average loss 0.159, Acc 0.981
Round  50, Average loss 0.165, Acc 0.976
Round  51, Average loss 0.167, Acc 0.981
Round  52, Average loss 0.093, Acc 0.981
Round  53, Average loss 0.106, Acc 0.981
Round  54, Average loss 0.140, Acc 0.981
Round  55, Average loss 0.279, Acc 0.975
Round  56, Average loss 0.138, Acc 0.981
Round  57, Average loss 0.150, Acc 0.977
Round  58, Average loss 0.134, Acc 0.949
0.010935
Round  59, Average loss 0.203, Acc 0.975
Round  60, Average loss 0.134, Acc 0.968
Round  61, Average loss 0.151, Acc 0.981
Round  62, Average loss 0.084, Acc 0.980
Round  63, Average loss 0.154, Acc 0.974
Round  64, Average loss 0.135, Acc 0.979
Round  65, Average loss 0.102, Acc 0.981
Round  66, Average loss 0.118, Acc 0.977
Round  67, Average loss 0.120, Acc 0.979
Round  68, Average loss 0.116, Acc 0.978
Round  69, Average loss 0.082, Acc 0.979
Round  70, Average loss 0.132, Acc 0.979
Round  71, Average loss 0.123, Acc 0.981
Round  72, Average loss 0.109, Acc 0.981
Round  73, Average loss 0.144, Acc 0.980
Round  74, Average loss 0.144, Acc 0.966
Round  75, Average loss 0.144, Acc 0.983
Round  76, Average loss 0.130, Acc 0.981
Round  77, Average loss 0.119, Acc 0.977
Round  78, Average loss 0.105, Acc 0.980
0.009841500000000001
Round  79, Average loss 0.112, Acc 0.980
Round  80, Average loss 0.115, Acc 0.980
Round  81, Average loss 0.096, Acc 0.976
Round  82, Average loss 0.113, Acc 0.982
Round  83, Average loss 0.124, Acc 0.979
Round  84, Average loss 0.090, Acc 0.980
Round  85, Average loss 0.074, Acc 0.982
Round  86, Average loss 0.146, Acc 0.978
Round  87, Average loss 0.164, Acc 0.954
Round  88, Average loss 0.154, Acc 0.979
Round  89, Average loss 0.115, Acc 0.981
Round  90, Average loss 0.067, Acc 0.981
Round  91, Average loss 0.087, Acc 0.981
Round  92, Average loss 0.128, Acc 0.966
Round  93, Average loss 0.121, Acc 0.970
Round  94, Average loss 0.116, Acc 0.980
Round  95, Average loss 0.094, Acc 0.981
Round  96, Average loss 0.073, Acc 0.958
Round  97, Average loss 0.152, Acc 0.981
Round  98, Average loss 0.096, Acc 0.973
0.008857350000000002
Round  99, Average loss 0.128, Acc 0.979
Round 100, Average loss 0.150, Acc 0.978
Round 101, Average loss 0.111, Acc 0.973
Round 102, Average loss 0.093, Acc 0.976
Round 103, Average loss 0.076, Acc 0.981
Round 104, Average loss 0.081, Acc 0.981
Round 105, Average loss 0.061, Acc 0.981
Round 106, Average loss 0.143, Acc 0.978
Round 107, Average loss 0.120, Acc 0.977
Round 108, Average loss 0.049, Acc 0.981
Round 109, Average loss 0.096, Acc 0.978
Round 110, Average loss 0.119, Acc 0.980
Round 111, Average loss 0.069, Acc 0.980
Round 112, Average loss 0.115, Acc 0.979
Round 113, Average loss 0.115, Acc 0.979
Round 114, Average loss 0.122, Acc 0.981
Round 115, Average loss 0.104, Acc 0.982
Round 116, Average loss 0.099, Acc 0.982
Round 117, Average loss 0.107, Acc 0.981
Round 118, Average loss 0.090, Acc 0.978
0.007971615000000001
Round 119, Average loss 0.104, Acc 0.981
Round 120, Average loss 0.085, Acc 0.981
Round 121, Average loss 0.100, Acc 0.982
Round 122, Average loss 0.096, Acc 0.982
Round 123, Average loss 0.082, Acc 0.982
Round 124, Average loss 0.068, Acc 0.981
Round 125, Average loss 0.101, Acc 0.981
Round 126, Average loss 0.036, Acc 0.982
Round 127, Average loss 0.096, Acc 0.982
Round 128, Average loss 0.082, Acc 0.979
Round 129, Average loss 0.165, Acc 0.982
Round 130, Average loss 0.056, Acc 0.974
Round 131, Average loss 0.123, Acc 0.983
Round 132, Average loss 0.060, Acc 0.981
Round 133, Average loss 0.130, Acc 0.982
Round 134, Average loss 0.110, Acc 0.983
Round 135, Average loss 0.123, Acc 0.983
Round 136, Average loss 0.065, Acc 0.982
Round 137, Average loss 0.085, Acc 0.974
Round 138, Average loss 0.151, Acc 0.983
0.007174453500000001
Round 139, Average loss 0.112, Acc 0.982
Round 140, Average loss 0.078, Acc 0.983
Round 141, Average loss 0.062, Acc 0.983
Round 142, Average loss 0.098, Acc 0.982
Round 143, Average loss 0.135, Acc 0.984
Round 144, Average loss 0.097, Acc 0.981
Round 145, Average loss 0.067, Acc 0.983
Round 146, Average loss 0.095, Acc 0.982
Round 147, Average loss 0.075, Acc 0.983
Round 148, Average loss 0.072, Acc 0.980
Round 149, Average loss 0.097, Acc 0.981
Round 150, Average loss 0.061, Acc 0.980
Round 151, Average loss 0.089, Acc 0.982
Round 152, Average loss 0.110, Acc 0.983
Round 153, Average loss 0.062, Acc 0.984
Round 154, Average loss 0.093, Acc 0.982
Round 155, Average loss 0.123, Acc 0.981
Round 156, Average loss 0.096, Acc 0.984
Round 157, Average loss 0.040, Acc 0.971
Round 158, Average loss 0.111, Acc 0.983
0.006457008150000001
Round 159, Average loss 0.120, Acc 0.982
Round 160, Average loss 0.129, Acc 0.983
Round 161, Average loss 0.055, Acc 0.983
Round 162, Average loss 0.064, Acc 0.976
Round 163, Average loss 0.096, Acc 0.984
Round 164, Average loss 0.071, Acc 0.985
Round 165, Average loss 0.084, Acc 0.985
Round 166, Average loss 0.094, Acc 0.984
Round 167, Average loss 0.105, Acc 0.983
Round 168, Average loss 0.112, Acc 0.982
Round 169, Average loss 0.074, Acc 0.983
Round 170, Average loss 0.117, Acc 0.984
Round 171, Average loss 0.060, Acc 0.983
Round 172, Average loss 0.085, Acc 0.982
Round 173, Average loss 0.067, Acc 0.983
Round 174, Average loss 0.111, Acc 0.982
Round 175, Average loss 0.101, Acc 0.983
Round 176, Average loss 0.087, Acc 0.983
Round 177, Average loss 0.090, Acc 0.983
Round 178, Average loss 0.160, Acc 0.983
0.005811307335000002
Round 179, Average loss 0.101, Acc 0.984
Round 180, Average loss 0.059, Acc 0.981
Round 181, Average loss 0.099, Acc 0.984
Round 182, Average loss 0.088, Acc 0.984
Round 183, Average loss 0.060, Acc 0.984
Round 184, Average loss 0.137, Acc 0.984
Round 185, Average loss 0.081, Acc 0.984
Round 186, Average loss 0.089, Acc 0.984
Round 187, Average loss 0.103, Acc 0.984
Round 188, Average loss 0.090, Acc 0.984
Round 189, Average loss 0.083, Acc 0.984
Round 190, Average loss 0.096, Acc 0.981
Round 191, Average loss 0.093, Acc 0.983
Round 192, Average loss 0.097, Acc 0.981
Round 193, Average loss 0.132, Acc 0.985
Round 194, Average loss 0.077, Acc 0.985
Round 195, Average loss 0.118, Acc 0.984
Round 196, Average loss 0.091, Acc 0.985
Round 197, Average loss 0.074, Acc 0.985
Round 198, Average loss 0.068, Acc 0.983
0.005230176601500001
Round 199, Average loss 0.061, Acc 0.983
Round 200, Average loss 0.075, Acc 0.984
Round 201, Average loss 0.121, Acc 0.983
Round 202, Average loss 0.089, Acc 0.984
Round 203, Average loss 0.085, Acc 0.984
Round 204, Average loss 0.064, Acc 0.984
Round 205, Average loss 0.132, Acc 0.983
Round 206, Average loss 0.062, Acc 0.984
Round 207, Average loss 0.097, Acc 0.984
Round 208, Average loss 0.083, Acc 0.984
Round 209, Average loss 0.088, Acc 0.984
Round 210, Average loss 0.101, Acc 0.983
Round 211, Average loss 0.082, Acc 0.982
Round 212, Average loss 0.072, Acc 0.981
Round 213, Average loss 0.064, Acc 0.981
Round 214, Average loss 0.109, Acc 0.982
Round 215, Average loss 0.060, Acc 0.981
Round 216, Average loss 0.079, Acc 0.983
Round 217, Average loss 0.088, Acc 0.984
Round 218, Average loss 0.092, Acc 0.983
0.004707158941350001
Round 219, Average loss 0.107, Acc 0.984
Round 220, Average loss 0.079, Acc 0.985
Round 221, Average loss 0.090, Acc 0.983
Round 222, Average loss 0.084, Acc 0.984
Round 223, Average loss 0.098, Acc 0.984
Round 224, Average loss 0.089, Acc 0.983
Round 225, Average loss 0.071, Acc 0.982
Round 226, Average loss 0.069, Acc 0.981
Round 227, Average loss 0.087, Acc 0.981
Round 228, Average loss 0.092, Acc 0.982
Round 229, Average loss 0.063, Acc 0.982
Round 230, Average loss 0.111, Acc 0.982
Round 231, Average loss 0.090, Acc 0.982
Round 232, Average loss 0.085, Acc 0.982
Round 233, Average loss 0.082, Acc 0.981
Round 234, Average loss 0.052, Acc 0.981
Round 235, Average loss 0.104, Acc 0.982
Round 236, Average loss 0.095, Acc 0.983
Round 237, Average loss 0.092, Acc 0.983
Round 238, Average loss 0.061, Acc 0.984
0.004236443047215001
Round 239, Average loss 0.085, Acc 0.983
Round 240, Average loss 0.107, Acc 0.982
Round 241, Average loss 0.092, Acc 0.982
Round 242, Average loss 0.098, Acc 0.984
Round 243, Average loss 0.081, Acc 0.983
Round 244, Average loss 0.075, Acc 0.982
Round 245, Average loss 0.103, Acc 0.981
Round 246, Average loss 0.092, Acc 0.983
Round 247, Average loss 0.085, Acc 0.983
Round 248, Average loss 0.093, Acc 0.983
Round 249, Average loss 0.085, Acc 0.981
Round 250, Average loss 0.125, Acc 0.983
Round 251, Average loss 0.076, Acc 0.982
Round 252, Average loss 0.111, Acc 0.983
Round 253, Average loss 0.089, Acc 0.983
Round 254, Average loss 0.092, Acc 0.983
Round 255, Average loss 0.099, Acc 0.984
Round 256, Average loss 0.148, Acc 0.984
Round 257, Average loss 0.068, Acc 0.984
Round 258, Average loss 0.094, Acc 0.985
0.003812798742493501
Round 259, Average loss 0.102, Acc 0.984
Round 260, Average loss 0.069, Acc 0.984
Round 261, Average loss 0.064, Acc 0.984
Round 262, Average loss 0.072, Acc 0.984
Round 263, Average loss 0.086, Acc 0.984
Round 264, Average loss 0.110, Acc 0.985
Round 265, Average loss 0.085, Acc 0.986
Round 266, Average loss 0.074, Acc 0.985
Round 267, Average loss 0.089, Acc 0.985
Round 268, Average loss 0.073, Acc 0.985
Round 269, Average loss 0.071, Acc 0.986
Round 270, Average loss 0.121, Acc 0.986
Round 271, Average loss 0.065, Acc 0.984
Round 272, Average loss 0.092, Acc 0.985
Round 273, Average loss 0.070, Acc 0.984
Round 274, Average loss 0.046, Acc 0.985
Round 275, Average loss 0.090, Acc 0.985
Round 276, Average loss 0.085, Acc 0.985
Round 277, Average loss 0.080, Acc 0.985
Round 278, Average loss 0.105, Acc 0.984
0.003431518868244151
Round 279, Average loss 0.059, Acc 0.984
Round 280, Average loss 0.073, Acc 0.984
Round 281, Average loss 0.083, Acc 0.985
Round 282, Average loss 0.058, Acc 0.985
Round 283, Average loss 0.085, Acc 0.985
Round 284, Average loss 0.084, Acc 0.986
Round 285, Average loss 0.089, Acc 0.986
Round 286, Average loss 0.087, Acc 0.985
Round 287, Average loss 0.096, Acc 0.986
Round 288, Average loss 0.087, Acc 0.985
Round 289, Average loss 0.072, Acc 0.985
Round 290, Average loss 0.079, Acc 0.985
Round 291, Average loss 0.074, Acc 0.985
Round 292, Average loss 0.037, Acc 0.985
Round 293, Average loss 0.091, Acc 0.985
Round 294, Average loss 0.103, Acc 0.985
Round 295, Average loss 0.080, Acc 0.986
Round 296, Average loss 0.085, Acc 0.986
Round 297, Average loss 0.056, Acc 0.985
Round 298, Average loss 0.069, Acc 0.985
0.0030883669814197362
Round 299, Average loss 0.100, Acc 0.985
204.30977511405945 s
Memory used: 1664.70 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=40, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.8077315] and score 2 is 0.0
Round   0, Average loss 3.153, Acc 0.000
score 1 is [0.75127876] and score 2 is 0.0
Round   1, Average loss 3.153, Acc 0.000
score 1 is [0.88983375] and score 2 is 0.0
Round   2, Average loss 3.153, Acc 0.000
score 1 is [0.76155615] and score 2 is 0.0
Round   3, Average loss 3.190, Acc 0.000
score 1 is [0.840671] and score 2 is 0.0
Round   4, Average loss 3.153, Acc 0.000
11.362972021102905 s
Memory used: 1667.30 MB

8e-2 + 50
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=50, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.148, Acc 0.751
Round   1, Average loss 2.612, Acc 0.569
Round   2, Average loss 1.388, Acc 0.569
Round   3, Average loss 1.015, Acc 0.569
Round   4, Average loss 0.893, Acc 0.569
Round   5, Average loss 1.026, Acc 0.781
Round   6, Average loss 0.802, Acc 0.786
Round   7, Average loss 0.646, Acc 0.977
Round   8, Average loss 0.591, Acc 0.786
Round   9, Average loss 0.485, Acc 0.969
Round  10, Average loss 0.449, Acc 0.786
Round  11, Average loss 0.606, Acc 0.962
Round  12, Average loss 0.365, Acc 0.936
Round  13, Average loss 0.305, Acc 0.978
Round  14, Average loss 0.251, Acc 0.939
Round  15, Average loss 0.235, Acc 0.969
Round  16, Average loss 0.197, Acc 0.943
Round  17, Average loss 0.187, Acc 0.980
Round  18, Average loss 0.283, Acc 0.942
0.0135
Round  19, Average loss 0.192, Acc 0.978
Round  20, Average loss 0.190, Acc 0.978
Round  21, Average loss 0.404, Acc 0.964
Round  22, Average loss 0.164, Acc 0.937
Round  23, Average loss 0.196, Acc 0.980
Round  24, Average loss 0.238, Acc 0.964
Round  25, Average loss 0.155, Acc 0.960
Round  26, Average loss 0.184, Acc 0.964
Round  27, Average loss 0.243, Acc 0.979
Round  28, Average loss 0.294, Acc 0.961
Round  29, Average loss 0.155, Acc 0.952
Round  30, Average loss 0.232, Acc 0.955
Round  31, Average loss 0.241, Acc 0.979
Round  32, Average loss 0.184, Acc 0.965
Round  33, Average loss 0.161, Acc 0.979
Round  34, Average loss 0.212, Acc 0.964
Round  35, Average loss 0.224, Acc 0.981
Round  36, Average loss 0.198, Acc 0.966
Round  37, Average loss 0.156, Acc 0.978
Round  38, Average loss 0.139, Acc 0.978
0.01215
Round  39, Average loss 0.138, Acc 0.977
Round  40, Average loss 0.141, Acc 0.977
Round  41, Average loss 0.168, Acc 0.981
Round  42, Average loss 0.243, Acc 0.974
Round  43, Average loss 0.088, Acc 0.981
Round  44, Average loss 0.188, Acc 0.973
Round  45, Average loss 0.127, Acc 0.981
Round  46, Average loss 0.151, Acc 0.976
Round  47, Average loss 0.143, Acc 0.979
Round  48, Average loss 0.077, Acc 0.979
Round  49, Average loss 0.095, Acc 0.977
Round  50, Average loss 0.121, Acc 0.981
Round  51, Average loss 0.147, Acc 0.980
Round  52, Average loss 0.190, Acc 0.978
Round  53, Average loss 0.091, Acc 0.975
Round  54, Average loss 0.197, Acc 0.981
Round  55, Average loss 0.114, Acc 0.976
Round  56, Average loss 0.118, Acc 0.979
Round  57, Average loss 0.070, Acc 0.979
Round  58, Average loss 0.181, Acc 0.975
0.010935
Round  59, Average loss 0.143, Acc 0.978
Round  60, Average loss 0.159, Acc 0.981
Round  61, Average loss 0.108, Acc 0.979
Round  62, Average loss 0.115, Acc 0.979
Round  63, Average loss 0.095, Acc 0.981
Round  64, Average loss 0.116, Acc 0.979
Round  65, Average loss 0.138, Acc 0.981
Round  66, Average loss 0.136, Acc 0.981
Round  67, Average loss 0.067, Acc 0.981
Round  68, Average loss 0.129, Acc 0.977
Round  69, Average loss 0.217, Acc 0.981
Round  70, Average loss 0.096, Acc 0.978
Round  71, Average loss 0.136, Acc 0.978
Round  72, Average loss 0.120, Acc 0.981
Round  73, Average loss 0.134, Acc 0.979
Round  74, Average loss 0.115, Acc 0.977
Round  75, Average loss 0.165, Acc 0.980
Round  76, Average loss 0.157, Acc 0.981
Round  77, Average loss 0.103, Acc 0.981
Round  78, Average loss 0.069, Acc 0.982
0.009841500000000001
Round  79, Average loss 0.132, Acc 0.980
Round  80, Average loss 0.086, Acc 0.976
Round  81, Average loss 0.170, Acc 0.981
Round  82, Average loss 0.111, Acc 0.978
Round  83, Average loss 0.142, Acc 0.981
Round  84, Average loss 0.090, Acc 0.982
Round  85, Average loss 0.101, Acc 0.981
Round  86, Average loss 0.081, Acc 0.980
Round  87, Average loss 0.107, Acc 0.983
Round  88, Average loss 0.073, Acc 0.981
Round  89, Average loss 0.073, Acc 0.981
Round  90, Average loss 0.065, Acc 0.981
Round  91, Average loss 0.073, Acc 0.983
Round  92, Average loss 0.109, Acc 0.981
Round  93, Average loss 0.107, Acc 0.984
Round  94, Average loss 0.148, Acc 0.982
Round  95, Average loss 0.090, Acc 0.984
Round  96, Average loss 0.112, Acc 0.982
Round  97, Average loss 0.064, Acc 0.980
Round  98, Average loss 0.103, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.080, Acc 0.983
Round 100, Average loss 0.091, Acc 0.984
Round 101, Average loss 0.094, Acc 0.983
Round 102, Average loss 0.092, Acc 0.982
Round 103, Average loss 0.059, Acc 0.982
Round 104, Average loss 0.108, Acc 0.985
Round 105, Average loss 0.078, Acc 0.984
Round 106, Average loss 0.083, Acc 0.984
Round 107, Average loss 0.080, Acc 0.982
Round 108, Average loss 0.053, Acc 0.982
Round 109, Average loss 0.079, Acc 0.984
Round 110, Average loss 0.052, Acc 0.984
Round 111, Average loss 0.073, Acc 0.983
Round 112, Average loss 0.043, Acc 0.984
Round 113, Average loss 0.137, Acc 0.985
Round 114, Average loss 0.065, Acc 0.983
Round 115, Average loss 0.101, Acc 0.987
Round 116, Average loss 0.080, Acc 0.984
Round 117, Average loss 0.080, Acc 0.985
Round 118, Average loss 0.089, Acc 0.983
0.007971615000000001
Round 119, Average loss 0.070, Acc 0.984
Round 120, Average loss 0.065, Acc 0.984
Round 121, Average loss 0.063, Acc 0.984
Round 122, Average loss 0.098, Acc 0.982
Round 123, Average loss 0.089, Acc 0.982
Round 124, Average loss 0.085, Acc 0.982
Round 125, Average loss 0.080, Acc 0.982
Round 126, Average loss 0.086, Acc 0.986
Round 127, Average loss 0.084, Acc 0.983
Round 128, Average loss 0.145, Acc 0.985
Round 129, Average loss 0.101, Acc 0.983
Round 130, Average loss 0.085, Acc 0.985
Round 131, Average loss 0.087, Acc 0.985
Round 132, Average loss 0.104, Acc 0.983
Round 133, Average loss 0.075, Acc 0.984
Round 134, Average loss 0.082, Acc 0.984
Round 135, Average loss 0.055, Acc 0.982
Round 136, Average loss 0.071, Acc 0.981
Round 137, Average loss 0.079, Acc 0.982
Round 138, Average loss 0.098, Acc 0.984
0.007174453500000001
Round 139, Average loss 0.070, Acc 0.984
Round 140, Average loss 0.075, Acc 0.985
Round 141, Average loss 0.069, Acc 0.984
Round 142, Average loss 0.078, Acc 0.984
Round 143, Average loss 0.083, Acc 0.981
Round 144, Average loss 0.096, Acc 0.983
Round 145, Average loss 0.111, Acc 0.982
Round 146, Average loss 0.058, Acc 0.985
Round 147, Average loss 0.077, Acc 0.982
Round 148, Average loss 0.097, Acc 0.984
Round 149, Average loss 0.097, Acc 0.985
Round 150, Average loss 0.099, Acc 0.982
Round 151, Average loss 0.105, Acc 0.982
Round 152, Average loss 0.078, Acc 0.983
Round 153, Average loss 0.049, Acc 0.986
Round 154, Average loss 0.085, Acc 0.986
Round 155, Average loss 0.121, Acc 0.983
Round 156, Average loss 0.079, Acc 0.986
Round 157, Average loss 0.070, Acc 0.982
Round 158, Average loss 0.071, Acc 0.984
0.006457008150000001
Round 159, Average loss 0.089, Acc 0.984
Round 160, Average loss 0.086, Acc 0.983
Round 161, Average loss 0.097, Acc 0.984
Round 162, Average loss 0.067, Acc 0.982
Round 163, Average loss 0.082, Acc 0.984
Round 164, Average loss 0.079, Acc 0.983
Round 165, Average loss 0.074, Acc 0.984
Round 166, Average loss 0.129, Acc 0.984
Round 167, Average loss 0.071, Acc 0.985
Round 168, Average loss 0.060, Acc 0.983
Round 169, Average loss 0.088, Acc 0.984
Round 170, Average loss 0.089, Acc 0.984
Round 171, Average loss 0.059, Acc 0.984
Round 172, Average loss 0.057, Acc 0.984
Round 173, Average loss 0.077, Acc 0.984
Round 174, Average loss 0.050, Acc 0.982
Round 175, Average loss 0.095, Acc 0.985
Round 176, Average loss 0.086, Acc 0.983
Round 177, Average loss 0.066, Acc 0.986
Round 178, Average loss 0.077, Acc 0.985
0.005811307335000002
Round 179, Average loss 0.058, Acc 0.985
Round 180, Average loss 0.062, Acc 0.987
Round 181, Average loss 0.051, Acc 0.982
Round 182, Average loss 0.064, Acc 0.983
Round 183, Average loss 0.077, Acc 0.982
Round 184, Average loss 0.104, Acc 0.983
Round 185, Average loss 0.084, Acc 0.984
Round 186, Average loss 0.093, Acc 0.985
Round 187, Average loss 0.082, Acc 0.984
Round 188, Average loss 0.099, Acc 0.982
Round 189, Average loss 0.056, Acc 0.983
Round 190, Average loss 0.088, Acc 0.984
Round 191, Average loss 0.091, Acc 0.984
Round 192, Average loss 0.087, Acc 0.984
Round 193, Average loss 0.089, Acc 0.986
Round 194, Average loss 0.064, Acc 0.985
Round 195, Average loss 0.081, Acc 0.982
Round 196, Average loss 0.063, Acc 0.984
Round 197, Average loss 0.076, Acc 0.982
Round 198, Average loss 0.078, Acc 0.982
0.005230176601500001
Round 199, Average loss 0.101, Acc 0.982
Round 200, Average loss 0.093, Acc 0.982
Round 201, Average loss 0.110, Acc 0.984
Round 202, Average loss 0.085, Acc 0.983
Round 203, Average loss 0.103, Acc 0.984
Round 204, Average loss 0.073, Acc 0.985
Round 205, Average loss 0.063, Acc 0.985
Round 206, Average loss 0.070, Acc 0.985
Round 207, Average loss 0.097, Acc 0.983
Round 208, Average loss 0.070, Acc 0.982
Round 209, Average loss 0.078, Acc 0.982
Round 210, Average loss 0.072, Acc 0.982
Round 211, Average loss 0.100, Acc 0.984
Round 212, Average loss 0.109, Acc 0.983
Round 213, Average loss 0.077, Acc 0.983
Round 214, Average loss 0.056, Acc 0.984
Round 215, Average loss 0.072, Acc 0.983
Round 216, Average loss 0.078, Acc 0.983
Round 217, Average loss 0.129, Acc 0.984
Round 218, Average loss 0.074, Acc 0.986
0.004707158941350001
Round 219, Average loss 0.059, Acc 0.986
Round 220, Average loss 0.065, Acc 0.984
Round 221, Average loss 0.050, Acc 0.985
Round 222, Average loss 0.061, Acc 0.985
Round 223, Average loss 0.055, Acc 0.982
Round 224, Average loss 0.075, Acc 0.986
Round 225, Average loss 0.078, Acc 0.985
Round 226, Average loss 0.087, Acc 0.983
Round 227, Average loss 0.124, Acc 0.986
Round 228, Average loss 0.108, Acc 0.986
Round 229, Average loss 0.076, Acc 0.985
Round 230, Average loss 0.065, Acc 0.986
Round 231, Average loss 0.065, Acc 0.987
Round 232, Average loss 0.083, Acc 0.986
Round 233, Average loss 0.103, Acc 0.984
Round 234, Average loss 0.066, Acc 0.986
Round 235, Average loss 0.083, Acc 0.987
Round 236, Average loss 0.084, Acc 0.984
Round 237, Average loss 0.062, Acc 0.987
Round 238, Average loss 0.070, Acc 0.985
0.004236443047215001
Round 239, Average loss 0.082, Acc 0.987
Round 240, Average loss 0.068, Acc 0.985
Round 241, Average loss 0.054, Acc 0.985
Round 242, Average loss 0.067, Acc 0.985
Round 243, Average loss 0.093, Acc 0.987
Round 244, Average loss 0.105, Acc 0.987
Round 245, Average loss 0.044, Acc 0.987
Round 246, Average loss 0.048, Acc 0.982
Round 247, Average loss 0.073, Acc 0.985
Round 248, Average loss 0.074, Acc 0.987
Round 249, Average loss 0.081, Acc 0.985
Round 250, Average loss 0.075, Acc 0.985
Round 251, Average loss 0.070, Acc 0.987
Round 252, Average loss 0.110, Acc 0.984
Round 253, Average loss 0.071, Acc 0.987
Round 254, Average loss 0.065, Acc 0.986
Round 255, Average loss 0.048, Acc 0.984
Round 256, Average loss 0.072, Acc 0.987
Round 257, Average loss 0.087, Acc 0.986
Round 258, Average loss 0.106, Acc 0.987
0.003812798742493501
Round 259, Average loss 0.083, Acc 0.986
Round 260, Average loss 0.064, Acc 0.987
Round 261, Average loss 0.079, Acc 0.987
Round 262, Average loss 0.060, Acc 0.986
Round 263, Average loss 0.049, Acc 0.987
Round 264, Average loss 0.073, Acc 0.987
Round 265, Average loss 0.067, Acc 0.986
Round 266, Average loss 0.074, Acc 0.985
Round 267, Average loss 0.076, Acc 0.988
Round 268, Average loss 0.056, Acc 0.986
Round 269, Average loss 0.053, Acc 0.987
Round 270, Average loss 0.073, Acc 0.987
Round 271, Average loss 0.083, Acc 0.986
Round 272, Average loss 0.044, Acc 0.987
Round 273, Average loss 0.093, Acc 0.985
Round 274, Average loss 0.043, Acc 0.988
Round 275, Average loss 0.057, Acc 0.986
Round 276, Average loss 0.089, Acc 0.987
Round 277, Average loss 0.058, Acc 0.987
Round 278, Average loss 0.059, Acc 0.987
0.003431518868244151
Round 279, Average loss 0.071, Acc 0.987
Round 280, Average loss 0.073, Acc 0.984
Round 281, Average loss 0.073, Acc 0.985
Round 282, Average loss 0.081, Acc 0.987
Round 283, Average loss 0.072, Acc 0.986
Round 284, Average loss 0.047, Acc 0.985
Round 285, Average loss 0.095, Acc 0.983
Round 286, Average loss 0.058, Acc 0.985
Round 287, Average loss 0.112, Acc 0.986
Round 288, Average loss 0.095, Acc 0.987
Round 289, Average loss 0.065, Acc 0.985
Round 290, Average loss 0.069, Acc 0.986
Round 291, Average loss 0.091, Acc 0.986
Round 292, Average loss 0.059, Acc 0.985
Round 293, Average loss 0.060, Acc 0.982
Round 294, Average loss 0.057, Acc 0.985
Round 295, Average loss 0.078, Acc 0.987
Round 296, Average loss 0.045, Acc 0.986
Round 297, Average loss 0.045, Acc 0.986
Round 298, Average loss 0.073, Acc 0.987
0.0030883669814197362
Round 299, Average loss 0.065, Acc 0.987
218.75561499595642 s
Memory used: 1678.37 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=50, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.74764127] and score 2 is 0.0
Round   0, Average loss 3.113, Acc 0.000
score 1 is [0.85619354] and score 2 is 0.0
Round   1, Average loss 3.288, Acc 0.000
score 1 is [0.804876] and score 2 is 0.0
Round   2, Average loss 3.288, Acc 0.000
score 1 is [0.8342712] and score 2 is 0.0
Round   3, Average loss 3.288, Acc 0.000
score 1 is [0.8693123] and score 2 is 0.0
Round   4, Average loss 3.288, Acc 0.000
11.849887371063232 s
Memory used: 1671.39 MB

8e-2 + 60
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=60, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.107, Acc 0.569
Round   1, Average loss 2.680, Acc 0.569
Round   2, Average loss 1.744, Acc 0.569
Round   3, Average loss 0.958, Acc 0.744
Round   4, Average loss 0.799, Acc 0.569
Round   5, Average loss 0.755, Acc 0.979
Round   6, Average loss 0.798, Acc 0.715
Round   7, Average loss 0.756, Acc 0.828
Round   8, Average loss 0.733, Acc 0.763
Round   9, Average loss 0.566, Acc 0.968
Round  10, Average loss 0.629, Acc 0.778
Round  11, Average loss 0.595, Acc 0.883
Round  12, Average loss 0.460, Acc 0.794
Round  13, Average loss 0.513, Acc 0.981
Round  14, Average loss 0.490, Acc 0.796
Round  15, Average loss 0.474, Acc 0.951
Round  16, Average loss 0.368, Acc 0.805
Round  17, Average loss 0.489, Acc 0.938
Round  18, Average loss 0.407, Acc 0.885
0.0135
Round  19, Average loss 0.338, Acc 0.966
Round  20, Average loss 0.333, Acc 0.937
Round  21, Average loss 0.264, Acc 0.982
Round  22, Average loss 0.366, Acc 0.940
Round  23, Average loss 0.188, Acc 0.982
Round  24, Average loss 0.254, Acc 0.940
Round  25, Average loss 0.217, Acc 0.981
Round  26, Average loss 0.188, Acc 0.942
Round  27, Average loss 0.254, Acc 0.981
Round  28, Average loss 0.174, Acc 0.946
Round  29, Average loss 0.148, Acc 0.982
Round  30, Average loss 0.138, Acc 0.946
Round  31, Average loss 0.147, Acc 0.968
Round  32, Average loss 0.181, Acc 0.944
Round  33, Average loss 0.225, Acc 0.965
Round  34, Average loss 0.180, Acc 0.982
Round  35, Average loss 0.160, Acc 0.945
Round  36, Average loss 0.152, Acc 0.982
Round  37, Average loss 0.128, Acc 0.981
Round  38, Average loss 0.066, Acc 0.978
0.01215
Round  39, Average loss 0.141, Acc 0.982
Round  40, Average loss 0.148, Acc 0.979
Round  41, Average loss 0.128, Acc 0.981
Round  42, Average loss 0.088, Acc 0.981
Round  43, Average loss 0.137, Acc 0.980
Round  44, Average loss 0.115, Acc 0.981
Round  45, Average loss 0.132, Acc 0.965
Round  46, Average loss 0.111, Acc 0.982
Round  47, Average loss 0.084, Acc 0.980
Round  48, Average loss 0.126, Acc 0.979
Round  49, Average loss 0.124, Acc 0.980
Round  50, Average loss 0.124, Acc 0.981
Round  51, Average loss 0.099, Acc 0.971
Round  52, Average loss 0.149, Acc 0.981
Round  53, Average loss 0.116, Acc 0.971
Round  54, Average loss 0.116, Acc 0.981
Round  55, Average loss 0.131, Acc 0.976
Round  56, Average loss 0.099, Acc 0.982
Round  57, Average loss 0.132, Acc 0.974
Round  58, Average loss 0.108, Acc 0.982
0.010935
Round  59, Average loss 0.077, Acc 0.981
Round  60, Average loss 0.112, Acc 0.983
Round  61, Average loss 0.122, Acc 0.983
Round  62, Average loss 0.113, Acc 0.981
Round  63, Average loss 0.074, Acc 0.973
Round  64, Average loss 0.102, Acc 0.981
Round  65, Average loss 0.152, Acc 0.980
Round  66, Average loss 0.128, Acc 0.982
Round  67, Average loss 0.101, Acc 0.981
Round  68, Average loss 0.105, Acc 0.980
Round  69, Average loss 0.140, Acc 0.980
Round  70, Average loss 0.087, Acc 0.980
Round  71, Average loss 0.121, Acc 0.977
Round  72, Average loss 0.074, Acc 0.981
Round  73, Average loss 0.082, Acc 0.981
Round  74, Average loss 0.132, Acc 0.982
Round  75, Average loss 0.109, Acc 0.981
Round  76, Average loss 0.080, Acc 0.981
Round  77, Average loss 0.186, Acc 0.980
Round  78, Average loss 0.124, Acc 0.982
0.009841500000000001
Round  79, Average loss 0.105, Acc 0.980
Round  80, Average loss 0.082, Acc 0.982
Round  81, Average loss 0.091, Acc 0.980
Round  82, Average loss 0.104, Acc 0.981
Round  83, Average loss 0.117, Acc 0.979
Round  84, Average loss 0.101, Acc 0.982
Round  85, Average loss 0.071, Acc 0.981
Round  86, Average loss 0.076, Acc 0.981
Round  87, Average loss 0.100, Acc 0.980
Round  88, Average loss 0.086, Acc 0.982
Round  89, Average loss 0.048, Acc 0.981
Round  90, Average loss 0.118, Acc 0.983
Round  91, Average loss 0.084, Acc 0.983
Round  92, Average loss 0.067, Acc 0.983
Round  93, Average loss 0.087, Acc 0.983
Round  94, Average loss 0.094, Acc 0.970
Round  95, Average loss 0.140, Acc 0.983
Round  96, Average loss 0.063, Acc 0.981
Round  97, Average loss 0.061, Acc 0.983
Round  98, Average loss 0.104, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.088, Acc 0.981
Round 100, Average loss 0.128, Acc 0.983
Round 101, Average loss 0.077, Acc 0.981
Round 102, Average loss 0.083, Acc 0.981
Round 103, Average loss 0.120, Acc 0.977
Round 104, Average loss 0.105, Acc 0.980
Round 105, Average loss 0.081, Acc 0.982
Round 106, Average loss 0.108, Acc 0.982
Round 107, Average loss 0.083, Acc 0.982
Round 108, Average loss 0.088, Acc 0.981
Round 109, Average loss 0.105, Acc 0.984
Round 110, Average loss 0.115, Acc 0.981
Round 111, Average loss 0.073, Acc 0.984
Round 112, Average loss 0.097, Acc 0.979
Round 113, Average loss 0.092, Acc 0.983
Round 114, Average loss 0.074, Acc 0.980
Round 115, Average loss 0.116, Acc 0.984
Round 116, Average loss 0.050, Acc 0.982
Round 117, Average loss 0.056, Acc 0.981
Round 118, Average loss 0.083, Acc 0.983
0.007971615000000001
Round 119, Average loss 0.112, Acc 0.983
Round 120, Average loss 0.073, Acc 0.984
Round 121, Average loss 0.065, Acc 0.983
Round 122, Average loss 0.073, Acc 0.982
Round 123, Average loss 0.109, Acc 0.984
Round 124, Average loss 0.093, Acc 0.982
Round 125, Average loss 0.043, Acc 0.981
Round 126, Average loss 0.073, Acc 0.984
Round 127, Average loss 0.088, Acc 0.984
Round 128, Average loss 0.079, Acc 0.984
Round 129, Average loss 0.072, Acc 0.983
Round 130, Average loss 0.065, Acc 0.984
Round 131, Average loss 0.077, Acc 0.984
Round 132, Average loss 0.081, Acc 0.982
Round 133, Average loss 0.062, Acc 0.984
Round 134, Average loss 0.070, Acc 0.982
Round 135, Average loss 0.105, Acc 0.983
Round 136, Average loss 0.093, Acc 0.985
Round 137, Average loss 0.075, Acc 0.983
Round 138, Average loss 0.054, Acc 0.985
0.007174453500000001
Round 139, Average loss 0.061, Acc 0.985
Round 140, Average loss 0.070, Acc 0.983
Round 141, Average loss 0.106, Acc 0.984
Round 142, Average loss 0.079, Acc 0.983
Round 143, Average loss 0.084, Acc 0.982
Round 144, Average loss 0.060, Acc 0.982
Round 145, Average loss 0.039, Acc 0.982
Round 146, Average loss 0.054, Acc 0.984
Round 147, Average loss 0.059, Acc 0.984
Round 148, Average loss 0.095, Acc 0.981
Round 149, Average loss 0.053, Acc 0.983
Round 150, Average loss 0.083, Acc 0.981
Round 151, Average loss 0.056, Acc 0.981
Round 152, Average loss 0.077, Acc 0.983
Round 153, Average loss 0.057, Acc 0.982
Round 154, Average loss 0.093, Acc 0.984
Round 155, Average loss 0.065, Acc 0.983
Round 156, Average loss 0.083, Acc 0.983
Round 157, Average loss 0.066, Acc 0.985
Round 158, Average loss 0.060, Acc 0.982
0.006457008150000001
Round 159, Average loss 0.093, Acc 0.983
Round 160, Average loss 0.064, Acc 0.985
Round 161, Average loss 0.040, Acc 0.984
Round 162, Average loss 0.087, Acc 0.983
Round 163, Average loss 0.106, Acc 0.981
Round 164, Average loss 0.047, Acc 0.981
Round 165, Average loss 0.076, Acc 0.982
Round 166, Average loss 0.080, Acc 0.982
Round 167, Average loss 0.103, Acc 0.983
Round 168, Average loss 0.073, Acc 0.983
Round 169, Average loss 0.062, Acc 0.983
Round 170, Average loss 0.097, Acc 0.983
Round 171, Average loss 0.073, Acc 0.982
Round 172, Average loss 0.037, Acc 0.982
Round 173, Average loss 0.065, Acc 0.982
Round 174, Average loss 0.089, Acc 0.982
Round 175, Average loss 0.068, Acc 0.981
Round 176, Average loss 0.060, Acc 0.981
Round 177, Average loss 0.072, Acc 0.982
Round 178, Average loss 0.112, Acc 0.982
0.005811307335000002
Round 179, Average loss 0.081, Acc 0.982
Round 180, Average loss 0.075, Acc 0.983
Round 181, Average loss 0.062, Acc 0.983
Round 182, Average loss 0.069, Acc 0.984
Round 183, Average loss 0.049, Acc 0.984
Round 184, Average loss 0.067, Acc 0.983
Round 185, Average loss 0.049, Acc 0.984
Round 186, Average loss 0.074, Acc 0.984
Round 187, Average loss 0.087, Acc 0.984
Round 188, Average loss 0.054, Acc 0.984
Round 189, Average loss 0.053, Acc 0.984
Round 190, Average loss 0.069, Acc 0.983
Round 191, Average loss 0.052, Acc 0.985
Round 192, Average loss 0.041, Acc 0.984
Round 193, Average loss 0.049, Acc 0.984
Round 194, Average loss 0.082, Acc 0.984
Round 195, Average loss 0.053, Acc 0.985
Round 196, Average loss 0.057, Acc 0.985
Round 197, Average loss 0.047, Acc 0.984
Round 198, Average loss 0.046, Acc 0.985
0.005230176601500001
Round 199, Average loss 0.072, Acc 0.986
Round 200, Average loss 0.080, Acc 0.985
Round 201, Average loss 0.037, Acc 0.985
Round 202, Average loss 0.061, Acc 0.984
Round 203, Average loss 0.097, Acc 0.985
Round 204, Average loss 0.075, Acc 0.987
Round 205, Average loss 0.066, Acc 0.985
Round 206, Average loss 0.050, Acc 0.986
Round 207, Average loss 0.067, Acc 0.983
Round 208, Average loss 0.054, Acc 0.984
Round 209, Average loss 0.057, Acc 0.985
Round 210, Average loss 0.079, Acc 0.984
Round 211, Average loss 0.064, Acc 0.984
Round 212, Average loss 0.052, Acc 0.985
Round 213, Average loss 0.078, Acc 0.985
Round 214, Average loss 0.078, Acc 0.988
Round 215, Average loss 0.059, Acc 0.985
Round 216, Average loss 0.067, Acc 0.985
Round 217, Average loss 0.089, Acc 0.988
Round 218, Average loss 0.054, Acc 0.985
0.004707158941350001
Round 219, Average loss 0.047, Acc 0.984
Round 220, Average loss 0.049, Acc 0.986
Round 221, Average loss 0.046, Acc 0.985
Round 222, Average loss 0.046, Acc 0.987
Round 223, Average loss 0.039, Acc 0.986
Round 224, Average loss 0.085, Acc 0.987
Round 225, Average loss 0.078, Acc 0.986
Round 226, Average loss 0.068, Acc 0.985
Round 227, Average loss 0.108, Acc 0.986
Round 228, Average loss 0.057, Acc 0.984
Round 229, Average loss 0.086, Acc 0.987
Round 230, Average loss 0.049, Acc 0.985
Round 231, Average loss 0.028, Acc 0.984
Round 232, Average loss 0.050, Acc 0.986
Round 233, Average loss 0.064, Acc 0.986
Round 234, Average loss 0.081, Acc 0.988
Round 235, Average loss 0.081, Acc 0.987
Round 236, Average loss 0.076, Acc 0.987
Round 237, Average loss 0.071, Acc 0.989
Round 238, Average loss 0.056, Acc 0.986
0.004236443047215001
Round 239, Average loss 0.050, Acc 0.987
Round 240, Average loss 0.036, Acc 0.986
Round 241, Average loss 0.075, Acc 0.986
Round 242, Average loss 0.100, Acc 0.988
Round 243, Average loss 0.092, Acc 0.989
Round 244, Average loss 0.044, Acc 0.989
Round 245, Average loss 0.066, Acc 0.989
Round 246, Average loss 0.055, Acc 0.987
Round 247, Average loss 0.060, Acc 0.986
Round 248, Average loss 0.056, Acc 0.987
Round 249, Average loss 0.048, Acc 0.987
Round 250, Average loss 0.046, Acc 0.987
Round 251, Average loss 0.054, Acc 0.989
Round 252, Average loss 0.047, Acc 0.987
Round 253, Average loss 0.042, Acc 0.987
Round 254, Average loss 0.046, Acc 0.987
Round 255, Average loss 0.041, Acc 0.987
Round 256, Average loss 0.090, Acc 0.988
Round 257, Average loss 0.068, Acc 0.987
Round 258, Average loss 0.047, Acc 0.988
0.003812798742493501
Round 259, Average loss 0.063, Acc 0.988
Round 260, Average loss 0.028, Acc 0.986
Round 261, Average loss 0.038, Acc 0.987
Round 262, Average loss 0.040, Acc 0.986
Round 263, Average loss 0.066, Acc 0.988
Round 264, Average loss 0.040, Acc 0.987
Round 265, Average loss 0.039, Acc 0.986
Round 266, Average loss 0.043, Acc 0.989
Round 267, Average loss 0.076, Acc 0.990
Round 268, Average loss 0.047, Acc 0.988
Round 269, Average loss 0.062, Acc 0.989
Round 270, Average loss 0.023, Acc 0.987
Round 271, Average loss 0.087, Acc 0.989
Round 272, Average loss 0.037, Acc 0.988
Round 273, Average loss 0.052, Acc 0.990
Round 274, Average loss 0.072, Acc 0.989
Round 275, Average loss 0.067, Acc 0.988
Round 276, Average loss 0.060, Acc 0.989
Round 277, Average loss 0.056, Acc 0.988
Round 278, Average loss 0.028, Acc 0.988
0.003431518868244151
Round 279, Average loss 0.026, Acc 0.987
Round 280, Average loss 0.048, Acc 0.990
Round 281, Average loss 0.056, Acc 0.988
Round 282, Average loss 0.080, Acc 0.989
Round 283, Average loss 0.048, Acc 0.988
Round 284, Average loss 0.044, Acc 0.989
Round 285, Average loss 0.047, Acc 0.988
Round 286, Average loss 0.048, Acc 0.989
Round 287, Average loss 0.045, Acc 0.988
Round 288, Average loss 0.049, Acc 0.988
Round 289, Average loss 0.033, Acc 0.988
Round 290, Average loss 0.081, Acc 0.988
Round 291, Average loss 0.032, Acc 0.988
Round 292, Average loss 0.046, Acc 0.989
Round 293, Average loss 0.040, Acc 0.988
Round 294, Average loss 0.040, Acc 0.988
Round 295, Average loss 0.042, Acc 0.989
Round 296, Average loss 0.086, Acc 0.988
Round 297, Average loss 0.053, Acc 0.988
Round 298, Average loss 0.085, Acc 0.990
0.0030883669814197362
Round 299, Average loss 0.043, Acc 0.988
232.05211472511292 s
Memory used: 1672.48 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=60, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.72885925] and score 2 is 0.0
Round   0, Average loss 3.076, Acc 0.165
score 1 is [0.64116836] and score 2 is 0.0
Round   1, Average loss 3.041, Acc 0.165
score 1 is [0.7769318] and score 2 is 0.0
Round   2, Average loss 3.250, Acc 0.165
score 1 is [0.77731544] and score 2 is 0.0
Round   3, Average loss 3.009, Acc 0.165
score 1 is [0.8107489] and score 2 is 0.0
Round   4, Average loss 3.250, Acc 0.165
11.650496482849121 s
Memory used: 1667.85 MB

8e-2 + 70
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=70, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.191, Acc 0.744
Round   1, Average loss 2.644, Acc 0.569
Round   2, Average loss 1.474, Acc 0.569
Round   3, Average loss 0.901, Acc 0.789
Round   4, Average loss 0.948, Acc 0.569
Round   5, Average loss 1.005, Acc 0.786
Round   6, Average loss 0.805, Acc 0.574
Round   7, Average loss 0.967, Acc 0.786
Round   8, Average loss 0.703, Acc 0.772
Round   9, Average loss 0.770, Acc 0.931
Round  10, Average loss 0.615, Acc 0.786
Round  11, Average loss 0.648, Acc 0.940
Round  12, Average loss 0.575, Acc 0.786
Round  13, Average loss 0.579, Acc 0.413
Round  14, Average loss 0.705, Acc 0.788
Round  15, Average loss 0.425, Acc 0.978
Round  16, Average loss 0.532, Acc 0.796
Round  17, Average loss 0.471, Acc 0.980
Round  18, Average loss 0.546, Acc 0.859
0.0135
Round  19, Average loss 0.398, Acc 0.977
Round  20, Average loss 0.343, Acc 0.926
Round  21, Average loss 0.278, Acc 0.981
Round  22, Average loss 0.356, Acc 0.937
Round  23, Average loss 0.258, Acc 0.981
Round  24, Average loss 0.295, Acc 0.940
Round  25, Average loss 0.281, Acc 0.954
Round  26, Average loss 0.274, Acc 0.947
Round  27, Average loss 0.181, Acc 0.981
Round  28, Average loss 0.474, Acc 0.943
Round  29, Average loss 0.161, Acc 0.943
Round  30, Average loss 0.163, Acc 0.981
Round  31, Average loss 0.322, Acc 0.945
Round  32, Average loss 0.177, Acc 0.960
Round  33, Average loss 0.299, Acc 0.943
Round  34, Average loss 0.173, Acc 0.981
Round  35, Average loss 0.129, Acc 0.979
Round  36, Average loss 0.151, Acc 0.953
Round  37, Average loss 0.161, Acc 0.981
Round  38, Average loss 0.198, Acc 0.945
0.01215
Round  39, Average loss 0.207, Acc 0.981
Round  40, Average loss 0.112, Acc 0.974
Round  41, Average loss 0.076, Acc 0.981
Round  42, Average loss 0.102, Acc 0.981
Round  43, Average loss 0.141, Acc 0.975
Round  44, Average loss 0.124, Acc 0.981
Round  45, Average loss 0.147, Acc 0.981
Round  46, Average loss 0.104, Acc 0.981
Round  47, Average loss 0.113, Acc 0.976
Round  48, Average loss 0.110, Acc 0.981
Round  49, Average loss 0.082, Acc 0.980
Round  50, Average loss 0.090, Acc 0.968
Round  51, Average loss 0.160, Acc 0.981
Round  52, Average loss 0.064, Acc 0.981
Round  53, Average loss 0.100, Acc 0.981
Round  54, Average loss 0.109, Acc 0.976
Round  55, Average loss 0.111, Acc 0.981
Round  56, Average loss 0.162, Acc 0.978
Round  57, Average loss 0.093, Acc 0.947
Round  58, Average loss 0.238, Acc 0.981
0.010935
Round  59, Average loss 0.120, Acc 0.981
Round  60, Average loss 0.111, Acc 0.981
Round  61, Average loss 0.078, Acc 0.979
Round  62, Average loss 0.147, Acc 0.981
Round  63, Average loss 0.115, Acc 0.981
Round  64, Average loss 0.118, Acc 0.981
Round  65, Average loss 0.072, Acc 0.981
Round  66, Average loss 0.151, Acc 0.972
Round  67, Average loss 0.091, Acc 0.981
Round  68, Average loss 0.135, Acc 0.980
Round  69, Average loss 0.128, Acc 0.981
Round  70, Average loss 0.129, Acc 0.981
Round  71, Average loss 0.086, Acc 0.953
Round  72, Average loss 0.158, Acc 0.981
Round  73, Average loss 0.076, Acc 0.981
Round  74, Average loss 0.096, Acc 0.981
Round  75, Average loss 0.078, Acc 0.981
Round  76, Average loss 0.100, Acc 0.981
Round  77, Average loss 0.063, Acc 0.981
Round  78, Average loss 0.131, Acc 0.979
0.009841500000000001
Round  79, Average loss 0.172, Acc 0.981
Round  80, Average loss 0.109, Acc 0.974
Round  81, Average loss 0.133, Acc 0.980
Round  82, Average loss 0.120, Acc 0.981
Round  83, Average loss 0.145, Acc 0.981
Round  84, Average loss 0.117, Acc 0.981
Round  85, Average loss 0.118, Acc 0.981
Round  86, Average loss 0.174, Acc 0.981
Round  87, Average loss 0.087, Acc 0.981
Round  88, Average loss 0.068, Acc 0.980
Round  89, Average loss 0.089, Acc 0.981
Round  90, Average loss 0.096, Acc 0.981
Round  91, Average loss 0.111, Acc 0.983
Round  92, Average loss 0.098, Acc 0.982
Round  93, Average loss 0.081, Acc 0.983
Round  94, Average loss 0.139, Acc 0.981
Round  95, Average loss 0.095, Acc 0.981
Round  96, Average loss 0.077, Acc 0.981
Round  97, Average loss 0.107, Acc 0.981
Round  98, Average loss 0.112, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.137, Acc 0.983
Round 100, Average loss 0.101, Acc 0.981
Round 101, Average loss 0.090, Acc 0.982
Round 102, Average loss 0.105, Acc 0.954
Round 103, Average loss 0.257, Acc 0.981
Round 104, Average loss 0.062, Acc 0.980
Round 105, Average loss 0.091, Acc 0.981
Round 106, Average loss 0.085, Acc 0.983
Round 107, Average loss 0.120, Acc 0.983
Round 108, Average loss 0.132, Acc 0.982
Round 109, Average loss 0.120, Acc 0.981
Round 110, Average loss 0.077, Acc 0.982
Round 111, Average loss 0.085, Acc 0.982
Round 112, Average loss 0.044, Acc 0.982
Round 113, Average loss 0.108, Acc 0.981
Round 114, Average loss 0.130, Acc 0.983
Round 115, Average loss 0.082, Acc 0.981
Round 116, Average loss 0.047, Acc 0.983
Round 117, Average loss 0.042, Acc 0.981
Round 118, Average loss 0.124, Acc 0.985
0.007971615000000001
Round 119, Average loss 0.089, Acc 0.981
Round 120, Average loss 0.083, Acc 0.986
Round 121, Average loss 0.070, Acc 0.981
Round 122, Average loss 0.076, Acc 0.984
Round 123, Average loss 0.098, Acc 0.982
Round 124, Average loss 0.058, Acc 0.984
Round 125, Average loss 0.072, Acc 0.984
Round 126, Average loss 0.070, Acc 0.984
Round 127, Average loss 0.078, Acc 0.983
Round 128, Average loss 0.099, Acc 0.984
Round 129, Average loss 0.087, Acc 0.983
Round 130, Average loss 0.075, Acc 0.984
Round 131, Average loss 0.045, Acc 0.985
Round 132, Average loss 0.044, Acc 0.985
Round 133, Average loss 0.048, Acc 0.979
Round 134, Average loss 0.079, Acc 0.984
Round 135, Average loss 0.140, Acc 0.983
Round 136, Average loss 0.086, Acc 0.985
Round 137, Average loss 0.086, Acc 0.984
Round 138, Average loss 0.089, Acc 0.984
0.007174453500000001
Round 139, Average loss 0.108, Acc 0.983
Round 140, Average loss 0.085, Acc 0.984
Round 141, Average loss 0.072, Acc 0.986
Round 142, Average loss 0.082, Acc 0.984
Round 143, Average loss 0.063, Acc 0.980
Round 144, Average loss 0.109, Acc 0.984
Round 145, Average loss 0.045, Acc 0.984
Round 146, Average loss 0.087, Acc 0.984
Round 147, Average loss 0.078, Acc 0.985
Round 148, Average loss 0.074, Acc 0.985
Round 149, Average loss 0.081, Acc 0.983
Round 150, Average loss 0.097, Acc 0.986
Round 151, Average loss 0.052, Acc 0.985
Round 152, Average loss 0.051, Acc 0.981
Round 153, Average loss 0.090, Acc 0.987
Round 154, Average loss 0.086, Acc 0.985
Round 155, Average loss 0.065, Acc 0.985
Round 156, Average loss 0.112, Acc 0.987
Round 157, Average loss 0.088, Acc 0.984
Round 158, Average loss 0.055, Acc 0.983
0.006457008150000001
Round 159, Average loss 0.060, Acc 0.987
Round 160, Average loss 0.077, Acc 0.984
Round 161, Average loss 0.060, Acc 0.984
Round 162, Average loss 0.073, Acc 0.985
Round 163, Average loss 0.039, Acc 0.984
Round 164, Average loss 0.060, Acc 0.985
Round 165, Average loss 0.050, Acc 0.984
Round 166, Average loss 0.068, Acc 0.987
Round 167, Average loss 0.042, Acc 0.984
Round 168, Average loss 0.113, Acc 0.986
Round 169, Average loss 0.055, Acc 0.984
Round 170, Average loss 0.077, Acc 0.987
Round 171, Average loss 0.077, Acc 0.983
Round 172, Average loss 0.077, Acc 0.988
Round 173, Average loss 0.054, Acc 0.984
Round 174, Average loss 0.073, Acc 0.988
Round 175, Average loss 0.060, Acc 0.985
Round 176, Average loss 0.077, Acc 0.988
Round 177, Average loss 0.091, Acc 0.986
Round 178, Average loss 0.078, Acc 0.985
0.005811307335000002
Round 179, Average loss 0.069, Acc 0.986
Round 180, Average loss 0.062, Acc 0.989
Round 181, Average loss 0.053, Acc 0.987
Round 182, Average loss 0.061, Acc 0.985
Round 183, Average loss 0.054, Acc 0.985
Round 184, Average loss 0.080, Acc 0.989
Round 185, Average loss 0.066, Acc 0.985
Round 186, Average loss 0.099, Acc 0.987
Round 187, Average loss 0.086, Acc 0.985
Round 188, Average loss 0.035, Acc 0.983
Round 189, Average loss 0.080, Acc 0.982
Round 190, Average loss 0.067, Acc 0.984
Round 191, Average loss 0.041, Acc 0.988
Round 192, Average loss 0.075, Acc 0.987
Round 193, Average loss 0.058, Acc 0.986
Round 194, Average loss 0.064, Acc 0.988
Round 195, Average loss 0.085, Acc 0.987
Round 196, Average loss 0.051, Acc 0.982
Round 197, Average loss 0.117, Acc 0.988
Round 198, Average loss 0.053, Acc 0.985
0.005230176601500001
Round 199, Average loss 0.050, Acc 0.987
Round 200, Average loss 0.064, Acc 0.987
Round 201, Average loss 0.082, Acc 0.988
Round 202, Average loss 0.059, Acc 0.988
Round 203, Average loss 0.063, Acc 0.987
Round 204, Average loss 0.091, Acc 0.988
Round 205, Average loss 0.059, Acc 0.987
Round 206, Average loss 0.050, Acc 0.988
Round 207, Average loss 0.061, Acc 0.986
Round 208, Average loss 0.035, Acc 0.989
Round 209, Average loss 0.058, Acc 0.989
Round 210, Average loss 0.029, Acc 0.988
Round 211, Average loss 0.046, Acc 0.988
Round 212, Average loss 0.047, Acc 0.989
Round 213, Average loss 0.064, Acc 0.988
Round 214, Average loss 0.031, Acc 0.987
Round 215, Average loss 0.047, Acc 0.988
Round 216, Average loss 0.040, Acc 0.989
Round 217, Average loss 0.054, Acc 0.989
Round 218, Average loss 0.036, Acc 0.987
0.004707158941350001
Round 219, Average loss 0.042, Acc 0.989
Round 220, Average loss 0.071, Acc 0.989
Round 221, Average loss 0.058, Acc 0.989
Round 222, Average loss 0.078, Acc 0.989
Round 223, Average loss 0.048, Acc 0.988
Round 224, Average loss 0.086, Acc 0.989
Round 225, Average loss 0.033, Acc 0.988
Round 226, Average loss 0.038, Acc 0.986
Round 227, Average loss 0.070, Acc 0.986
Round 228, Average loss 0.044, Acc 0.988
Round 229, Average loss 0.035, Acc 0.986
Round 230, Average loss 0.065, Acc 0.988
Round 231, Average loss 0.026, Acc 0.988
Round 232, Average loss 0.062, Acc 0.988
Round 233, Average loss 0.090, Acc 0.987
Round 234, Average loss 0.047, Acc 0.988
Round 235, Average loss 0.053, Acc 0.987
Round 236, Average loss 0.050, Acc 0.989
Round 237, Average loss 0.037, Acc 0.987
Round 238, Average loss 0.083, Acc 0.989
0.004236443047215001
Round 239, Average loss 0.074, Acc 0.987
Round 240, Average loss 0.035, Acc 0.987
Round 241, Average loss 0.055, Acc 0.988
Round 242, Average loss 0.078, Acc 0.990
Round 243, Average loss 0.054, Acc 0.990
Round 244, Average loss 0.031, Acc 0.989
Round 245, Average loss 0.041, Acc 0.988
Round 246, Average loss 0.039, Acc 0.989
Round 247, Average loss 0.075, Acc 0.990
Round 248, Average loss 0.034, Acc 0.989
Round 249, Average loss 0.030, Acc 0.987
Round 250, Average loss 0.093, Acc 0.987
Round 251, Average loss 0.059, Acc 0.988
Round 252, Average loss 0.056, Acc 0.986
Round 253, Average loss 0.051, Acc 0.987
Round 254, Average loss 0.047, Acc 0.986
Round 255, Average loss 0.037, Acc 0.987
Round 256, Average loss 0.047, Acc 0.987
Round 257, Average loss 0.059, Acc 0.986
Round 258, Average loss 0.042, Acc 0.987
0.003812798742493501
Round 259, Average loss 0.055, Acc 0.988
Round 260, Average loss 0.055, Acc 0.988
Round 261, Average loss 0.087, Acc 0.987
Round 262, Average loss 0.048, Acc 0.986
Round 263, Average loss 0.052, Acc 0.988
Round 264, Average loss 0.052, Acc 0.986
Round 265, Average loss 0.056, Acc 0.987
Round 266, Average loss 0.061, Acc 0.986
Round 267, Average loss 0.061, Acc 0.987
Round 268, Average loss 0.042, Acc 0.985
Round 269, Average loss 0.050, Acc 0.988
Round 270, Average loss 0.053, Acc 0.984
Round 271, Average loss 0.052, Acc 0.984
Round 272, Average loss 0.054, Acc 0.985
Round 273, Average loss 0.042, Acc 0.986
Round 274, Average loss 0.045, Acc 0.985
Round 275, Average loss 0.049, Acc 0.984
Round 276, Average loss 0.054, Acc 0.989
Round 277, Average loss 0.061, Acc 0.990
Round 278, Average loss 0.019, Acc 0.988
0.003431518868244151
Round 279, Average loss 0.022, Acc 0.986
Round 280, Average loss 0.038, Acc 0.987
Round 281, Average loss 0.078, Acc 0.989
Round 282, Average loss 0.064, Acc 0.989
Round 283, Average loss 0.058, Acc 0.990
Round 284, Average loss 0.025, Acc 0.988
Round 285, Average loss 0.026, Acc 0.988
Round 286, Average loss 0.039, Acc 0.989
Round 287, Average loss 0.046, Acc 0.988
Round 288, Average loss 0.073, Acc 0.986
Round 289, Average loss 0.050, Acc 0.989
Round 290, Average loss 0.044, Acc 0.990
Round 291, Average loss 0.042, Acc 0.989
Round 292, Average loss 0.030, Acc 0.984
Round 293, Average loss 0.034, Acc 0.989
Round 294, Average loss 0.060, Acc 0.988
Round 295, Average loss 0.033, Acc 0.988
Round 296, Average loss 0.097, Acc 0.987
Round 297, Average loss 0.037, Acc 0.988
Round 298, Average loss 0.055, Acc 0.989
0.0030883669814197362
Round 299, Average loss 0.047, Acc 0.990
260.79660868644714 s
Memory used: 1661.24 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=70, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.9023284] and score 2 is 0.0
Round   0, Average loss 3.063, Acc 0.000
score 1 is [0.82534045] and score 2 is 0.0
Round   1, Average loss 3.063, Acc 0.000
score 1 is [0.81328744] and score 2 is 0.0
Round   2, Average loss 3.068, Acc 0.000
score 1 is [0.9341149] and score 2 is 0.0
Round   3, Average loss 3.063, Acc 0.000
score 1 is [0.7684734] and score 2 is 0.0
Round   4, Average loss 3.063, Acc 0.000
12.654700756072998 s
Memory used: 1685.89 MB

8e-2 + 80
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=80, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.166, Acc 0.569
Round   1, Average loss 2.638, Acc 0.569
Round   2, Average loss 1.405, Acc 0.569
Round   3, Average loss 1.002, Acc 0.800
Round   4, Average loss 1.284, Acc 0.569
Round   5, Average loss 0.841, Acc 0.392
Round   6, Average loss 1.315, Acc 0.569
Round   7, Average loss 0.829, Acc 0.361
Round   8, Average loss 1.042, Acc 0.569
Round   9, Average loss 0.797, Acc 0.941
Round  10, Average loss 0.797, Acc 0.569
Round  11, Average loss 0.925, Acc 0.942
Round  12, Average loss 0.616, Acc 0.792
Round  13, Average loss 0.517, Acc 0.980
Round  14, Average loss 0.456, Acc 0.787
Round  15, Average loss 0.457, Acc 0.945
Round  16, Average loss 0.368, Acc 0.939
Round  17, Average loss 0.305, Acc 0.957
Round  18, Average loss 0.567, Acc 0.939
0.0135
Round  19, Average loss 0.238, Acc 0.955
Round  20, Average loss 0.345, Acc 0.939
Round  21, Average loss 0.236, Acc 0.978
Round  22, Average loss 0.197, Acc 0.940
Round  23, Average loss 0.224, Acc 0.943
Round  24, Average loss 0.180, Acc 0.943
Round  25, Average loss 0.162, Acc 0.953
Round  26, Average loss 0.239, Acc 0.944
Round  27, Average loss 0.165, Acc 0.981
Round  28, Average loss 0.187, Acc 0.944
Round  29, Average loss 0.175, Acc 0.981
Round  30, Average loss 0.146, Acc 0.964
Round  31, Average loss 0.113, Acc 0.981
Round  32, Average loss 0.121, Acc 0.973
Round  33, Average loss 0.164, Acc 0.980
Round  34, Average loss 0.136, Acc 0.968
Round  35, Average loss 0.118, Acc 0.979
Round  36, Average loss 0.081, Acc 0.975
Round  37, Average loss 0.144, Acc 0.978
Round  38, Average loss 0.150, Acc 0.979
0.01215
Round  39, Average loss 0.156, Acc 0.980
Round  40, Average loss 0.089, Acc 0.981
Round  41, Average loss 0.085, Acc 0.977
Round  42, Average loss 0.075, Acc 0.981
Round  43, Average loss 0.101, Acc 0.978
Round  44, Average loss 0.132, Acc 0.980
Round  45, Average loss 0.089, Acc 0.978
Round  46, Average loss 0.135, Acc 0.981
Round  47, Average loss 0.080, Acc 0.984
Round  48, Average loss 0.113, Acc 0.981
Round  49, Average loss 0.089, Acc 0.982
Round  50, Average loss 0.154, Acc 0.977
Round  51, Average loss 0.105, Acc 0.982
Round  52, Average loss 0.072, Acc 0.977
Round  53, Average loss 0.118, Acc 0.981
Round  54, Average loss 0.128, Acc 0.980
Round  55, Average loss 0.114, Acc 0.964
Round  56, Average loss 0.165, Acc 0.981
Round  57, Average loss 0.144, Acc 0.976
Round  58, Average loss 0.117, Acc 0.980
0.010935
Round  59, Average loss 0.101, Acc 0.984
Round  60, Average loss 0.098, Acc 0.981
Round  61, Average loss 0.113, Acc 0.982
Round  62, Average loss 0.110, Acc 0.982
Round  63, Average loss 0.072, Acc 0.982
Round  64, Average loss 0.075, Acc 0.981
Round  65, Average loss 0.109, Acc 0.983
Round  66, Average loss 0.088, Acc 0.983
Round  67, Average loss 0.102, Acc 0.983
Round  68, Average loss 0.097, Acc 0.984
Round  69, Average loss 0.086, Acc 0.982
Round  70, Average loss 0.085, Acc 0.984
Round  71, Average loss 0.061, Acc 0.984
Round  72, Average loss 0.099, Acc 0.982
Round  73, Average loss 0.080, Acc 0.984
Round  74, Average loss 0.093, Acc 0.984
Round  75, Average loss 0.082, Acc 0.983
Round  76, Average loss 0.133, Acc 0.983
Round  77, Average loss 0.062, Acc 0.983
Round  78, Average loss 0.061, Acc 0.985
0.009841500000000001
Round  79, Average loss 0.057, Acc 0.984
Round  80, Average loss 0.105, Acc 0.985
Round  81, Average loss 0.115, Acc 0.984
Round  82, Average loss 0.061, Acc 0.983
Round  83, Average loss 0.074, Acc 0.984
Round  84, Average loss 0.085, Acc 0.985
Round  85, Average loss 0.083, Acc 0.984
Round  86, Average loss 0.062, Acc 0.984
Round  87, Average loss 0.061, Acc 0.984
Round  88, Average loss 0.099, Acc 0.984
Round  89, Average loss 0.049, Acc 0.983
Round  90, Average loss 0.086, Acc 0.984
Round  91, Average loss 0.070, Acc 0.984
Round  92, Average loss 0.086, Acc 0.984
Round  93, Average loss 0.082, Acc 0.984
Round  94, Average loss 0.072, Acc 0.984
Round  95, Average loss 0.090, Acc 0.985
Round  96, Average loss 0.066, Acc 0.984
Round  97, Average loss 0.054, Acc 0.985
Round  98, Average loss 0.062, Acc 0.986
0.008857350000000002
Round  99, Average loss 0.089, Acc 0.984
Round 100, Average loss 0.089, Acc 0.985
Round 101, Average loss 0.068, Acc 0.984
Round 102, Average loss 0.051, Acc 0.984
Round 103, Average loss 0.050, Acc 0.984
Round 104, Average loss 0.086, Acc 0.987
Round 105, Average loss 0.064, Acc 0.984
Round 106, Average loss 0.057, Acc 0.983
Round 107, Average loss 0.084, Acc 0.986
Round 108, Average loss 0.091, Acc 0.984
Round 109, Average loss 0.063, Acc 0.987
Round 110, Average loss 0.040, Acc 0.984
Round 111, Average loss 0.052, Acc 0.985
Round 112, Average loss 0.059, Acc 0.984
Round 113, Average loss 0.088, Acc 0.986
Round 114, Average loss 0.091, Acc 0.984
Round 115, Average loss 0.052, Acc 0.983
Round 116, Average loss 0.048, Acc 0.983
Round 117, Average loss 0.084, Acc 0.986
Round 118, Average loss 0.068, Acc 0.984
0.007971615000000001
Round 119, Average loss 0.071, Acc 0.985
Round 120, Average loss 0.048, Acc 0.982
Round 121, Average loss 0.140, Acc 0.987
Round 122, Average loss 0.068, Acc 0.984
Round 123, Average loss 0.062, Acc 0.984
Round 124, Average loss 0.105, Acc 0.984
Round 125, Average loss 0.075, Acc 0.984
Round 126, Average loss 0.046, Acc 0.985
Round 127, Average loss 0.068, Acc 0.984
Round 128, Average loss 0.057, Acc 0.987
Round 129, Average loss 0.087, Acc 0.984
Round 130, Average loss 0.044, Acc 0.987
Round 131, Average loss 0.067, Acc 0.984
Round 132, Average loss 0.093, Acc 0.985
Round 133, Average loss 0.060, Acc 0.984
Round 134, Average loss 0.040, Acc 0.987
Round 135, Average loss 0.053, Acc 0.987
Round 136, Average loss 0.055, Acc 0.986
Round 137, Average loss 0.074, Acc 0.984
Round 138, Average loss 0.046, Acc 0.986
0.007174453500000001
Round 139, Average loss 0.074, Acc 0.987
Round 140, Average loss 0.104, Acc 0.986
Round 141, Average loss 0.074, Acc 0.985
Round 142, Average loss 0.056, Acc 0.987
Round 143, Average loss 0.083, Acc 0.984
Round 144, Average loss 0.056, Acc 0.986
Round 145, Average loss 0.089, Acc 0.987
Round 146, Average loss 0.078, Acc 0.984
Round 147, Average loss 0.056, Acc 0.987
Round 148, Average loss 0.058, Acc 0.985
Round 149, Average loss 0.074, Acc 0.986
Round 150, Average loss 0.061, Acc 0.986
Round 151, Average loss 0.019, Acc 0.988
Round 152, Average loss 0.065, Acc 0.988
Round 153, Average loss 0.088, Acc 0.987
Round 154, Average loss 0.049, Acc 0.987
Round 155, Average loss 0.057, Acc 0.987
Round 156, Average loss 0.051, Acc 0.988
Round 157, Average loss 0.053, Acc 0.988
Round 158, Average loss 0.050, Acc 0.985
0.006457008150000001
Round 159, Average loss 0.046, Acc 0.988
Round 160, Average loss 0.074, Acc 0.988
Round 161, Average loss 0.097, Acc 0.986
Round 162, Average loss 0.063, Acc 0.987
Round 163, Average loss 0.063, Acc 0.986
Round 164, Average loss 0.068, Acc 0.988
Round 165, Average loss 0.058, Acc 0.987
Round 166, Average loss 0.058, Acc 0.985
Round 167, Average loss 0.079, Acc 0.986
Round 168, Average loss 0.034, Acc 0.988
Round 169, Average loss 0.065, Acc 0.985
Round 170, Average loss 0.037, Acc 0.989
Round 171, Average loss 0.050, Acc 0.986
Round 172, Average loss 0.075, Acc 0.989
Round 173, Average loss 0.063, Acc 0.986
Round 174, Average loss 0.094, Acc 0.987
Round 175, Average loss 0.060, Acc 0.990
Round 176, Average loss 0.075, Acc 0.986
Round 177, Average loss 0.066, Acc 0.987
Round 178, Average loss 0.053, Acc 0.987
0.005811307335000002
Round 179, Average loss 0.052, Acc 0.989
Round 180, Average loss 0.071, Acc 0.986
Round 181, Average loss 0.073, Acc 0.989
Round 182, Average loss 0.063, Acc 0.986
Round 183, Average loss 0.063, Acc 0.987
Round 184, Average loss 0.049, Acc 0.987
Round 185, Average loss 0.058, Acc 0.986
Round 186, Average loss 0.038, Acc 0.987
Round 187, Average loss 0.069, Acc 0.988
Round 188, Average loss 0.083, Acc 0.989
Round 189, Average loss 0.064, Acc 0.989
Round 190, Average loss 0.053, Acc 0.988
Round 191, Average loss 0.065, Acc 0.988
Round 192, Average loss 0.053, Acc 0.987
Round 193, Average loss 0.078, Acc 0.988
Round 194, Average loss 0.064, Acc 0.990
Round 195, Average loss 0.057, Acc 0.990
Round 196, Average loss 0.047, Acc 0.988
Round 197, Average loss 0.053, Acc 0.989
Round 198, Average loss 0.053, Acc 0.989
0.005230176601500001
Round 199, Average loss 0.048, Acc 0.989
Round 200, Average loss 0.042, Acc 0.988
Round 201, Average loss 0.046, Acc 0.988
Round 202, Average loss 0.041, Acc 0.988
Round 203, Average loss 0.025, Acc 0.987
Round 204, Average loss 0.061, Acc 0.987
Round 205, Average loss 0.043, Acc 0.990
Round 206, Average loss 0.110, Acc 0.989
Round 207, Average loss 0.041, Acc 0.988
Round 208, Average loss 0.055, Acc 0.990
Round 209, Average loss 0.049, Acc 0.990
Round 210, Average loss 0.031, Acc 0.989
Round 211, Average loss 0.065, Acc 0.989
Round 212, Average loss 0.044, Acc 0.990
Round 213, Average loss 0.045, Acc 0.990
Round 214, Average loss 0.045, Acc 0.988
Round 215, Average loss 0.068, Acc 0.989
Round 216, Average loss 0.058, Acc 0.989
Round 217, Average loss 0.065, Acc 0.989
Round 218, Average loss 0.063, Acc 0.991
0.004707158941350001
Round 219, Average loss 0.050, Acc 0.988
Round 220, Average loss 0.050, Acc 0.989
Round 221, Average loss 0.043, Acc 0.986
Round 222, Average loss 0.028, Acc 0.985
Round 223, Average loss 0.071, Acc 0.988
Round 224, Average loss 0.079, Acc 0.987
Round 225, Average loss 0.033, Acc 0.987
Round 226, Average loss 0.037, Acc 0.987
Round 227, Average loss 0.091, Acc 0.986
Round 228, Average loss 0.025, Acc 0.987
Round 229, Average loss 0.055, Acc 0.987
Round 230, Average loss 0.033, Acc 0.987
Round 231, Average loss 0.074, Acc 0.989
Round 232, Average loss 0.043, Acc 0.987
Round 233, Average loss 0.081, Acc 0.990
Round 234, Average loss 0.058, Acc 0.990
Round 235, Average loss 0.049, Acc 0.989
Round 236, Average loss 0.033, Acc 0.988
Round 237, Average loss 0.104, Acc 0.990
Round 238, Average loss 0.031, Acc 0.988
0.004236443047215001
Round 239, Average loss 0.047, Acc 0.990
Round 240, Average loss 0.061, Acc 0.989
Round 241, Average loss 0.027, Acc 0.988
Round 242, Average loss 0.078, Acc 0.988
Round 243, Average loss 0.040, Acc 0.988
Round 244, Average loss 0.052, Acc 0.989
Round 245, Average loss 0.038, Acc 0.989
Round 246, Average loss 0.063, Acc 0.990
Round 247, Average loss 0.050, Acc 0.987
Round 248, Average loss 0.039, Acc 0.988
Round 249, Average loss 0.038, Acc 0.988
Round 250, Average loss 0.084, Acc 0.988
Round 251, Average loss 0.053, Acc 0.990
Round 252, Average loss 0.083, Acc 0.989
Round 253, Average loss 0.032, Acc 0.987
Round 254, Average loss 0.046, Acc 0.988
Round 255, Average loss 0.053, Acc 0.989
Round 256, Average loss 0.031, Acc 0.988
Round 257, Average loss 0.083, Acc 0.989
Round 258, Average loss 0.034, Acc 0.988
0.003812798742493501
Round 259, Average loss 0.044, Acc 0.990
Round 260, Average loss 0.076, Acc 0.988
Round 261, Average loss 0.038, Acc 0.988
Round 262, Average loss 0.060, Acc 0.988
Round 263, Average loss 0.059, Acc 0.987
Round 264, Average loss 0.065, Acc 0.986
Round 265, Average loss 0.039, Acc 0.985
Round 266, Average loss 0.050, Acc 0.988
Round 267, Average loss 0.081, Acc 0.990
Round 268, Average loss 0.043, Acc 0.990
Round 269, Average loss 0.053, Acc 0.990
Round 270, Average loss 0.056, Acc 0.989
Round 271, Average loss 0.039, Acc 0.986
Round 272, Average loss 0.069, Acc 0.989
Round 273, Average loss 0.042, Acc 0.989
Round 274, Average loss 0.070, Acc 0.989
Round 275, Average loss 0.066, Acc 0.989
Round 276, Average loss 0.046, Acc 0.990
Round 277, Average loss 0.052, Acc 0.988
Round 278, Average loss 0.047, Acc 0.989
0.003431518868244151
Round 279, Average loss 0.061, Acc 0.990
Round 280, Average loss 0.041, Acc 0.990
Round 281, Average loss 0.036, Acc 0.990
Round 282, Average loss 0.046, Acc 0.989
Round 283, Average loss 0.052, Acc 0.990
Round 284, Average loss 0.069, Acc 0.990
Round 285, Average loss 0.070, Acc 0.989
Round 286, Average loss 0.031, Acc 0.988
Round 287, Average loss 0.062, Acc 0.991
Round 288, Average loss 0.077, Acc 0.989
Round 289, Average loss 0.082, Acc 0.990
Round 290, Average loss 0.047, Acc 0.988
Round 291, Average loss 0.063, Acc 0.990
Round 292, Average loss 0.044, Acc 0.989
Round 293, Average loss 0.051, Acc 0.989
Round 294, Average loss 0.036, Acc 0.989
Round 295, Average loss 0.047, Acc 0.991
Round 296, Average loss 0.034, Acc 0.990
Round 297, Average loss 0.039, Acc 0.989
Round 298, Average loss 0.034, Acc 0.990
0.0030883669814197362
Round 299, Average loss 0.033, Acc 0.990
277.8310887813568 s
Memory used: 1651.22 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=80, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.9018929] and score 2 is 0.0
Round   0, Average loss 3.095, Acc 0.017
score 1 is [0.86462307] and score 2 is 0.0
Round   1, Average loss 3.095, Acc 0.017
score 1 is [0.8640563] and score 2 is 0.0
Round   2, Average loss 3.034, Acc 0.017
score 1 is [0.8391354] and score 2 is 0.0
Round   3, Average loss 3.050, Acc 0.017
score 1 is [0.7540916] and score 2 is 0.0
Round   4, Average loss 3.095, Acc 0.017
12.825311422348022 s
Memory used: 1633.64 MB

8e-2 + 90
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=90, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.139, Acc 0.786
Round   1, Average loss 2.686, Acc 0.786
Round   2, Average loss 1.606, Acc 0.744
Round   3, Average loss 0.675, Acc 0.963
Round   4, Average loss 0.742, Acc 0.569
Round   5, Average loss 0.976, Acc 0.929
Round   6, Average loss 0.578, Acc 0.786
Round   7, Average loss 0.648, Acc 0.967
Round   8, Average loss 0.516, Acc 0.786
Round   9, Average loss 0.584, Acc 0.942
Round  10, Average loss 0.493, Acc 0.887
Round  11, Average loss 0.374, Acc 0.969
Round  12, Average loss 0.443, Acc 0.866
Round  13, Average loss 0.397, Acc 0.982
Round  14, Average loss 0.367, Acc 0.918
Round  15, Average loss 0.331, Acc 0.981
Round  16, Average loss 0.396, Acc 0.940
Round  17, Average loss 0.232, Acc 0.941
Round  18, Average loss 0.310, Acc 0.929
0.0135
Round  19, Average loss 0.247, Acc 0.980
Round  20, Average loss 0.175, Acc 0.934
Round  21, Average loss 0.193, Acc 0.981
Round  22, Average loss 0.341, Acc 0.942
Round  23, Average loss 0.200, Acc 0.981
Round  24, Average loss 0.427, Acc 0.945
Round  25, Average loss 0.167, Acc 0.980
Round  26, Average loss 0.269, Acc 0.936
Round  27, Average loss 0.156, Acc 0.981
Round  28, Average loss 0.212, Acc 0.967
Round  29, Average loss 0.191, Acc 0.980
Round  30, Average loss 0.262, Acc 0.945
Round  31, Average loss 0.123, Acc 0.982
Round  32, Average loss 0.203, Acc 0.946
Round  33, Average loss 0.224, Acc 0.982
Round  34, Average loss 0.152, Acc 0.975
Round  35, Average loss 0.130, Acc 0.982
Round  36, Average loss 0.175, Acc 0.962
Round  37, Average loss 0.133, Acc 0.981
Round  38, Average loss 0.158, Acc 0.969
0.01215
Round  39, Average loss 0.146, Acc 0.981
Round  40, Average loss 0.109, Acc 0.981
Round  41, Average loss 0.142, Acc 0.971
Round  42, Average loss 0.158, Acc 0.981
Round  43, Average loss 0.086, Acc 0.980
Round  44, Average loss 0.112, Acc 0.981
Round  45, Average loss 0.133, Acc 0.980
Round  46, Average loss 0.118, Acc 0.980
Round  47, Average loss 0.111, Acc 0.981
Round  48, Average loss 0.172, Acc 0.981
Round  49, Average loss 0.137, Acc 0.981
Round  50, Average loss 0.147, Acc 0.981
Round  51, Average loss 0.144, Acc 0.976
Round  52, Average loss 0.115, Acc 0.981
Round  53, Average loss 0.156, Acc 0.973
Round  54, Average loss 0.122, Acc 0.981
Round  55, Average loss 0.149, Acc 0.973
Round  56, Average loss 0.114, Acc 0.981
Round  57, Average loss 0.102, Acc 0.976
Round  58, Average loss 0.122, Acc 0.981
0.010935
Round  59, Average loss 0.146, Acc 0.981
Round  60, Average loss 0.083, Acc 0.978
Round  61, Average loss 0.101, Acc 0.982
Round  62, Average loss 0.096, Acc 0.944
Round  63, Average loss 0.477, Acc 0.981
Round  64, Average loss 0.099, Acc 0.981
Round  65, Average loss 0.092, Acc 0.981
Round  66, Average loss 0.118, Acc 0.980
Round  67, Average loss 0.074, Acc 0.981
Round  68, Average loss 0.188, Acc 0.978
Round  69, Average loss 0.107, Acc 0.981
Round  70, Average loss 0.082, Acc 0.980
Round  71, Average loss 0.089, Acc 0.982
Round  72, Average loss 0.104, Acc 0.981
Round  73, Average loss 0.116, Acc 0.981
Round  74, Average loss 0.102, Acc 0.978
Round  75, Average loss 0.094, Acc 0.981
Round  76, Average loss 0.077, Acc 0.981
Round  77, Average loss 0.158, Acc 0.944
Round  78, Average loss 0.163, Acc 0.981
0.009841500000000001
Round  79, Average loss 0.105, Acc 0.981
Round  80, Average loss 0.103, Acc 0.981
Round  81, Average loss 0.061, Acc 0.981
Round  82, Average loss 0.082, Acc 0.981
Round  83, Average loss 0.101, Acc 0.982
Round  84, Average loss 0.102, Acc 0.981
Round  85, Average loss 0.078, Acc 0.981
Round  86, Average loss 0.107, Acc 0.981
Round  87, Average loss 0.130, Acc 0.981
Round  88, Average loss 0.067, Acc 0.980
Round  89, Average loss 0.125, Acc 0.981
Round  90, Average loss 0.102, Acc 0.981
Round  91, Average loss 0.114, Acc 0.981
Round  92, Average loss 0.084, Acc 0.981
Round  93, Average loss 0.091, Acc 0.981
Round  94, Average loss 0.101, Acc 0.981
Round  95, Average loss 0.075, Acc 0.980
Round  96, Average loss 0.091, Acc 0.981
Round  97, Average loss 0.105, Acc 0.981
Round  98, Average loss 0.101, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.067, Acc 0.981
Round 100, Average loss 0.086, Acc 0.981
Round 101, Average loss 0.095, Acc 0.981
Round 102, Average loss 0.078, Acc 0.981
Round 103, Average loss 0.100, Acc 0.983
Round 104, Average loss 0.093, Acc 0.981
Round 105, Average loss 0.060, Acc 0.983
Round 106, Average loss 0.089, Acc 0.981
Round 107, Average loss 0.080, Acc 0.981
Round 108, Average loss 0.086, Acc 0.981
Round 109, Average loss 0.119, Acc 0.981
Round 110, Average loss 0.080, Acc 0.981
Round 111, Average loss 0.084, Acc 0.982
Round 112, Average loss 0.082, Acc 0.982
Round 113, Average loss 0.092, Acc 0.982
Round 114, Average loss 0.087, Acc 0.982
Round 115, Average loss 0.107, Acc 0.982
Round 116, Average loss 0.069, Acc 0.984
Round 117, Average loss 0.095, Acc 0.981
Round 118, Average loss 0.078, Acc 0.981
0.007971615000000001
Round 119, Average loss 0.093, Acc 0.984
Round 120, Average loss 0.086, Acc 0.981
Round 121, Average loss 0.077, Acc 0.982
Round 122, Average loss 0.057, Acc 0.982
Round 123, Average loss 0.052, Acc 0.982
Round 124, Average loss 0.070, Acc 0.984
Round 125, Average loss 0.078, Acc 0.984
Round 126, Average loss 0.067, Acc 0.983
Round 127, Average loss 0.107, Acc 0.985
Round 128, Average loss 0.082, Acc 0.984
Round 129, Average loss 0.118, Acc 0.982
Round 130, Average loss 0.055, Acc 0.982
Round 131, Average loss 0.062, Acc 0.982
Round 132, Average loss 0.092, Acc 0.985
Round 133, Average loss 0.077, Acc 0.982
Round 134, Average loss 0.115, Acc 0.983
Round 135, Average loss 0.078, Acc 0.982
Round 136, Average loss 0.073, Acc 0.981
Round 137, Average loss 0.076, Acc 0.982
Round 138, Average loss 0.076, Acc 0.982
0.007174453500000001
Round 139, Average loss 0.067, Acc 0.984
Round 140, Average loss 0.044, Acc 0.985
Round 141, Average loss 0.083, Acc 0.986
Round 142, Average loss 0.077, Acc 0.985
Round 143, Average loss 0.079, Acc 0.984
Round 144, Average loss 0.104, Acc 0.984
Round 145, Average loss 0.077, Acc 0.985
Round 146, Average loss 0.079, Acc 0.985
Round 147, Average loss 0.116, Acc 0.984
Round 148, Average loss 0.064, Acc 0.984
Round 149, Average loss 0.068, Acc 0.982
Round 150, Average loss 0.060, Acc 0.984
Round 151, Average loss 0.071, Acc 0.984
Round 152, Average loss 0.059, Acc 0.986
Round 153, Average loss 0.071, Acc 0.986
Round 154, Average loss 0.108, Acc 0.986
Round 155, Average loss 0.099, Acc 0.987
Round 156, Average loss 0.083, Acc 0.983
Round 157, Average loss 0.092, Acc 0.983
Round 158, Average loss 0.084, Acc 0.986
0.006457008150000001
Round 159, Average loss 0.068, Acc 0.986
Round 160, Average loss 0.078, Acc 0.986
Round 161, Average loss 0.083, Acc 0.986
Round 162, Average loss 0.059, Acc 0.987
Round 163, Average loss 0.078, Acc 0.987
Round 164, Average loss 0.091, Acc 0.986
Round 165, Average loss 0.077, Acc 0.988
Round 166, Average loss 0.088, Acc 0.985
Round 167, Average loss 0.055, Acc 0.985
Round 168, Average loss 0.053, Acc 0.986
Round 169, Average loss 0.054, Acc 0.982
Round 170, Average loss 0.048, Acc 0.988
Round 171, Average loss 0.059, Acc 0.984
Round 172, Average loss 0.074, Acc 0.986
Round 173, Average loss 0.072, Acc 0.987
Round 174, Average loss 0.068, Acc 0.986
Round 175, Average loss 0.062, Acc 0.989
Round 176, Average loss 0.054, Acc 0.985
Round 177, Average loss 0.040, Acc 0.984
Round 178, Average loss 0.074, Acc 0.988
0.005811307335000002
Round 179, Average loss 0.086, Acc 0.987
Round 180, Average loss 0.086, Acc 0.988
Round 181, Average loss 0.064, Acc 0.987
Round 182, Average loss 0.044, Acc 0.985
Round 183, Average loss 0.082, Acc 0.987
Round 184, Average loss 0.041, Acc 0.989
Round 185, Average loss 0.082, Acc 0.989
Round 186, Average loss 0.076, Acc 0.987
Round 187, Average loss 0.092, Acc 0.987
Round 188, Average loss 0.050, Acc 0.987
Round 189, Average loss 0.083, Acc 0.987
Round 190, Average loss 0.038, Acc 0.988
Round 191, Average loss 0.072, Acc 0.988
Round 192, Average loss 0.086, Acc 0.988
Round 193, Average loss 0.047, Acc 0.987
Round 194, Average loss 0.050, Acc 0.987
Round 195, Average loss 0.053, Acc 0.988
Round 196, Average loss 0.046, Acc 0.987
Round 197, Average loss 0.088, Acc 0.987
Round 198, Average loss 0.045, Acc 0.986
0.005230176601500001
Round 199, Average loss 0.094, Acc 0.986
Round 200, Average loss 0.084, Acc 0.988
Round 201, Average loss 0.038, Acc 0.988
Round 202, Average loss 0.045, Acc 0.988
Round 203, Average loss 0.073, Acc 0.989
Round 204, Average loss 0.050, Acc 0.987
Round 205, Average loss 0.059, Acc 0.990
Round 206, Average loss 0.061, Acc 0.988
Round 207, Average loss 0.031, Acc 0.987
Round 208, Average loss 0.096, Acc 0.989
Round 209, Average loss 0.043, Acc 0.988
Round 210, Average loss 0.068, Acc 0.987
Round 211, Average loss 0.066, Acc 0.988
Round 212, Average loss 0.094, Acc 0.989
Round 213, Average loss 0.040, Acc 0.988
Round 214, Average loss 0.068, Acc 0.989
Round 215, Average loss 0.041, Acc 0.986
Round 216, Average loss 0.041, Acc 0.987
Round 217, Average loss 0.035, Acc 0.989
Round 218, Average loss 0.073, Acc 0.988
0.004707158941350001
Round 219, Average loss 0.041, Acc 0.985
Round 220, Average loss 0.064, Acc 0.989
Round 221, Average loss 0.062, Acc 0.988
Round 222, Average loss 0.065, Acc 0.989
Round 223, Average loss 0.041, Acc 0.988
Round 224, Average loss 0.057, Acc 0.990
Round 225, Average loss 0.063, Acc 0.989
Round 226, Average loss 0.051, Acc 0.989
Round 227, Average loss 0.057, Acc 0.986
Round 228, Average loss 0.069, Acc 0.989
Round 229, Average loss 0.060, Acc 0.987
Round 230, Average loss 0.042, Acc 0.990
Round 231, Average loss 0.091, Acc 0.989
Round 232, Average loss 0.042, Acc 0.986
Round 233, Average loss 0.055, Acc 0.990
Round 234, Average loss 0.065, Acc 0.987
Round 235, Average loss 0.057, Acc 0.988
Round 236, Average loss 0.065, Acc 0.988
Round 237, Average loss 0.066, Acc 0.990
Round 238, Average loss 0.039, Acc 0.988
0.004236443047215001
Round 239, Average loss 0.072, Acc 0.988
Round 240, Average loss 0.054, Acc 0.988
Round 241, Average loss 0.026, Acc 0.990
Round 242, Average loss 0.046, Acc 0.990
Round 243, Average loss 0.035, Acc 0.988
Round 244, Average loss 0.057, Acc 0.989
Round 245, Average loss 0.043, Acc 0.988
Round 246, Average loss 0.081, Acc 0.990
Round 247, Average loss 0.078, Acc 0.990
Round 248, Average loss 0.054, Acc 0.988
Round 249, Average loss 0.065, Acc 0.990
Round 250, Average loss 0.085, Acc 0.990
Round 251, Average loss 0.046, Acc 0.989
Round 252, Average loss 0.043, Acc 0.990
Round 253, Average loss 0.073, Acc 0.990
Round 254, Average loss 0.039, Acc 0.989
Round 255, Average loss 0.046, Acc 0.990
Round 256, Average loss 0.060, Acc 0.990
Round 257, Average loss 0.057, Acc 0.990
Round 258, Average loss 0.068, Acc 0.990
0.003812798742493501
Round 259, Average loss 0.047, Acc 0.990
Round 260, Average loss 0.054, Acc 0.990
Round 261, Average loss 0.035, Acc 0.990
Round 262, Average loss 0.042, Acc 0.990
Round 263, Average loss 0.101, Acc 0.990
Round 264, Average loss 0.043, Acc 0.990
Round 265, Average loss 0.047, Acc 0.990
Round 266, Average loss 0.057, Acc 0.990
Round 267, Average loss 0.042, Acc 0.990
Round 268, Average loss 0.045, Acc 0.990
Round 269, Average loss 0.028, Acc 0.988
Round 270, Average loss 0.055, Acc 0.990
Round 271, Average loss 0.055, Acc 0.989
Round 272, Average loss 0.047, Acc 0.990
Round 273, Average loss 0.038, Acc 0.990
Round 274, Average loss 0.059, Acc 0.990
Round 275, Average loss 0.077, Acc 0.989
Round 276, Average loss 0.055, Acc 0.990
Round 277, Average loss 0.047, Acc 0.990
Round 278, Average loss 0.050, Acc 0.990
0.003431518868244151
Round 279, Average loss 0.049, Acc 0.990
Round 280, Average loss 0.079, Acc 0.990
Round 281, Average loss 0.024, Acc 0.990
Round 282, Average loss 0.069, Acc 0.990
Round 283, Average loss 0.041, Acc 0.990
Round 284, Average loss 0.049, Acc 0.990
Round 285, Average loss 0.060, Acc 0.989
Round 286, Average loss 0.034, Acc 0.990
Round 287, Average loss 0.049, Acc 0.990
Round 288, Average loss 0.035, Acc 0.989
Round 289, Average loss 0.049, Acc 0.990
Round 290, Average loss 0.063, Acc 0.990
Round 291, Average loss 0.042, Acc 0.990
Round 292, Average loss 0.035, Acc 0.990
Round 293, Average loss 0.070, Acc 0.990
Round 294, Average loss 0.065, Acc 0.990
Round 295, Average loss 0.045, Acc 0.990
Round 296, Average loss 0.062, Acc 0.990
Round 297, Average loss 0.047, Acc 0.990
Round 298, Average loss 0.041, Acc 0.990
0.0030883669814197362
Round 299, Average loss 0.059, Acc 0.990
303.04849123954773 s
Memory used: 1662.85 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=90, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.74668574] and score 2 is 0.0
Round   0, Average loss 3.177, Acc 0.000
score 1 is [0.678581] and score 2 is 0.0
Round   1, Average loss 3.180, Acc 0.000
score 1 is [0.67035025] and score 2 is 0.0
Round   2, Average loss 3.051, Acc 0.000
score 1 is [0.7870662] and score 2 is 0.0
Round   3, Average loss 3.051, Acc 0.000
score 1 is [0.7180956] and score 2 is 0.0
Round   4, Average loss 3.179, Acc 0.000
14.074034690856934 s
Memory used: 1667.13 MB

8e-2 + 100
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=100, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.202, Acc 0.569
Round   1, Average loss 2.724, Acc 0.744
Round   2, Average loss 1.621, Acc 0.645
Round   3, Average loss 0.796, Acc 0.970
Round   4, Average loss 0.822, Acc 0.569
Round   5, Average loss 0.873, Acc 0.798
Round   6, Average loss 0.628, Acc 0.786
Round   7, Average loss 0.677, Acc 0.807
Round   8, Average loss 0.544, Acc 0.786
Round   9, Average loss 0.590, Acc 0.877
Round  10, Average loss 0.532, Acc 0.786
Round  11, Average loss 0.546, Acc 0.978
Round  12, Average loss 0.441, Acc 0.798
Round  13, Average loss 0.405, Acc 0.981
Round  14, Average loss 0.319, Acc 0.879
Round  15, Average loss 0.354, Acc 0.982
Round  16, Average loss 0.271, Acc 0.939
Round  17, Average loss 0.184, Acc 0.940
Round  18, Average loss 0.328, Acc 0.935
0.0135
Round  19, Average loss 0.232, Acc 0.982
Round  20, Average loss 0.174, Acc 0.940
Round  21, Average loss 0.232, Acc 0.982
Round  22, Average loss 0.248, Acc 0.940
Round  23, Average loss 0.192, Acc 0.982
Round  24, Average loss 0.169, Acc 0.949
Round  25, Average loss 0.192, Acc 0.981
Round  26, Average loss 0.168, Acc 0.961
Round  27, Average loss 0.171, Acc 0.980
Round  28, Average loss 0.148, Acc 0.969
Round  29, Average loss 0.160, Acc 0.982
Round  30, Average loss 0.142, Acc 0.976
Round  31, Average loss 0.119, Acc 0.981
Round  32, Average loss 0.128, Acc 0.978
Round  33, Average loss 0.088, Acc 0.981
Round  34, Average loss 0.181, Acc 0.974
Round  35, Average loss 0.145, Acc 0.981
Round  36, Average loss 0.122, Acc 0.978
Round  37, Average loss 0.125, Acc 0.981
Round  38, Average loss 0.118, Acc 0.976
0.01215
Round  39, Average loss 0.104, Acc 0.978
Round  40, Average loss 0.113, Acc 0.973
Round  41, Average loss 0.108, Acc 0.981
Round  42, Average loss 0.108, Acc 0.976
Round  43, Average loss 0.115, Acc 0.982
Round  44, Average loss 0.083, Acc 0.981
Round  45, Average loss 0.218, Acc 0.981
Round  46, Average loss 0.092, Acc 0.977
Round  47, Average loss 0.136, Acc 0.982
Round  48, Average loss 0.092, Acc 0.978
Round  49, Average loss 0.088, Acc 0.981
Round  50, Average loss 0.084, Acc 0.979
Round  51, Average loss 0.080, Acc 0.981
Round  52, Average loss 0.080, Acc 0.977
Round  53, Average loss 0.161, Acc 0.981
Round  54, Average loss 0.107, Acc 0.980
Round  55, Average loss 0.106, Acc 0.981
Round  56, Average loss 0.127, Acc 0.978
Round  57, Average loss 0.088, Acc 0.981
Round  58, Average loss 0.087, Acc 0.981
0.010935
Round  59, Average loss 0.132, Acc 0.981
Round  60, Average loss 0.080, Acc 0.985
Round  61, Average loss 0.088, Acc 0.981
Round  62, Average loss 0.139, Acc 0.981
Round  63, Average loss 0.087, Acc 0.981
Round  64, Average loss 0.105, Acc 0.984
Round  65, Average loss 0.113, Acc 0.981
Round  66, Average loss 0.073, Acc 0.983
Round  67, Average loss 0.097, Acc 0.981
Round  68, Average loss 0.083, Acc 0.982
Round  69, Average loss 0.074, Acc 0.981
Round  70, Average loss 0.049, Acc 0.983
Round  71, Average loss 0.102, Acc 0.981
Round  72, Average loss 0.080, Acc 0.982
Round  73, Average loss 0.129, Acc 0.983
Round  74, Average loss 0.078, Acc 0.981
Round  75, Average loss 0.114, Acc 0.983
Round  76, Average loss 0.140, Acc 0.980
Round  77, Average loss 0.072, Acc 0.984
Round  78, Average loss 0.056, Acc 0.983
0.009841500000000001
Round  79, Average loss 0.073, Acc 0.986
Round  80, Average loss 0.047, Acc 0.983
Round  81, Average loss 0.118, Acc 0.985
Round  82, Average loss 0.074, Acc 0.984
Round  83, Average loss 0.125, Acc 0.987
Round  84, Average loss 0.068, Acc 0.984
Round  85, Average loss 0.087, Acc 0.984
Round  86, Average loss 0.068, Acc 0.983
Round  87, Average loss 0.078, Acc 0.984
Round  88, Average loss 0.095, Acc 0.982
Round  89, Average loss 0.105, Acc 0.984
Round  90, Average loss 0.097, Acc 0.981
Round  91, Average loss 0.078, Acc 0.985
Round  92, Average loss 0.062, Acc 0.981
Round  93, Average loss 0.058, Acc 0.985
Round  94, Average loss 0.090, Acc 0.983
Round  95, Average loss 0.063, Acc 0.985
Round  96, Average loss 0.068, Acc 0.981
Round  97, Average loss 0.075, Acc 0.984
Round  98, Average loss 0.085, Acc 0.983
0.008857350000000002
Round  99, Average loss 0.053, Acc 0.984
Round 100, Average loss 0.069, Acc 0.983
Round 101, Average loss 0.071, Acc 0.983
Round 102, Average loss 0.048, Acc 0.986
Round 103, Average loss 0.076, Acc 0.984
Round 104, Average loss 0.065, Acc 0.986
Round 105, Average loss 0.063, Acc 0.984
Round 106, Average loss 0.074, Acc 0.984
Round 107, Average loss 0.071, Acc 0.985
Round 108, Average loss 0.083, Acc 0.985
Round 109, Average loss 0.099, Acc 0.983
Round 110, Average loss 0.072, Acc 0.985
Round 111, Average loss 0.089, Acc 0.984
Round 112, Average loss 0.087, Acc 0.985
Round 113, Average loss 0.062, Acc 0.984
Round 114, Average loss 0.104, Acc 0.986
Round 115, Average loss 0.091, Acc 0.984
Round 116, Average loss 0.097, Acc 0.986
Round 117, Average loss 0.080, Acc 0.984
Round 118, Average loss 0.072, Acc 0.984
0.007971615000000001
Round 119, Average loss 0.064, Acc 0.984
Round 120, Average loss 0.051, Acc 0.984
Round 121, Average loss 0.094, Acc 0.984
Round 122, Average loss 0.066, Acc 0.984
Round 123, Average loss 0.059, Acc 0.985
Round 124, Average loss 0.054, Acc 0.985
Round 125, Average loss 0.067, Acc 0.987
Round 126, Average loss 0.057, Acc 0.984
Round 127, Average loss 0.113, Acc 0.985
Round 128, Average loss 0.063, Acc 0.984
Round 129, Average loss 0.044, Acc 0.986
Round 130, Average loss 0.071, Acc 0.984
Round 131, Average loss 0.100, Acc 0.985
Round 132, Average loss 0.092, Acc 0.985
Round 133, Average loss 0.093, Acc 0.984
Round 134, Average loss 0.050, Acc 0.984
Round 135, Average loss 0.055, Acc 0.985
Round 136, Average loss 0.093, Acc 0.985
Round 137, Average loss 0.077, Acc 0.984
Round 138, Average loss 0.067, Acc 0.984
0.007174453500000001
Round 139, Average loss 0.036, Acc 0.984
Round 140, Average loss 0.059, Acc 0.986
Round 141, Average loss 0.067, Acc 0.986
Round 142, Average loss 0.083, Acc 0.986
Round 143, Average loss 0.063, Acc 0.987
Round 144, Average loss 0.087, Acc 0.986
Round 145, Average loss 0.107, Acc 0.984
Round 146, Average loss 0.077, Acc 0.983
Round 147, Average loss 0.068, Acc 0.982
Round 148, Average loss 0.068, Acc 0.984
Round 149, Average loss 0.102, Acc 0.985
Round 150, Average loss 0.077, Acc 0.986
Round 151, Average loss 0.061, Acc 0.987
Round 152, Average loss 0.064, Acc 0.984
Round 153, Average loss 0.066, Acc 0.987
Round 154, Average loss 0.047, Acc 0.984
Round 155, Average loss 0.084, Acc 0.987
Round 156, Average loss 0.066, Acc 0.985
Round 157, Average loss 0.058, Acc 0.985
Round 158, Average loss 0.068, Acc 0.986
0.006457008150000001
Round 159, Average loss 0.065, Acc 0.987
Round 160, Average loss 0.059, Acc 0.986
Round 161, Average loss 0.045, Acc 0.988
Round 162, Average loss 0.039, Acc 0.986
Round 163, Average loss 0.036, Acc 0.986
Round 164, Average loss 0.085, Acc 0.986
Round 165, Average loss 0.050, Acc 0.987
Round 166, Average loss 0.080, Acc 0.988
Round 167, Average loss 0.051, Acc 0.988
Round 168, Average loss 0.061, Acc 0.987
Round 169, Average loss 0.064, Acc 0.986
Round 170, Average loss 0.062, Acc 0.986
Round 171, Average loss 0.045, Acc 0.984
Round 172, Average loss 0.051, Acc 0.986
Round 173, Average loss 0.046, Acc 0.984
Round 174, Average loss 0.062, Acc 0.986
Round 175, Average loss 0.061, Acc 0.984
Round 176, Average loss 0.039, Acc 0.984
Round 177, Average loss 0.040, Acc 0.984
Round 178, Average loss 0.088, Acc 0.958
0.005811307335000002
Round 179, Average loss 0.147, Acc 0.984
Round 180, Average loss 0.081, Acc 0.987
Round 181, Average loss 0.065, Acc 0.985
Round 182, Average loss 0.088, Acc 0.988
Round 183, Average loss 0.071, Acc 0.988
Round 184, Average loss 0.054, Acc 0.988
Round 185, Average loss 0.056, Acc 0.986
Round 186, Average loss 0.082, Acc 0.984
Round 187, Average loss 0.054, Acc 0.988
Round 188, Average loss 0.082, Acc 0.987
Round 189, Average loss 0.065, Acc 0.985
Round 190, Average loss 0.053, Acc 0.986
Round 191, Average loss 0.046, Acc 0.984
Round 192, Average loss 0.063, Acc 0.986
Round 193, Average loss 0.044, Acc 0.984
Round 194, Average loss 0.054, Acc 0.988
Round 195, Average loss 0.035, Acc 0.988
Round 196, Average loss 0.071, Acc 0.986
Round 197, Average loss 0.066, Acc 0.986
Round 198, Average loss 0.059, Acc 0.986
0.005230176601500001
Round 199, Average loss 0.065, Acc 0.986
Round 200, Average loss 0.045, Acc 0.987
Round 201, Average loss 0.080, Acc 0.988
Round 202, Average loss 0.077, Acc 0.988
Round 203, Average loss 0.049, Acc 0.984
Round 204, Average loss 0.038, Acc 0.986
Round 205, Average loss 0.072, Acc 0.988
Round 206, Average loss 0.045, Acc 0.985
Round 207, Average loss 0.043, Acc 0.987
Round 208, Average loss 0.058, Acc 0.988
Round 209, Average loss 0.063, Acc 0.984
Round 210, Average loss 0.069, Acc 0.987
Round 211, Average loss 0.072, Acc 0.986
Round 212, Average loss 0.084, Acc 0.987
Round 213, Average loss 0.050, Acc 0.985
Round 214, Average loss 0.048, Acc 0.988
Round 215, Average loss 0.028, Acc 0.988
Round 216, Average loss 0.100, Acc 0.986
Round 217, Average loss 0.068, Acc 0.985
Round 218, Average loss 0.061, Acc 0.987
0.004707158941350001
Round 219, Average loss 0.072, Acc 0.985
Round 220, Average loss 0.053, Acc 0.986
Round 221, Average loss 0.036, Acc 0.986
Round 222, Average loss 0.084, Acc 0.988
Round 223, Average loss 0.053, Acc 0.987
Round 224, Average loss 0.060, Acc 0.988
Round 225, Average loss 0.065, Acc 0.987
Round 226, Average loss 0.073, Acc 0.985
Round 227, Average loss 0.066, Acc 0.987
Round 228, Average loss 0.078, Acc 0.985
Round 229, Average loss 0.056, Acc 0.985
Round 230, Average loss 0.072, Acc 0.986
Round 231, Average loss 0.046, Acc 0.988
Round 232, Average loss 0.059, Acc 0.988
Round 233, Average loss 0.062, Acc 0.986
Round 234, Average loss 0.070, Acc 0.987
Round 235, Average loss 0.066, Acc 0.986
Round 236, Average loss 0.048, Acc 0.986
Round 237, Average loss 0.046, Acc 0.987
Round 238, Average loss 0.056, Acc 0.984
0.004236443047215001
Round 239, Average loss 0.086, Acc 0.988
Round 240, Average loss 0.073, Acc 0.985
Round 241, Average loss 0.042, Acc 0.986
Round 242, Average loss 0.049, Acc 0.988
Round 243, Average loss 0.083, Acc 0.985
Round 244, Average loss 0.046, Acc 0.986
Round 245, Average loss 0.068, Acc 0.988
Round 246, Average loss 0.072, Acc 0.985
Round 247, Average loss 0.081, Acc 0.985
Round 248, Average loss 0.051, Acc 0.985
Round 249, Average loss 0.057, Acc 0.985
Round 250, Average loss 0.068, Acc 0.985
Round 251, Average loss 0.059, Acc 0.985
Round 252, Average loss 0.045, Acc 0.986
Round 253, Average loss 0.067, Acc 0.985
Round 254, Average loss 0.078, Acc 0.985
Round 255, Average loss 0.052, Acc 0.985
Round 256, Average loss 0.055, Acc 0.984
Round 257, Average loss 0.057, Acc 0.985
Round 258, Average loss 0.081, Acc 0.985
0.003812798742493501
Round 259, Average loss 0.073, Acc 0.985
Round 260, Average loss 0.053, Acc 0.985
Round 261, Average loss 0.088, Acc 0.986
Round 262, Average loss 0.065, Acc 0.988
Round 263, Average loss 0.085, Acc 0.987
Round 264, Average loss 0.062, Acc 0.988
Round 265, Average loss 0.055, Acc 0.987
Round 266, Average loss 0.061, Acc 0.986
Round 267, Average loss 0.067, Acc 0.987
Round 268, Average loss 0.087, Acc 0.985
Round 269, Average loss 0.057, Acc 0.987
Round 270, Average loss 0.051, Acc 0.988
Round 271, Average loss 0.068, Acc 0.987
Round 272, Average loss 0.089, Acc 0.988
Round 273, Average loss 0.066, Acc 0.988
Round 274, Average loss 0.077, Acc 0.988
Round 275, Average loss 0.066, Acc 0.988
Round 276, Average loss 0.072, Acc 0.988
Round 277, Average loss 0.057, Acc 0.988
Round 278, Average loss 0.055, Acc 0.988
0.003431518868244151
Round 279, Average loss 0.056, Acc 0.988
Round 280, Average loss 0.055, Acc 0.988
Round 281, Average loss 0.053, Acc 0.986
Round 282, Average loss 0.054, Acc 0.986
Round 283, Average loss 0.059, Acc 0.985
Round 284, Average loss 0.045, Acc 0.984
Round 285, Average loss 0.072, Acc 0.985
Round 286, Average loss 0.051, Acc 0.985
Round 287, Average loss 0.060, Acc 0.986
Round 288, Average loss 0.054, Acc 0.986
Round 289, Average loss 0.048, Acc 0.986
Round 290, Average loss 0.054, Acc 0.987
Round 291, Average loss 0.048, Acc 0.986
Round 292, Average loss 0.042, Acc 0.985
Round 293, Average loss 0.051, Acc 0.985
Round 294, Average loss 0.049, Acc 0.986
Round 295, Average loss 0.041, Acc 0.986
Round 296, Average loss 0.087, Acc 0.986
Round 297, Average loss 0.051, Acc 0.985
Round 298, Average loss 0.089, Acc 0.988
0.0030883669814197362
Round 299, Average loss 0.064, Acc 0.988
300.6642236709595 s
Memory used: 1678.43 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=100, defense_lr=0.08, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.7144932] and score 2 is 0.0
Round   0, Average loss 3.192, Acc 0.000
score 1 is [0.5999789] and score 2 is 0.0
Round   1, Average loss 3.206, Acc 0.000
score 1 is [0.69318295] and score 2 is 0.0
Round   2, Average loss 3.156, Acc 0.000
score 1 is [0.7399639] and score 2 is 0.0
Round   3, Average loss 3.156, Acc 0.000
score 1 is [0.7139041] and score 2 is 0.0
Round   4, Average loss 3.172, Acc 0.000
11.449523448944092 s
Memory used: 1681.52 MB

2e-1 + 10
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=10, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.174, Acc 0.745
Round   1, Average loss 2.642, Acc 0.688
Round   2, Average loss 1.734, Acc 0.569
Round   3, Average loss 1.506, Acc 0.569
Round   4, Average loss 1.103, Acc 0.569
Round   5, Average loss 1.306, Acc 0.569
Round   6, Average loss 1.169, Acc 0.742
Round   7, Average loss 1.363, Acc 0.719
Round   8, Average loss 1.026, Acc 0.744
Round   9, Average loss 0.933, Acc 0.717
Round  10, Average loss 0.965, Acc 0.836
Round  11, Average loss 0.904, Acc 0.679
Round  12, Average loss 1.413, Acc 0.642
Round  13, Average loss 1.072, Acc 0.657
Round  14, Average loss 1.668, Acc 0.723
Round  15, Average loss 1.454, Acc 0.751
Round  16, Average loss 1.535, Acc 0.569
Round  17, Average loss 1.946, Acc 0.749
Round  18, Average loss 2.027, Acc 0.569
0.0135
Round  19, Average loss 1.825, Acc 0.569
Round  20, Average loss 2.692, Acc 0.569
Round  21, Average loss 1.886, Acc 0.723
Round  22, Average loss 3.330, Acc 0.569
Round  23, Average loss 2.196, Acc 0.573
Round  24, Average loss 3.158, Acc 0.724
Round  25, Average loss 1.901, Acc 0.648
Round  26, Average loss 1.299, Acc 0.582
Round  27, Average loss 1.451, Acc 0.759
Round  28, Average loss 1.583, Acc 0.751
Round  29, Average loss 1.675, Acc 0.763
Round  30, Average loss 1.319, Acc 0.764
Round  31, Average loss 1.343, Acc 0.915
Round  32, Average loss 0.753, Acc 0.753
Round  33, Average loss 1.613, Acc 0.743
Round  34, Average loss 1.193, Acc 0.755
Round  35, Average loss 1.108, Acc 0.940
Round  36, Average loss 1.260, Acc 0.920
Round  37, Average loss 0.632, Acc 0.371
Round  38, Average loss 1.723, Acc 0.922
0.01215
Round  39, Average loss 0.780, Acc 0.887
Round  40, Average loss 0.925, Acc 0.901
Round  41, Average loss 0.737, Acc 0.941
Round  42, Average loss 0.494, Acc 0.931
Round  43, Average loss 0.592, Acc 0.976
Round  44, Average loss 0.309, Acc 0.951
Round  45, Average loss 0.764, Acc 0.946
Round  46, Average loss 0.430, Acc 0.936
Round  47, Average loss 0.492, Acc 0.980
Round  48, Average loss 0.364, Acc 0.955
Round  49, Average loss 0.190, Acc 0.753
Round  50, Average loss 0.773, Acc 0.764
Round  51, Average loss 0.706, Acc 0.764
Round  52, Average loss 0.786, Acc 0.940
Round  53, Average loss 0.604, Acc 0.939
Round  54, Average loss 0.592, Acc 0.755
Round  55, Average loss 1.710, Acc 0.928
Round  56, Average loss 0.627, Acc 0.940
Round  57, Average loss 0.386, Acc 0.754
Round  58, Average loss 0.636, Acc 0.943
0.010935
Round  59, Average loss 0.435, Acc 0.978
Round  60, Average loss 0.241, Acc 0.976
Round  61, Average loss 0.151, Acc 0.968
Round  62, Average loss 0.302, Acc 0.980
Round  63, Average loss 0.175, Acc 0.942
Round  64, Average loss 0.414, Acc 0.918
Round  65, Average loss 0.396, Acc 0.965
Round  66, Average loss 0.257, Acc 0.928
Round  67, Average loss 0.612, Acc 0.411
Round  68, Average loss 1.100, Acc 0.963
Round  69, Average loss 0.443, Acc 0.943
Round  70, Average loss 0.378, Acc 0.919
Round  71, Average loss 0.537, Acc 0.978
Round  72, Average loss 0.180, Acc 0.958
Round  73, Average loss 0.376, Acc 0.941
Round  74, Average loss 0.323, Acc 0.940
Round  75, Average loss 0.455, Acc 0.928
Round  76, Average loss 0.433, Acc 0.977
Round  77, Average loss 0.227, Acc 0.940
Round  78, Average loss 0.377, Acc 0.957
0.009841500000000001
Round  79, Average loss 0.382, Acc 0.963
Round  80, Average loss 0.446, Acc 0.966
Round  81, Average loss 0.275, Acc 0.978
Round  82, Average loss 0.224, Acc 0.397
Round  83, Average loss 1.531, Acc 0.952
Round  84, Average loss 0.410, Acc 0.980
Round  85, Average loss 0.366, Acc 0.981
Round  86, Average loss 0.291, Acc 0.974
Round  87, Average loss 0.325, Acc 0.971
Round  88, Average loss 0.384, Acc 0.969
Round  89, Average loss 0.372, Acc 0.970
Round  90, Average loss 0.336, Acc 0.958
Round  91, Average loss 0.636, Acc 0.967
Round  92, Average loss 0.313, Acc 0.965
Round  93, Average loss 0.586, Acc 0.950
Round  94, Average loss 0.451, Acc 0.968
Round  95, Average loss 0.333, Acc 0.955
Round  96, Average loss 0.391, Acc 0.967
Round  97, Average loss 0.331, Acc 0.959
Round  98, Average loss 0.405, Acc 0.956
0.008857350000000002
Round  99, Average loss 0.294, Acc 0.927
Round 100, Average loss 1.125, Acc 0.964
Round 101, Average loss 0.403, Acc 0.968
Round 102, Average loss 0.275, Acc 0.967
Round 103, Average loss 0.225, Acc 0.965
Round 104, Average loss 0.261, Acc 0.933
Round 105, Average loss 0.404, Acc 0.956
Round 106, Average loss 0.297, Acc 0.964
Round 107, Average loss 0.322, Acc 0.950
Round 108, Average loss 0.492, Acc 0.956
Round 109, Average loss 0.343, Acc 0.938
Round 110, Average loss 0.666, Acc 0.955
Round 111, Average loss 0.495, Acc 0.965
Round 112, Average loss 0.404, Acc 0.955
Round 113, Average loss 0.402, Acc 0.925
Round 114, Average loss 0.507, Acc 0.954
Round 115, Average loss 0.324, Acc 0.383
Round 116, Average loss 0.993, Acc 0.941
Round 117, Average loss 0.441, Acc 0.939
Round 118, Average loss 0.423, Acc 0.926
0.007971615000000001
Round 119, Average loss 0.491, Acc 0.933
Round 120, Average loss 0.415, Acc 0.924
Round 121, Average loss 0.487, Acc 0.941
Round 122, Average loss 0.348, Acc 0.926
Round 123, Average loss 0.357, Acc 0.938
Round 124, Average loss 0.489, Acc 0.941
Round 125, Average loss 0.521, Acc 0.956
Round 126, Average loss 0.420, Acc 0.945
Round 127, Average loss 0.532, Acc 0.954
Round 128, Average loss 0.397, Acc 0.936
Round 129, Average loss 0.596, Acc 0.937
Round 130, Average loss 0.496, Acc 0.917
Round 131, Average loss 0.620, Acc 0.935
Round 132, Average loss 0.458, Acc 0.916
Round 133, Average loss 0.570, Acc 0.920
Round 134, Average loss 0.497, Acc 0.918
Round 135, Average loss 0.516, Acc 0.924
Round 136, Average loss 0.633, Acc 0.920
Round 137, Average loss 0.490, Acc 0.907
Round 138, Average loss 0.601, Acc 0.918
0.007174453500000001
Round 139, Average loss 0.440, Acc 0.956
Round 140, Average loss 0.352, Acc 0.916
Round 141, Average loss 0.706, Acc 0.958
Round 142, Average loss 0.380, Acc 0.954
Round 143, Average loss 0.365, Acc 0.928
Round 144, Average loss 0.391, Acc 0.843
Round 145, Average loss 0.836, Acc 0.929
Round 146, Average loss 0.534, Acc 0.925
Round 147, Average loss 0.482, Acc 0.871
Round 148, Average loss 0.719, Acc 0.927
Round 149, Average loss 0.569, Acc 0.926
Round 150, Average loss 0.639, Acc 0.942
Round 151, Average loss 0.487, Acc 0.958
Round 152, Average loss 0.466, Acc 0.903
Round 153, Average loss 0.545, Acc 0.925
Round 154, Average loss 0.429, Acc 0.927
Round 155, Average loss 0.319, Acc 0.944
Round 156, Average loss 0.340, Acc 0.959
Round 157, Average loss 0.244, Acc 0.966
Round 158, Average loss 0.198, Acc 0.944
0.006457008150000001
Round 159, Average loss 0.365, Acc 0.935
Round 160, Average loss 0.528, Acc 0.876
Round 161, Average loss 0.677, Acc 0.927
Round 162, Average loss 0.592, Acc 0.933
Round 163, Average loss 0.529, Acc 0.873
Round 164, Average loss 0.779, Acc 0.929
Round 165, Average loss 0.519, Acc 0.873
Round 166, Average loss 0.786, Acc 0.930
Round 167, Average loss 0.530, Acc 0.923
Round 168, Average loss 0.607, Acc 0.929
Round 169, Average loss 0.501, Acc 0.851
Round 170, Average loss 0.846, Acc 0.877
Round 171, Average loss 0.768, Acc 0.871
Round 172, Average loss 0.918, Acc 0.878
Round 173, Average loss 0.690, Acc 0.875
Round 174, Average loss 0.736, Acc 0.875
Round 175, Average loss 0.871, Acc 0.888
Round 176, Average loss 0.732, Acc 0.920
Round 177, Average loss 0.572, Acc 0.926
Round 178, Average loss 0.641, Acc 0.930
0.005811307335000002
Round 179, Average loss 0.557, Acc 0.917
Round 180, Average loss 0.814, Acc 0.911
Round 181, Average loss 0.707, Acc 0.878
Round 182, Average loss 0.781, Acc 0.894
Round 183, Average loss 0.607, Acc 0.909
Round 184, Average loss 0.790, Acc 0.930
Round 185, Average loss 0.630, Acc 0.928
Round 186, Average loss 0.660, Acc 0.932
Round 187, Average loss 0.595, Acc 0.932
Round 188, Average loss 0.576, Acc 0.934
Round 189, Average loss 0.461, Acc 0.931
Round 190, Average loss 0.487, Acc 0.932
Round 191, Average loss 0.540, Acc 0.932
Round 192, Average loss 0.540, Acc 0.930
Round 193, Average loss 0.725, Acc 0.932
Round 194, Average loss 0.646, Acc 0.934
Round 195, Average loss 0.589, Acc 0.932
Round 196, Average loss 0.683, Acc 0.932
Round 197, Average loss 0.546, Acc 0.933
Round 198, Average loss 0.580, Acc 0.926
0.005230176601500001
Round 199, Average loss 0.690, Acc 0.927
Round 200, Average loss 0.558, Acc 0.934
Round 201, Average loss 0.490, Acc 0.938
Round 202, Average loss 0.575, Acc 0.937
Round 203, Average loss 0.465, Acc 0.939
Round 204, Average loss 0.429, Acc 0.932
Round 205, Average loss 0.480, Acc 0.955
Round 206, Average loss 0.383, Acc 0.960
Round 207, Average loss 0.474, Acc 0.961
Round 208, Average loss 0.413, Acc 0.966
Round 209, Average loss 0.448, Acc 0.969
Round 210, Average loss 0.291, Acc 0.938
Round 211, Average loss 0.852, Acc 0.975
Round 212, Average loss 0.267, Acc 0.376
Round 213, Average loss 0.974, Acc 0.784
Round 214, Average loss 0.669, Acc 0.919
Round 215, Average loss 0.676, Acc 0.822
Round 216, Average loss 0.663, Acc 0.966
Round 217, Average loss 0.430, Acc 0.379
Round 218, Average loss 1.792, Acc 0.770
0.004707158941350001
Round 219, Average loss 0.773, Acc 0.969
Round 220, Average loss 0.392, Acc 0.974
Round 221, Average loss 0.382, Acc 0.929
Round 222, Average loss 0.652, Acc 0.954
Round 223, Average loss 0.435, Acc 0.953
Round 224, Average loss 0.348, Acc 0.927
Round 225, Average loss 0.474, Acc 0.969
Round 226, Average loss 0.293, Acc 0.950
Round 227, Average loss 0.438, Acc 0.955
Round 228, Average loss 0.356, Acc 0.958
Round 229, Average loss 0.442, Acc 0.959
Round 230, Average loss 0.301, Acc 0.958
Round 231, Average loss 0.321, Acc 0.934
Round 232, Average loss 0.711, Acc 0.957
Round 233, Average loss 0.414, Acc 0.975
Round 234, Average loss 0.428, Acc 0.959
Round 235, Average loss 0.292, Acc 0.967
Round 236, Average loss 0.418, Acc 0.957
Round 237, Average loss 0.411, Acc 0.955
Round 238, Average loss 0.479, Acc 0.959
0.004236443047215001
Round 239, Average loss 0.399, Acc 0.966
Round 240, Average loss 0.341, Acc 0.974
Round 241, Average loss 0.301, Acc 0.954
Round 242, Average loss 0.574, Acc 0.977
Round 243, Average loss 0.487, Acc 0.977
Round 244, Average loss 0.459, Acc 0.978
Round 245, Average loss 0.567, Acc 0.957
Round 246, Average loss 0.553, Acc 0.927
Round 247, Average loss 0.625, Acc 0.959
Round 248, Average loss 0.566, Acc 0.968
Round 249, Average loss 0.483, Acc 0.967
Round 250, Average loss 0.588, Acc 0.966
Round 251, Average loss 0.445, Acc 0.968
Round 252, Average loss 0.420, Acc 0.966
Round 253, Average loss 0.496, Acc 0.967
Round 254, Average loss 0.495, Acc 0.961
Round 255, Average loss 0.633, Acc 0.952
Round 256, Average loss 0.430, Acc 0.940
Round 257, Average loss 0.718, Acc 0.950
Round 258, Average loss 0.553, Acc 0.308
0.003812798742493501
Round 259, Average loss 1.511, Acc 0.806
Round 260, Average loss 0.793, Acc 0.360
Round 261, Average loss 2.612, Acc 0.836
Round 262, Average loss 0.692, Acc 0.382
Round 263, Average loss 0.950, Acc 0.794
Round 264, Average loss 0.702, Acc 0.907
Round 265, Average loss 0.802, Acc 0.855
Round 266, Average loss 0.767, Acc 0.945
Round 267, Average loss 0.482, Acc 0.954
Round 268, Average loss 0.405, Acc 0.929
Round 269, Average loss 0.887, Acc 0.929
Round 270, Average loss 0.521, Acc 0.942
Round 271, Average loss 0.583, Acc 0.920
Round 272, Average loss 1.161, Acc 0.949
Round 273, Average loss 0.585, Acc 0.409
Round 274, Average loss 1.164, Acc 0.958
Round 275, Average loss 0.597, Acc 0.947
Round 276, Average loss 0.601, Acc 0.908
Round 277, Average loss 0.597, Acc 0.927
Round 278, Average loss 0.612, Acc 0.978
0.003431518868244151
Round 279, Average loss 0.515, Acc 0.928
Round 280, Average loss 0.649, Acc 0.869
Round 281, Average loss 0.693, Acc 0.968
Round 282, Average loss 0.608, Acc 0.972
Round 283, Average loss 0.555, Acc 0.932
Round 284, Average loss 0.618, Acc 0.958
Round 285, Average loss 0.602, Acc 0.979
Round 286, Average loss 0.295, Acc 0.975
Round 287, Average loss 0.473, Acc 0.979
Round 288, Average loss 0.577, Acc 0.937
Round 289, Average loss 0.609, Acc 0.977
Round 290, Average loss 0.524, Acc 0.979
Round 291, Average loss 0.344, Acc 0.956
Round 292, Average loss 0.589, Acc 0.974
Round 293, Average loss 0.403, Acc 0.978
Round 294, Average loss 0.470, Acc 0.966
Round 295, Average loss 0.387, Acc 0.965
Round 296, Average loss 0.474, Acc 0.975
Round 297, Average loss 0.497, Acc 0.960
Round 298, Average loss 0.514, Acc 0.927
0.0030883669814197362
Round 299, Average loss 0.543, Acc 0.976
144.4367241859436 s
Memory used: 1668.36 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=10, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.9024342] and score 2 is 0.0
Round   0, Average loss 3.086, Acc 0.003
score 1 is [0.8821212] and score 2 is 0.0
Round   1, Average loss 3.077, Acc 0.003
score 1 is [0.8910729] and score 2 is 0.0
Round   2, Average loss 3.077, Acc 0.003
score 1 is [0.933974] and score 2 is 0.0
Round   3, Average loss 3.083, Acc 0.003
score 1 is [0.88507897] and score 2 is 0.0
Round   4, Average loss 3.079, Acc 0.003
9.983819484710693 s
Memory used: 1669.17 MB

2e-1 + 20
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=20, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.117, Acc 0.569
Round   1, Average loss 2.565, Acc 0.569
Round   2, Average loss 1.617, Acc 0.569
Round   3, Average loss 1.274, Acc 0.569
Round   4, Average loss 1.091, Acc 0.569
Round   5, Average loss 0.933, Acc 0.569
Round   6, Average loss 0.813, Acc 0.963
Round   7, Average loss 0.583, Acc 0.801
Round   8, Average loss 0.495, Acc 0.789
Round   9, Average loss 0.493, Acc 0.959
Round  10, Average loss 0.646, Acc 0.891
Round  11, Average loss 0.349, Acc 0.935
Round  12, Average loss 0.303, Acc 0.979
Round  13, Average loss 0.244, Acc 0.970
Round  14, Average loss 0.149, Acc 0.959
Round  15, Average loss 0.223, Acc 0.971
Round  16, Average loss 0.219, Acc 0.964
Round  17, Average loss 0.228, Acc 0.978
Round  18, Average loss 0.420, Acc 0.938
0.0135
Round  19, Average loss 0.335, Acc 0.971
Round  20, Average loss 0.206, Acc 0.411
Round  21, Average loss 1.857, Acc 0.948
Round  22, Average loss 0.244, Acc 0.926
Round  23, Average loss 0.653, Acc 0.966
Round  24, Average loss 0.198, Acc 0.411
Round  25, Average loss 1.317, Acc 0.955
Round  26, Average loss 0.275, Acc 0.978
Round  27, Average loss 0.504, Acc 0.955
Round  28, Average loss 0.269, Acc 0.412
Round  29, Average loss 1.775, Acc 0.857
Round  30, Average loss 0.577, Acc 0.968
Round  31, Average loss 0.310, Acc 0.940
Round  32, Average loss 0.297, Acc 0.978
Round  33, Average loss 0.296, Acc 0.935
Round  34, Average loss 0.454, Acc 0.970
Round  35, Average loss 0.233, Acc 0.949
Round  36, Average loss 0.269, Acc 0.956
Round  37, Average loss 0.332, Acc 0.932
Round  38, Average loss 0.377, Acc 0.930
0.01215
Round  39, Average loss 0.339, Acc 0.968
Round  40, Average loss 0.245, Acc 0.969
Round  41, Average loss 0.112, Acc 0.412
Round  42, Average loss 2.224, Acc 0.947
Round  43, Average loss 0.267, Acc 0.978
Round  44, Average loss 0.232, Acc 0.953
Round  45, Average loss 0.222, Acc 0.412
Round  46, Average loss 0.949, Acc 0.951
Round  47, Average loss 0.224, Acc 0.966
Round  48, Average loss 0.209, Acc 0.413
Round  49, Average loss 3.537, Acc 0.945
Round  50, Average loss 0.258, Acc 0.979
Round  51, Average loss 0.127, Acc 0.968
Round  52, Average loss 0.181, Acc 0.412
Round  53, Average loss 2.005, Acc 0.964
Round  54, Average loss 0.224, Acc 0.372
Round  55, Average loss 2.987, Acc 0.967
Round  56, Average loss 0.218, Acc 0.396
Round  57, Average loss 2.790, Acc 0.964
Round  58, Average loss 0.239, Acc 0.979
0.010935
Round  59, Average loss 0.237, Acc 0.968
Round  60, Average loss 0.187, Acc 0.403
Round  61, Average loss 1.994, Acc 0.971
Round  62, Average loss 0.177, Acc 0.959
Round  63, Average loss 0.446, Acc 0.967
Round  64, Average loss 0.306, Acc 0.976
Round  65, Average loss 0.210, Acc 0.974
Round  66, Average loss 0.304, Acc 0.945
Round  67, Average loss 0.504, Acc 0.973
Round  68, Average loss 0.246, Acc 0.974
Round  69, Average loss 0.316, Acc 0.980
Round  70, Average loss 0.360, Acc 0.973
Round  71, Average loss 0.172, Acc 0.981
Round  72, Average loss 0.377, Acc 0.366
Round  73, Average loss 2.455, Acc 0.982
Round  74, Average loss 0.347, Acc 0.807
Round  75, Average loss 0.444, Acc 0.978
Round  76, Average loss 0.324, Acc 0.951
Round  77, Average loss 0.277, Acc 0.979
Round  78, Average loss 0.273, Acc 0.964
0.009841500000000001
Round  79, Average loss 0.363, Acc 0.981
Round  80, Average loss 0.218, Acc 0.978
Round  81, Average loss 0.231, Acc 0.981
Round  82, Average loss 0.308, Acc 0.413
Round  83, Average loss 3.345, Acc 0.759
Round  84, Average loss 0.469, Acc 0.977
Round  85, Average loss 0.118, Acc 0.979
Round  86, Average loss 0.240, Acc 0.969
Round  87, Average loss 0.324, Acc 0.981
Round  88, Average loss 0.171, Acc 0.974
Round  89, Average loss 0.174, Acc 0.981
Round  90, Average loss 0.217, Acc 0.955
Round  91, Average loss 0.240, Acc 0.972
Round  92, Average loss 0.374, Acc 0.966
Round  93, Average loss 0.227, Acc 0.980
Round  94, Average loss 0.278, Acc 0.961
Round  95, Average loss 0.263, Acc 0.971
Round  96, Average loss 0.242, Acc 0.959
Round  97, Average loss 0.187, Acc 0.976
Round  98, Average loss 0.274, Acc 0.969
0.008857350000000002
Round  99, Average loss 0.247, Acc 0.980
Round 100, Average loss 0.235, Acc 0.948
Round 101, Average loss 0.348, Acc 0.978
Round 102, Average loss 0.265, Acc 0.967
Round 103, Average loss 0.333, Acc 0.980
Round 104, Average loss 0.250, Acc 0.964
Round 105, Average loss 0.325, Acc 0.961
Round 106, Average loss 0.191, Acc 0.966
Round 107, Average loss 0.353, Acc 0.981
Round 108, Average loss 0.213, Acc 0.974
Round 109, Average loss 0.414, Acc 0.981
Round 110, Average loss 0.337, Acc 0.980
Round 111, Average loss 0.274, Acc 0.975
Round 112, Average loss 0.328, Acc 0.978
Round 113, Average loss 0.270, Acc 0.971
Round 114, Average loss 0.204, Acc 0.974
Round 115, Average loss 0.276, Acc 0.977
Round 116, Average loss 0.323, Acc 0.971
Round 117, Average loss 0.377, Acc 0.431
Round 118, Average loss 1.770, Acc 0.959
0.007971615000000001
Round 119, Average loss 0.322, Acc 0.411
Round 120, Average loss 3.490, Acc 0.961
Round 121, Average loss 0.508, Acc 0.963
Round 122, Average loss 0.307, Acc 0.975
Round 123, Average loss 0.364, Acc 0.976
Round 124, Average loss 0.330, Acc 0.980
Round 125, Average loss 0.426, Acc 0.980
Round 126, Average loss 0.260, Acc 0.955
Round 127, Average loss 0.295, Acc 0.979
Round 128, Average loss 0.334, Acc 0.972
Round 129, Average loss 0.285, Acc 0.942
Round 130, Average loss 0.495, Acc 0.977
Round 131, Average loss 0.284, Acc 0.947
Round 132, Average loss 0.391, Acc 0.448
Round 133, Average loss 0.775, Acc 0.415
Round 134, Average loss 2.992, Acc 0.867
Round 135, Average loss 0.793, Acc 0.410
Round 136, Average loss 4.020, Acc 0.370
Round 137, Average loss 3.209, Acc 0.922
Round 138, Average loss 0.523, Acc 0.405
0.007174453500000001
Round 139, Average loss 9.671, Acc 0.379
Round 140, Average loss 5.847, Acc 0.899
Round 141, Average loss 1.012, Acc 0.900
Round 142, Average loss 1.139, Acc 0.374
Round 143, Average loss 4.462, Acc 0.905
Round 144, Average loss 1.251, Acc 0.914
Round 145, Average loss 0.940, Acc 0.403
Round 146, Average loss 3.200, Acc 0.918
Round 147, Average loss 0.743, Acc 0.386
Round 148, Average loss 3.735, Acc 0.924
Round 149, Average loss 0.700, Acc 0.401
Round 150, Average loss 5.903, Acc 0.941
Round 151, Average loss 0.462, Acc 0.433
Round 152, Average loss 1.966, Acc 0.939
Round 153, Average loss 0.701, Acc 0.972
Round 154, Average loss 0.332, Acc 0.449
Round 155, Average loss 0.891, Acc 0.972
Round 156, Average loss 0.380, Acc 0.978
Round 157, Average loss 0.421, Acc 0.975
Round 158, Average loss 0.405, Acc 0.975
0.006457008150000001
Round 159, Average loss 0.397, Acc 0.979
Round 160, Average loss 0.296, Acc 0.974
Round 161, Average loss 0.299, Acc 0.979
Round 162, Average loss 0.413, Acc 0.979
Round 163, Average loss 0.393, Acc 0.978
Round 164, Average loss 0.333, Acc 0.434
Round 165, Average loss 2.068, Acc 0.975
Round 166, Average loss 0.574, Acc 0.448
Round 167, Average loss 0.927, Acc 0.967
Round 168, Average loss 0.449, Acc 0.979
Round 169, Average loss 0.502, Acc 0.976
Round 170, Average loss 0.234, Acc 0.979
Round 171, Average loss 0.357, Acc 0.977
Round 172, Average loss 0.293, Acc 0.978
Round 173, Average loss 0.519, Acc 0.974
Round 174, Average loss 0.521, Acc 0.980
Round 175, Average loss 0.275, Acc 0.976
Round 176, Average loss 0.503, Acc 0.979
Round 177, Average loss 0.299, Acc 0.977
Round 178, Average loss 0.581, Acc 0.968
0.005811307335000002
Round 179, Average loss 0.619, Acc 0.978
Round 180, Average loss 0.447, Acc 0.977
Round 181, Average loss 0.456, Acc 0.976
Round 182, Average loss 0.530, Acc 0.980
Round 183, Average loss 0.263, Acc 0.979
Round 184, Average loss 0.446, Acc 0.978
Round 185, Average loss 0.411, Acc 0.980
Round 186, Average loss 0.431, Acc 0.980
Round 187, Average loss 0.480, Acc 0.979
Round 188, Average loss 0.330, Acc 0.974
Round 189, Average loss 0.607, Acc 0.979
Round 190, Average loss 0.485, Acc 0.974
Round 191, Average loss 0.449, Acc 0.978
Round 192, Average loss 0.400, Acc 0.975
Round 193, Average loss 0.563, Acc 0.979
Round 194, Average loss 0.412, Acc 0.974
Round 195, Average loss 0.459, Acc 0.978
Round 196, Average loss 0.268, Acc 0.974
Round 197, Average loss 0.372, Acc 0.979
Round 198, Average loss 0.515, Acc 0.975
0.005230176601500001
Round 199, Average loss 0.370, Acc 0.979
Round 200, Average loss 0.371, Acc 0.974
Round 201, Average loss 0.329, Acc 0.979
Round 202, Average loss 0.433, Acc 0.977
Round 203, Average loss 0.267, Acc 0.979
Round 204, Average loss 0.392, Acc 0.976
Round 205, Average loss 0.577, Acc 0.979
Round 206, Average loss 0.573, Acc 0.980
Round 207, Average loss 0.261, Acc 0.978
Round 208, Average loss 0.284, Acc 0.979
Round 209, Average loss 0.422, Acc 0.979
Round 210, Average loss 0.458, Acc 0.411
Round 211, Average loss 5.366, Acc 0.446
Round 212, Average loss 1.215, Acc 0.867
Round 213, Average loss 0.793, Acc 0.446
Round 214, Average loss 1.120, Acc 0.898
Round 215, Average loss 0.638, Acc 0.437
Round 216, Average loss 1.652, Acc 0.953
Round 217, Average loss 0.475, Acc 0.442
Round 218, Average loss 1.242, Acc 0.950
0.004707158941350001
Round 219, Average loss 0.495, Acc 0.969
Round 220, Average loss 0.504, Acc 0.975
Round 221, Average loss 0.572, Acc 0.967
Round 222, Average loss 0.449, Acc 0.976
Round 223, Average loss 0.411, Acc 0.979
Round 224, Average loss 0.583, Acc 0.977
Round 225, Average loss 0.396, Acc 0.979
Round 226, Average loss 0.196, Acc 0.978
Round 227, Average loss 0.445, Acc 0.978
Round 228, Average loss 0.488, Acc 0.979
Round 229, Average loss 0.467, Acc 0.976
Round 230, Average loss 0.386, Acc 0.978
Round 231, Average loss 0.388, Acc 0.979
Round 232, Average loss 0.322, Acc 0.980
Round 233, Average loss 0.375, Acc 0.980
Round 234, Average loss 0.462, Acc 0.980
Round 235, Average loss 0.243, Acc 0.977
Round 236, Average loss 0.395, Acc 0.980
Round 237, Average loss 0.260, Acc 0.980
Round 238, Average loss 0.431, Acc 0.978
0.004236443047215001
Round 239, Average loss 0.273, Acc 0.978
Round 240, Average loss 0.315, Acc 0.974
Round 241, Average loss 0.482, Acc 0.974
Round 242, Average loss 0.366, Acc 0.977
Round 243, Average loss 0.367, Acc 0.978
Round 244, Average loss 0.429, Acc 0.976
Round 245, Average loss 0.396, Acc 0.979
Round 246, Average loss 0.382, Acc 0.975
Round 247, Average loss 0.280, Acc 0.976
Round 248, Average loss 0.532, Acc 0.978
Round 249, Average loss 0.295, Acc 0.980
Round 250, Average loss 0.335, Acc 0.978
Round 251, Average loss 0.347, Acc 0.976
Round 252, Average loss 0.411, Acc 0.972
Round 253, Average loss 0.281, Acc 0.976
Round 254, Average loss 0.488, Acc 0.979
Round 255, Average loss 0.257, Acc 0.977
Round 256, Average loss 0.519, Acc 0.978
Round 257, Average loss 0.494, Acc 0.977
Round 258, Average loss 0.313, Acc 0.979
0.003812798742493501
Round 259, Average loss 0.448, Acc 0.980
Round 260, Average loss 0.370, Acc 0.979
Round 261, Average loss 0.234, Acc 0.977
Round 262, Average loss 0.327, Acc 0.978
Round 263, Average loss 0.477, Acc 0.976
Round 264, Average loss 0.430, Acc 0.979
Round 265, Average loss 0.308, Acc 0.973
Round 266, Average loss 0.552, Acc 0.974
Round 267, Average loss 0.311, Acc 0.977
Round 268, Average loss 0.241, Acc 0.979
Round 269, Average loss 0.387, Acc 0.977
Round 270, Average loss 0.411, Acc 0.980
Round 271, Average loss 0.254, Acc 0.979
Round 272, Average loss 0.470, Acc 0.980
Round 273, Average loss 0.350, Acc 0.976
Round 274, Average loss 0.314, Acc 0.980
Round 275, Average loss 0.286, Acc 0.980
Round 276, Average loss 0.463, Acc 0.980
Round 277, Average loss 0.397, Acc 0.980
Round 278, Average loss 0.393, Acc 0.980
0.003431518868244151
Round 279, Average loss 0.383, Acc 0.980
Round 280, Average loss 0.481, Acc 0.979
Round 281, Average loss 0.342, Acc 0.978
Round 282, Average loss 0.307, Acc 0.979
Round 283, Average loss 0.353, Acc 0.976
Round 284, Average loss 0.346, Acc 0.979
Round 285, Average loss 0.415, Acc 0.980
Round 286, Average loss 0.326, Acc 0.979
Round 287, Average loss 0.424, Acc 0.979
Round 288, Average loss 0.401, Acc 0.979
Round 289, Average loss 0.190, Acc 0.979
Round 290, Average loss 0.385, Acc 0.980
Round 291, Average loss 0.383, Acc 0.980
Round 292, Average loss 0.284, Acc 0.981
Round 293, Average loss 0.166, Acc 0.980
Round 294, Average loss 0.345, Acc 0.981
Round 295, Average loss 0.278, Acc 0.981
Round 296, Average loss 0.305, Acc 0.981
Round 297, Average loss 0.363, Acc 0.980
Round 298, Average loss 0.526, Acc 0.981
0.0030883669814197362
Round 299, Average loss 0.355, Acc 0.980
165.06910848617554 s
Memory used: 1674.45 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=20, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.8601955] and score 2 is 0.0
Round   0, Average loss 3.338, Acc 0.000
score 1 is [0.93792605] and score 2 is 0.0
Round   1, Average loss 3.338, Acc 0.000
score 1 is [0.9502663] and score 2 is 0.0
Round   2, Average loss 3.172, Acc 0.000
score 1 is [0.8748612] and score 2 is 0.0
Round   3, Average loss 3.171, Acc 0.000
score 1 is [0.86535573] and score 2 is 0.0
Round   4, Average loss 3.157, Acc 0.000
10.53950309753418 s
Memory used: 1682.61 MB

2e-1 + 30
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=30, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.091, Acc 0.569
Round   1, Average loss 2.558, Acc 0.569
Round   2, Average loss 1.542, Acc 0.569
Round   3, Average loss 1.110, Acc 0.569
Round   4, Average loss 0.991, Acc 0.736
Round   5, Average loss 0.846, Acc 0.744
Round   6, Average loss 0.648, Acc 0.978
Round   7, Average loss 0.720, Acc 0.790
Round   8, Average loss 0.604, Acc 0.846
Round   9, Average loss 0.573, Acc 0.896
Round  10, Average loss 0.595, Acc 0.960
Round  11, Average loss 0.420, Acc 0.413
Round  12, Average loss 2.272, Acc 0.931
Round  13, Average loss 0.309, Acc 0.942
Round  14, Average loss 0.568, Acc 0.876
Round  15, Average loss 0.456, Acc 0.981
Round  16, Average loss 0.242, Acc 0.937
Round  17, Average loss 0.233, Acc 0.931
Round  18, Average loss 0.259, Acc 0.979
0.0135
Round  19, Average loss 0.206, Acc 0.969
Round  20, Average loss 0.143, Acc 0.964
Round  21, Average loss 0.159, Acc 0.953
Round  22, Average loss 0.293, Acc 0.969
Round  23, Average loss 0.520, Acc 0.927
Round  24, Average loss 0.303, Acc 0.970
Round  25, Average loss 0.303, Acc 0.929
Round  26, Average loss 0.360, Acc 0.966
Round  27, Average loss 0.261, Acc 0.976
Round  28, Average loss 0.245, Acc 0.952
Round  29, Average loss 0.228, Acc 0.971
Round  30, Average loss 0.253, Acc 0.969
Round  31, Average loss 0.185, Acc 0.940
Round  32, Average loss 0.493, Acc 0.968
Round  33, Average loss 0.248, Acc 0.840
Round  34, Average loss 0.375, Acc 0.981
Round  35, Average loss 0.181, Acc 0.933
Round  36, Average loss 0.329, Acc 0.968
Round  37, Average loss 0.192, Acc 0.971
Round  38, Average loss 0.169, Acc 0.981
0.01215
Round  39, Average loss 0.190, Acc 0.967
Round  40, Average loss 0.142, Acc 0.981
Round  41, Average loss 0.155, Acc 0.965
Round  42, Average loss 0.122, Acc 0.981
Round  43, Average loss 0.109, Acc 0.967
Round  44, Average loss 0.155, Acc 0.981
Round  45, Average loss 0.150, Acc 0.975
Round  46, Average loss 0.091, Acc 0.981
Round  47, Average loss 0.133, Acc 0.981
Round  48, Average loss 0.119, Acc 0.966
Round  49, Average loss 0.120, Acc 0.982
Round  50, Average loss 0.131, Acc 0.982
Round  51, Average loss 0.123, Acc 0.981
Round  52, Average loss 0.189, Acc 0.968
Round  53, Average loss 0.243, Acc 0.969
Round  54, Average loss 0.149, Acc 0.980
Round  55, Average loss 0.199, Acc 0.752
Round  56, Average loss 0.368, Acc 0.966
Round  57, Average loss 0.182, Acc 0.967
Round  58, Average loss 0.135, Acc 0.980
0.010935
Round  59, Average loss 0.084, Acc 0.975
Round  60, Average loss 0.132, Acc 0.975
Round  61, Average loss 0.215, Acc 0.981
Round  62, Average loss 0.109, Acc 0.978
Round  63, Average loss 0.231, Acc 0.979
Round  64, Average loss 0.169, Acc 0.980
Round  65, Average loss 0.169, Acc 0.981
Round  66, Average loss 0.135, Acc 0.981
Round  67, Average loss 0.172, Acc 0.962
Round  68, Average loss 0.144, Acc 0.981
Round  69, Average loss 0.166, Acc 0.981
Round  70, Average loss 0.123, Acc 0.981
Round  71, Average loss 0.167, Acc 0.981
Round  72, Average loss 0.150, Acc 0.950
Round  73, Average loss 0.219, Acc 0.981
Round  74, Average loss 0.173, Acc 0.981
Round  75, Average loss 0.129, Acc 0.981
Round  76, Average loss 0.242, Acc 0.978
Round  77, Average loss 0.158, Acc 0.981
Round  78, Average loss 0.142, Acc 0.935
0.009841500000000001
Round  79, Average loss 0.460, Acc 0.979
Round  80, Average loss 0.131, Acc 0.938
Round  81, Average loss 0.257, Acc 0.980
Round  82, Average loss 0.120, Acc 0.939
Round  83, Average loss 0.241, Acc 0.981
Round  84, Average loss 0.102, Acc 0.981
Round  85, Average loss 0.149, Acc 0.804
Round  86, Average loss 0.351, Acc 0.980
Round  87, Average loss 0.087, Acc 0.962
Round  88, Average loss 0.183, Acc 0.981
Round  89, Average loss 0.154, Acc 0.938
Round  90, Average loss 0.254, Acc 0.977
Round  91, Average loss 0.147, Acc 0.976
Round  92, Average loss 0.148, Acc 0.981
Round  93, Average loss 0.121, Acc 0.981
Round  94, Average loss 0.100, Acc 0.981
Round  95, Average loss 0.184, Acc 0.980
Round  96, Average loss 0.157, Acc 0.981
Round  97, Average loss 0.114, Acc 0.981
Round  98, Average loss 0.140, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.118, Acc 0.980
Round 100, Average loss 0.130, Acc 0.980
Round 101, Average loss 0.142, Acc 0.980
Round 102, Average loss 0.099, Acc 0.980
Round 103, Average loss 0.091, Acc 0.981
Round 104, Average loss 0.084, Acc 0.979
Round 105, Average loss 0.132, Acc 0.980
Round 106, Average loss 0.119, Acc 0.981
Round 107, Average loss 0.128, Acc 0.981
Round 108, Average loss 0.123, Acc 0.981
Round 109, Average loss 0.148, Acc 0.980
Round 110, Average loss 0.228, Acc 0.981
Round 111, Average loss 0.107, Acc 0.981
Round 112, Average loss 0.119, Acc 0.978
Round 113, Average loss 0.148, Acc 0.978
Round 114, Average loss 0.113, Acc 0.981
Round 115, Average loss 0.103, Acc 0.981
Round 116, Average loss 0.170, Acc 0.981
Round 117, Average loss 0.137, Acc 0.980
Round 118, Average loss 0.121, Acc 0.981
0.007971615000000001
Round 119, Average loss 0.113, Acc 0.981
Round 120, Average loss 0.124, Acc 0.980
Round 121, Average loss 0.138, Acc 0.981
Round 122, Average loss 0.086, Acc 0.981
Round 123, Average loss 0.120, Acc 0.981
Round 124, Average loss 0.127, Acc 0.980
Round 125, Average loss 0.124, Acc 0.978
Round 126, Average loss 0.147, Acc 0.981
Round 127, Average loss 0.097, Acc 0.981
Round 128, Average loss 0.133, Acc 0.981
Round 129, Average loss 0.087, Acc 0.981
Round 130, Average loss 0.121, Acc 0.981
Round 131, Average loss 0.080, Acc 0.981
Round 132, Average loss 0.122, Acc 0.981
Round 133, Average loss 0.099, Acc 0.981
Round 134, Average loss 0.097, Acc 0.981
Round 135, Average loss 0.129, Acc 0.980
Round 136, Average loss 0.096, Acc 0.981
Round 137, Average loss 0.113, Acc 0.981
Round 138, Average loss 0.083, Acc 0.981
0.007174453500000001
Round 139, Average loss 0.090, Acc 0.981
Round 140, Average loss 0.112, Acc 0.981
Round 141, Average loss 0.086, Acc 0.981
Round 142, Average loss 0.090, Acc 0.979
Round 143, Average loss 0.134, Acc 0.980
Round 144, Average loss 0.133, Acc 0.981
Round 145, Average loss 0.117, Acc 0.981
Round 146, Average loss 0.116, Acc 0.981
Round 147, Average loss 0.108, Acc 0.981
Round 148, Average loss 0.117, Acc 0.981
Round 149, Average loss 0.145, Acc 0.980
Round 150, Average loss 0.130, Acc 0.980
Round 151, Average loss 0.090, Acc 0.981
Round 152, Average loss 0.114, Acc 0.980
Round 153, Average loss 0.133, Acc 0.981
Round 154, Average loss 0.102, Acc 0.981
Round 155, Average loss 0.167, Acc 0.981
Round 156, Average loss 0.113, Acc 0.981
Round 157, Average loss 0.085, Acc 0.981
Round 158, Average loss 0.099, Acc 0.981
0.006457008150000001
Round 159, Average loss 0.096, Acc 0.981
Round 160, Average loss 0.111, Acc 0.981
Round 161, Average loss 0.107, Acc 0.981
Round 162, Average loss 0.123, Acc 0.981
Round 163, Average loss 0.129, Acc 0.983
Round 164, Average loss 0.069, Acc 0.981
Round 165, Average loss 0.131, Acc 0.982
Round 166, Average loss 0.116, Acc 0.981
Round 167, Average loss 0.084, Acc 0.983
Round 168, Average loss 0.055, Acc 0.983
Round 169, Average loss 0.163, Acc 0.983
Round 170, Average loss 0.083, Acc 0.983
Round 171, Average loss 0.133, Acc 0.983
Round 172, Average loss 0.091, Acc 0.984
Round 173, Average loss 0.090, Acc 0.981
Round 174, Average loss 0.115, Acc 0.981
Round 175, Average loss 0.090, Acc 0.981
Round 176, Average loss 0.109, Acc 0.981
Round 177, Average loss 0.087, Acc 0.981
Round 178, Average loss 0.134, Acc 0.980
0.005811307335000002
Round 179, Average loss 0.115, Acc 0.981
Round 180, Average loss 0.065, Acc 0.981
Round 181, Average loss 0.135, Acc 0.983
Round 182, Average loss 0.093, Acc 0.983
Round 183, Average loss 0.077, Acc 0.982
Round 184, Average loss 0.082, Acc 0.983
Round 185, Average loss 0.090, Acc 0.984
Round 186, Average loss 0.088, Acc 0.982
Round 187, Average loss 0.071, Acc 0.983
Round 188, Average loss 0.128, Acc 0.983
Round 189, Average loss 0.108, Acc 0.983
Round 190, Average loss 0.092, Acc 0.984
Round 191, Average loss 0.084, Acc 0.983
Round 192, Average loss 0.087, Acc 0.983
Round 193, Average loss 0.162, Acc 0.984
Round 194, Average loss 0.114, Acc 0.983
Round 195, Average loss 0.106, Acc 0.980
Round 196, Average loss 0.122, Acc 0.983
Round 197, Average loss 0.054, Acc 0.981
Round 198, Average loss 0.080, Acc 0.981
0.005230176601500001
Round 199, Average loss 0.085, Acc 0.981
Round 200, Average loss 0.061, Acc 0.981
Round 201, Average loss 0.099, Acc 0.981
Round 202, Average loss 0.092, Acc 0.981
Round 203, Average loss 0.156, Acc 0.981
Round 204, Average loss 0.147, Acc 0.980
Round 205, Average loss 0.108, Acc 0.980
Round 206, Average loss 0.114, Acc 0.981
Round 207, Average loss 0.090, Acc 0.981
Round 208, Average loss 0.137, Acc 0.981
Round 209, Average loss 0.105, Acc 0.980
Round 210, Average loss 0.083, Acc 0.980
Round 211, Average loss 0.074, Acc 0.981
Round 212, Average loss 0.082, Acc 0.980
Round 213, Average loss 0.176, Acc 0.981
Round 214, Average loss 0.111, Acc 0.981
Round 215, Average loss 0.125, Acc 0.981
Round 216, Average loss 0.063, Acc 0.983
Round 217, Average loss 0.106, Acc 0.983
Round 218, Average loss 0.084, Acc 0.981
0.004707158941350001
Round 219, Average loss 0.108, Acc 0.983
Round 220, Average loss 0.075, Acc 0.980
Round 221, Average loss 0.122, Acc 0.983
Round 222, Average loss 0.115, Acc 0.983
Round 223, Average loss 0.076, Acc 0.983
Round 224, Average loss 0.136, Acc 0.983
Round 225, Average loss 0.094, Acc 0.983
Round 226, Average loss 0.107, Acc 0.983
Round 227, Average loss 0.093, Acc 0.983
Round 228, Average loss 0.102, Acc 0.982
Round 229, Average loss 0.090, Acc 0.983
Round 230, Average loss 0.124, Acc 0.983
Round 231, Average loss 0.142, Acc 0.983
Round 232, Average loss 0.063, Acc 0.983
Round 233, Average loss 0.081, Acc 0.983
Round 234, Average loss 0.079, Acc 0.983
Round 235, Average loss 0.115, Acc 0.983
Round 236, Average loss 0.153, Acc 0.983
Round 237, Average loss 0.135, Acc 0.983
Round 238, Average loss 0.106, Acc 0.982
0.004236443047215001
Round 239, Average loss 0.104, Acc 0.981
Round 240, Average loss 0.103, Acc 0.980
Round 241, Average loss 0.084, Acc 0.980
Round 242, Average loss 0.074, Acc 0.983
Round 243, Average loss 0.091, Acc 0.983
Round 244, Average loss 0.104, Acc 0.983
Round 245, Average loss 0.087, Acc 0.983
Round 246, Average loss 0.094, Acc 0.982
Round 247, Average loss 0.082, Acc 0.982
Round 248, Average loss 0.127, Acc 0.983
Round 249, Average loss 0.078, Acc 0.983
Round 250, Average loss 0.095, Acc 0.983
Round 251, Average loss 0.059, Acc 0.983
Round 252, Average loss 0.088, Acc 0.984
Round 253, Average loss 0.095, Acc 0.983
Round 254, Average loss 0.082, Acc 0.984
Round 255, Average loss 0.056, Acc 0.984
Round 256, Average loss 0.118, Acc 0.984
Round 257, Average loss 0.075, Acc 0.983
Round 258, Average loss 0.046, Acc 0.984
0.003812798742493501
Round 259, Average loss 0.091, Acc 0.983
Round 260, Average loss 0.100, Acc 0.983
Round 261, Average loss 0.125, Acc 0.983
Round 262, Average loss 0.113, Acc 0.984
Round 263, Average loss 0.090, Acc 0.984
Round 264, Average loss 0.097, Acc 0.984
Round 265, Average loss 0.164, Acc 0.984
Round 266, Average loss 0.100, Acc 0.983
Round 267, Average loss 0.091, Acc 0.983
Round 268, Average loss 0.080, Acc 0.984
Round 269, Average loss 0.067, Acc 0.984
Round 270, Average loss 0.088, Acc 0.984
Round 271, Average loss 0.110, Acc 0.983
Round 272, Average loss 0.069, Acc 0.983
Round 273, Average loss 0.096, Acc 0.981
Round 274, Average loss 0.136, Acc 0.983
Round 275, Average loss 0.076, Acc 0.982
Round 276, Average loss 0.090, Acc 0.983
Round 277, Average loss 0.132, Acc 0.982
Round 278, Average loss 0.099, Acc 0.983
0.003431518868244151
Round 279, Average loss 0.078, Acc 0.983
Round 280, Average loss 0.074, Acc 0.982
Round 281, Average loss 0.088, Acc 0.983
Round 282, Average loss 0.069, Acc 0.984
Round 283, Average loss 0.084, Acc 0.984
Round 284, Average loss 0.117, Acc 0.984
Round 285, Average loss 0.089, Acc 0.984
Round 286, Average loss 0.047, Acc 0.984
Round 287, Average loss 0.060, Acc 0.984
Round 288, Average loss 0.071, Acc 0.984
Round 289, Average loss 0.102, Acc 0.983
Round 290, Average loss 0.092, Acc 0.983
Round 291, Average loss 0.067, Acc 0.983
Round 292, Average loss 0.084, Acc 0.983
Round 293, Average loss 0.125, Acc 0.983
Round 294, Average loss 0.100, Acc 0.982
Round 295, Average loss 0.086, Acc 0.983
Round 296, Average loss 0.076, Acc 0.984
Round 297, Average loss 0.091, Acc 0.984
Round 298, Average loss 0.084, Acc 0.984
0.0030883669814197362
Round 299, Average loss 0.073, Acc 0.984
177.77221083641052 s
Memory used: 1679.03 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=30, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.9239242] and score 2 is 0.0
Round   0, Average loss 3.181, Acc 0.000
score 1 is [0.91569537] and score 2 is 0.0
Round   1, Average loss 3.179, Acc 0.000
score 1 is [0.8899866] and score 2 is 0.0
Round   2, Average loss 3.181, Acc 0.000
score 1 is [0.8772101] and score 2 is 0.0
Round   3, Average loss 3.143, Acc 0.000
score 1 is [0.72698045] and score 2 is 0.0
Round   4, Average loss 3.181, Acc 0.000
11.997417688369751 s
Memory used: 1673.36 MB

2e-1 + 40
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=40, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.075, Acc 0.569
Round   1, Average loss 2.652, Acc 0.569
Round   2, Average loss 1.643, Acc 0.569
Round   3, Average loss 0.962, Acc 0.569
Round   4, Average loss 0.994, Acc 0.744
Round   5, Average loss 0.879, Acc 0.569
Round   6, Average loss 0.840, Acc 0.786
Round   7, Average loss 0.854, Acc 0.744
Round   8, Average loss 0.769, Acc 0.788
Round   9, Average loss 0.753, Acc 0.743
Round  10, Average loss 0.864, Acc 0.844
Round  11, Average loss 0.624, Acc 0.801
Round  12, Average loss 0.678, Acc 0.786
Round  13, Average loss 0.511, Acc 0.939
Round  14, Average loss 0.647, Acc 0.786
Round  15, Average loss 0.509, Acc 0.972
Round  16, Average loss 0.536, Acc 0.786
Round  17, Average loss 0.510, Acc 0.944
Round  18, Average loss 0.477, Acc 0.789
0.0135
Round  19, Average loss 0.461, Acc 0.981
Round  20, Average loss 0.501, Acc 0.786
Round  21, Average loss 0.514, Acc 0.964
Round  22, Average loss 0.498, Acc 0.790
Round  23, Average loss 0.378, Acc 0.981
Round  24, Average loss 0.378, Acc 0.969
Round  25, Average loss 0.360, Acc 0.936
Round  26, Average loss 0.607, Acc 0.979
Round  27, Average loss 0.258, Acc 0.930
Round  28, Average loss 0.238, Acc 0.981
Round  29, Average loss 0.241, Acc 0.899
Round  30, Average loss 0.328, Acc 0.978
Round  31, Average loss 0.270, Acc 0.786
Round  32, Average loss 0.457, Acc 0.981
Round  33, Average loss 0.225, Acc 0.939
Round  34, Average loss 0.331, Acc 0.965
Round  35, Average loss 0.302, Acc 0.942
Round  36, Average loss 0.295, Acc 0.960
Round  37, Average loss 0.264, Acc 0.980
Round  38, Average loss 0.142, Acc 0.933
0.01215
Round  39, Average loss 0.240, Acc 0.979
Round  40, Average loss 0.192, Acc 0.973
Round  41, Average loss 0.172, Acc 0.981
Round  42, Average loss 0.126, Acc 0.960
Round  43, Average loss 0.306, Acc 0.978
Round  44, Average loss 0.126, Acc 0.981
Round  45, Average loss 0.309, Acc 0.976
Round  46, Average loss 0.107, Acc 0.980
Round  47, Average loss 0.114, Acc 0.948
Round  48, Average loss 0.277, Acc 0.979
Round  49, Average loss 0.113, Acc 0.979
Round  50, Average loss 0.130, Acc 0.982
Round  51, Average loss 0.096, Acc 0.982
Round  52, Average loss 0.123, Acc 0.981
Round  53, Average loss 0.146, Acc 0.981
Round  54, Average loss 0.100, Acc 0.974
Round  55, Average loss 0.110, Acc 0.973
Round  56, Average loss 0.146, Acc 0.981
Round  57, Average loss 0.197, Acc 0.979
Round  58, Average loss 0.196, Acc 0.982
0.010935
Round  59, Average loss 0.120, Acc 0.972
Round  60, Average loss 0.131, Acc 0.980
Round  61, Average loss 0.132, Acc 0.981
Round  62, Average loss 0.086, Acc 0.981
Round  63, Average loss 0.162, Acc 0.981
Round  64, Average loss 0.173, Acc 0.981
Round  65, Average loss 0.098, Acc 0.982
Round  66, Average loss 0.130, Acc 0.981
Round  67, Average loss 0.100, Acc 0.981
Round  68, Average loss 0.111, Acc 0.981
Round  69, Average loss 0.082, Acc 0.974
Round  70, Average loss 0.173, Acc 0.981
Round  71, Average loss 0.093, Acc 0.980
Round  72, Average loss 0.099, Acc 0.981
Round  73, Average loss 0.154, Acc 0.982
Round  74, Average loss 0.067, Acc 0.981
Round  75, Average loss 0.114, Acc 0.981
Round  76, Average loss 0.094, Acc 0.980
Round  77, Average loss 0.164, Acc 0.982
Round  78, Average loss 0.107, Acc 0.981
0.009841500000000001
Round  79, Average loss 0.084, Acc 0.981
Round  80, Average loss 0.115, Acc 0.982
Round  81, Average loss 0.108, Acc 0.978
Round  82, Average loss 0.157, Acc 0.981
Round  83, Average loss 0.101, Acc 0.977
Round  84, Average loss 0.122, Acc 0.981
Round  85, Average loss 0.086, Acc 0.981
Round  86, Average loss 0.058, Acc 0.982
Round  87, Average loss 0.135, Acc 0.980
Round  88, Average loss 0.101, Acc 0.974
Round  89, Average loss 0.173, Acc 0.980
Round  90, Average loss 0.097, Acc 0.982
Round  91, Average loss 0.094, Acc 0.981
Round  92, Average loss 0.060, Acc 0.973
Round  93, Average loss 0.089, Acc 0.981
Round  94, Average loss 0.055, Acc 0.975
Round  95, Average loss 0.094, Acc 0.981
Round  96, Average loss 0.080, Acc 0.982
Round  97, Average loss 0.110, Acc 0.980
Round  98, Average loss 0.096, Acc 0.982
0.008857350000000002
Round  99, Average loss 0.129, Acc 0.981
Round 100, Average loss 0.104, Acc 0.981
Round 101, Average loss 0.134, Acc 0.980
Round 102, Average loss 0.144, Acc 0.981
Round 103, Average loss 0.083, Acc 0.980
Round 104, Average loss 0.078, Acc 0.980
Round 105, Average loss 0.079, Acc 0.976
Round 106, Average loss 0.164, Acc 0.982
Round 107, Average loss 0.074, Acc 0.976
Round 108, Average loss 0.103, Acc 0.981
Round 109, Average loss 0.071, Acc 0.982
Round 110, Average loss 0.080, Acc 0.979
Round 111, Average loss 0.094, Acc 0.982
Round 112, Average loss 0.112, Acc 0.982
Round 113, Average loss 0.096, Acc 0.981
Round 114, Average loss 0.086, Acc 0.982
Round 115, Average loss 0.141, Acc 0.981
Round 116, Average loss 0.081, Acc 0.981
Round 117, Average loss 0.101, Acc 0.981
Round 118, Average loss 0.122, Acc 0.980
0.007971615000000001
Round 119, Average loss 0.122, Acc 0.981
Round 120, Average loss 0.073, Acc 0.979
Round 121, Average loss 0.112, Acc 0.981
Round 122, Average loss 0.069, Acc 0.981
Round 123, Average loss 0.104, Acc 0.981
Round 124, Average loss 0.059, Acc 0.982
Round 125, Average loss 0.077, Acc 0.981
Round 126, Average loss 0.106, Acc 0.981
Round 127, Average loss 0.091, Acc 0.982
Round 128, Average loss 0.071, Acc 0.978
Round 129, Average loss 0.140, Acc 0.981
Round 130, Average loss 0.052, Acc 0.980
Round 131, Average loss 0.136, Acc 0.981
Round 132, Average loss 0.066, Acc 0.982
Round 133, Average loss 0.073, Acc 0.981
Round 134, Average loss 0.078, Acc 0.981
Round 135, Average loss 0.113, Acc 0.983
Round 136, Average loss 0.086, Acc 0.981
Round 137, Average loss 0.087, Acc 0.983
Round 138, Average loss 0.072, Acc 0.979
0.007174453500000001
Round 139, Average loss 0.102, Acc 0.981
Round 140, Average loss 0.077, Acc 0.981
Round 141, Average loss 0.097, Acc 0.982
Round 142, Average loss 0.111, Acc 0.981
Round 143, Average loss 0.069, Acc 0.981
Round 144, Average loss 0.109, Acc 0.982
Round 145, Average loss 0.071, Acc 0.983
Round 146, Average loss 0.062, Acc 0.983
Round 147, Average loss 0.075, Acc 0.982
Round 148, Average loss 0.079, Acc 0.982
Round 149, Average loss 0.067, Acc 0.984
Round 150, Average loss 0.072, Acc 0.985
Round 151, Average loss 0.075, Acc 0.981
Round 152, Average loss 0.078, Acc 0.981
Round 153, Average loss 0.109, Acc 0.980
Round 154, Average loss 0.098, Acc 0.982
Round 155, Average loss 0.074, Acc 0.982
Round 156, Average loss 0.099, Acc 0.980
Round 157, Average loss 0.062, Acc 0.983
Round 158, Average loss 0.072, Acc 0.980
0.006457008150000001
Round 159, Average loss 0.060, Acc 0.982
Round 160, Average loss 0.047, Acc 0.981
Round 161, Average loss 0.122, Acc 0.982
Round 162, Average loss 0.059, Acc 0.983
Round 163, Average loss 0.110, Acc 0.984
Round 164, Average loss 0.091, Acc 0.984
Round 165, Average loss 0.076, Acc 0.984
Round 166, Average loss 0.058, Acc 0.983
Round 167, Average loss 0.060, Acc 0.981
Round 168, Average loss 0.078, Acc 0.985
Round 169, Average loss 0.072, Acc 0.985
Round 170, Average loss 0.077, Acc 0.984
Round 171, Average loss 0.102, Acc 0.982
Round 172, Average loss 0.078, Acc 0.985
Round 173, Average loss 0.098, Acc 0.985
Round 174, Average loss 0.061, Acc 0.983
Round 175, Average loss 0.068, Acc 0.984
Round 176, Average loss 0.088, Acc 0.984
Round 177, Average loss 0.084, Acc 0.984
Round 178, Average loss 0.058, Acc 0.984
0.005811307335000002
Round 179, Average loss 0.090, Acc 0.986
Round 180, Average loss 0.068, Acc 0.984
Round 181, Average loss 0.062, Acc 0.985
Round 182, Average loss 0.036, Acc 0.982
Round 183, Average loss 0.093, Acc 0.985
Round 184, Average loss 0.065, Acc 0.983
Round 185, Average loss 0.073, Acc 0.986
Round 186, Average loss 0.059, Acc 0.987
Round 187, Average loss 0.072, Acc 0.987
Round 188, Average loss 0.065, Acc 0.984
Round 189, Average loss 0.070, Acc 0.987
Round 190, Average loss 0.036, Acc 0.985
Round 191, Average loss 0.084, Acc 0.986
Round 192, Average loss 0.068, Acc 0.985
Round 193, Average loss 0.090, Acc 0.987
Round 194, Average loss 0.069, Acc 0.987
Round 195, Average loss 0.060, Acc 0.986
Round 196, Average loss 0.056, Acc 0.985
Round 197, Average loss 0.043, Acc 0.988
Round 198, Average loss 0.094, Acc 0.986
0.005230176601500001
Round 199, Average loss 0.092, Acc 0.985
Round 200, Average loss 0.094, Acc 0.985
Round 201, Average loss 0.063, Acc 0.988
Round 202, Average loss 0.051, Acc 0.986
Round 203, Average loss 0.091, Acc 0.987
Round 204, Average loss 0.081, Acc 0.988
Round 205, Average loss 0.044, Acc 0.989
Round 206, Average loss 0.075, Acc 0.989
Round 207, Average loss 0.050, Acc 0.987
Round 208, Average loss 0.070, Acc 0.989
Round 209, Average loss 0.057, Acc 0.989
Round 210, Average loss 0.076, Acc 0.989
Round 211, Average loss 0.074, Acc 0.988
Round 212, Average loss 0.067, Acc 0.987
Round 213, Average loss 0.096, Acc 0.987
Round 214, Average loss 0.064, Acc 0.985
Round 215, Average loss 0.071, Acc 0.988
Round 216, Average loss 0.055, Acc 0.985
Round 217, Average loss 0.066, Acc 0.989
Round 218, Average loss 0.048, Acc 0.987
0.004707158941350001
Round 219, Average loss 0.084, Acc 0.989
Round 220, Average loss 0.039, Acc 0.988
Round 221, Average loss 0.053, Acc 0.987
Round 222, Average loss 0.091, Acc 0.989
Round 223, Average loss 0.075, Acc 0.989
Round 224, Average loss 0.082, Acc 0.987
Round 225, Average loss 0.045, Acc 0.987
Round 226, Average loss 0.049, Acc 0.988
Round 227, Average loss 0.060, Acc 0.987
Round 228, Average loss 0.054, Acc 0.987
Round 229, Average loss 0.070, Acc 0.987
Round 230, Average loss 0.065, Acc 0.988
Round 231, Average loss 0.084, Acc 0.989
Round 232, Average loss 0.088, Acc 0.986
Round 233, Average loss 0.072, Acc 0.988
Round 234, Average loss 0.051, Acc 0.988
Round 235, Average loss 0.075, Acc 0.988
Round 236, Average loss 0.088, Acc 0.988
Round 237, Average loss 0.074, Acc 0.988
Round 238, Average loss 0.078, Acc 0.988
0.004236443047215001
Round 239, Average loss 0.063, Acc 0.987
Round 240, Average loss 0.040, Acc 0.988
Round 241, Average loss 0.059, Acc 0.987
Round 242, Average loss 0.065, Acc 0.989
Round 243, Average loss 0.063, Acc 0.989
Round 244, Average loss 0.060, Acc 0.989
Round 245, Average loss 0.063, Acc 0.989
Round 246, Average loss 0.078, Acc 0.988
Round 247, Average loss 0.057, Acc 0.988
Round 248, Average loss 0.073, Acc 0.988
Round 249, Average loss 0.053, Acc 0.987
Round 250, Average loss 0.065, Acc 0.988
Round 251, Average loss 0.053, Acc 0.987
Round 252, Average loss 0.044, Acc 0.988
Round 253, Average loss 0.059, Acc 0.988
Round 254, Average loss 0.042, Acc 0.988
Round 255, Average loss 0.050, Acc 0.987
Round 256, Average loss 0.061, Acc 0.987
Round 257, Average loss 0.066, Acc 0.987
Round 258, Average loss 0.064, Acc 0.987
0.003812798742493501
Round 259, Average loss 0.045, Acc 0.989
Round 260, Average loss 0.086, Acc 0.986
Round 261, Average loss 0.041, Acc 0.987
Round 262, Average loss 0.049, Acc 0.989
Round 263, Average loss 0.059, Acc 0.987
Round 264, Average loss 0.049, Acc 0.989
Round 265, Average loss 0.052, Acc 0.988
Round 266, Average loss 0.057, Acc 0.989
Round 267, Average loss 0.053, Acc 0.987
Round 268, Average loss 0.029, Acc 0.989
Round 269, Average loss 0.074, Acc 0.988
Round 270, Average loss 0.060, Acc 0.988
Round 271, Average loss 0.083, Acc 0.988
Round 272, Average loss 0.059, Acc 0.987
Round 273, Average loss 0.075, Acc 0.988
Round 274, Average loss 0.078, Acc 0.988
Round 275, Average loss 0.069, Acc 0.988
Round 276, Average loss 0.050, Acc 0.987
Round 277, Average loss 0.058, Acc 0.988
Round 278, Average loss 0.049, Acc 0.987
0.003431518868244151
Round 279, Average loss 0.092, Acc 0.988
Round 280, Average loss 0.047, Acc 0.987
Round 281, Average loss 0.065, Acc 0.989
Round 282, Average loss 0.047, Acc 0.988
Round 283, Average loss 0.061, Acc 0.989
Round 284, Average loss 0.067, Acc 0.987
Round 285, Average loss 0.053, Acc 0.989
Round 286, Average loss 0.041, Acc 0.988
Round 287, Average loss 0.058, Acc 0.988
Round 288, Average loss 0.041, Acc 0.988
Round 289, Average loss 0.079, Acc 0.988
Round 290, Average loss 0.060, Acc 0.988
Round 291, Average loss 0.055, Acc 0.988
Round 292, Average loss 0.047, Acc 0.988
Round 293, Average loss 0.075, Acc 0.989
Round 294, Average loss 0.106, Acc 0.987
Round 295, Average loss 0.070, Acc 0.989
Round 296, Average loss 0.044, Acc 0.987
Round 297, Average loss 0.116, Acc 0.989
Round 298, Average loss 0.066, Acc 0.988
0.0030883669814197362
Round 299, Average loss 0.075, Acc 0.989
200.23206567764282 s
Memory used: 1667.39 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=40, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.7454924] and score 2 is 0.0
Round   0, Average loss 3.236, Acc 0.000
score 1 is [0.61719507] and score 2 is 0.0
Round   1, Average loss 3.206, Acc 0.000
score 1 is [0.7124082] and score 2 is 0.0
Round   2, Average loss 3.239, Acc 0.000
score 1 is [0.7623916] and score 2 is 0.0
Round   3, Average loss 3.239, Acc 0.000
score 1 is [0.59931225] and score 2 is 0.0
Round   4, Average loss 3.234, Acc 0.000
9.804591417312622 s
Memory used: 1672.09 MB

2e-1 + 50
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=50, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.154, Acc 0.569
Round   1, Average loss 2.645, Acc 0.569
Round   2, Average loss 1.593, Acc 0.569
Round   3, Average loss 0.879, Acc 0.778
Round   4, Average loss 0.937, Acc 0.569
Round   5, Average loss 1.106, Acc 0.569
Round   6, Average loss 0.772, Acc 0.735
Round   7, Average loss 0.650, Acc 0.927
Round   8, Average loss 0.859, Acc 0.786
Round   9, Average loss 0.589, Acc 0.980
Round  10, Average loss 0.661, Acc 0.570
Round  11, Average loss 0.764, Acc 0.930
Round  12, Average loss 0.480, Acc 0.786
Round  13, Average loss 0.481, Acc 0.969
Round  14, Average loss 0.349, Acc 0.818
Round  15, Average loss 0.365, Acc 0.980
Round  16, Average loss 0.391, Acc 0.799
Round  17, Average loss 0.441, Acc 0.976
Round  18, Average loss 0.275, Acc 0.965
0.0135
Round  19, Average loss 0.232, Acc 0.413
Round  20, Average loss 1.066, Acc 0.940
Round  21, Average loss 0.220, Acc 0.969
Round  22, Average loss 0.185, Acc 0.413
Round  23, Average loss 1.397, Acc 0.939
Round  24, Average loss 0.183, Acc 0.981
Round  25, Average loss 0.343, Acc 0.938
Round  26, Average loss 0.206, Acc 0.977
Round  27, Average loss 0.373, Acc 0.931
Round  28, Average loss 0.286, Acc 0.981
Round  29, Average loss 0.220, Acc 0.946
Round  30, Average loss 0.204, Acc 0.962
Round  31, Average loss 0.338, Acc 0.964
Round  32, Average loss 0.133, Acc 0.925
Round  33, Average loss 0.277, Acc 0.980
Round  34, Average loss 0.163, Acc 0.981
Round  35, Average loss 0.410, Acc 0.965
Round  36, Average loss 0.175, Acc 0.978
Round  37, Average loss 0.177, Acc 0.941
Round  38, Average loss 0.258, Acc 0.981
0.01215
Round  39, Average loss 0.142, Acc 0.958
Round  40, Average loss 0.163, Acc 0.981
Round  41, Average loss 0.121, Acc 0.979
Round  42, Average loss 0.316, Acc 0.975
Round  43, Average loss 0.124, Acc 0.981
Round  44, Average loss 0.132, Acc 0.981
Round  45, Average loss 0.161, Acc 0.980
Round  46, Average loss 0.146, Acc 0.958
Round  47, Average loss 0.198, Acc 0.977
Round  48, Average loss 0.130, Acc 0.981
Round  49, Average loss 0.115, Acc 0.977
Round  50, Average loss 0.094, Acc 0.981
Round  51, Average loss 0.137, Acc 0.981
Round  52, Average loss 0.233, Acc 0.981
Round  53, Average loss 0.129, Acc 0.981
Round  54, Average loss 0.091, Acc 0.981
Round  55, Average loss 0.115, Acc 0.981
Round  56, Average loss 0.114, Acc 0.982
Round  57, Average loss 0.112, Acc 0.979
Round  58, Average loss 0.098, Acc 0.981
0.010935
Round  59, Average loss 0.101, Acc 0.981
Round  60, Average loss 0.080, Acc 0.912
Round  61, Average loss 0.232, Acc 0.981
Round  62, Average loss 0.085, Acc 0.981
Round  63, Average loss 0.124, Acc 0.978
Round  64, Average loss 0.105, Acc 0.981
Round  65, Average loss 0.074, Acc 0.981
Round  66, Average loss 0.115, Acc 0.981
Round  67, Average loss 0.108, Acc 0.981
Round  68, Average loss 0.085, Acc 0.981
Round  69, Average loss 0.083, Acc 0.981
Round  70, Average loss 0.106, Acc 0.981
Round  71, Average loss 0.063, Acc 0.981
Round  72, Average loss 0.090, Acc 0.982
Round  73, Average loss 0.081, Acc 0.981
Round  74, Average loss 0.137, Acc 0.981
Round  75, Average loss 0.080, Acc 0.981
Round  76, Average loss 0.090, Acc 0.981
Round  77, Average loss 0.097, Acc 0.981
Round  78, Average loss 0.118, Acc 0.980
0.009841500000000001
Round  79, Average loss 0.088, Acc 0.981
Round  80, Average loss 0.074, Acc 0.981
Round  81, Average loss 0.146, Acc 0.981
Round  82, Average loss 0.153, Acc 0.981
Round  83, Average loss 0.082, Acc 0.981
Round  84, Average loss 0.109, Acc 0.982
Round  85, Average loss 0.075, Acc 0.981
Round  86, Average loss 0.086, Acc 0.983
Round  87, Average loss 0.070, Acc 0.981
Round  88, Average loss 0.090, Acc 0.981
Round  89, Average loss 0.095, Acc 0.983
Round  90, Average loss 0.153, Acc 0.981
Round  91, Average loss 0.087, Acc 0.981
Round  92, Average loss 0.077, Acc 0.981
Round  93, Average loss 0.059, Acc 0.981
Round  94, Average loss 0.066, Acc 0.981
Round  95, Average loss 0.084, Acc 0.980
Round  96, Average loss 0.070, Acc 0.981
Round  97, Average loss 0.073, Acc 0.981
Round  98, Average loss 0.094, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.098, Acc 0.981
Round 100, Average loss 0.102, Acc 0.982
Round 101, Average loss 0.095, Acc 0.981
Round 102, Average loss 0.108, Acc 0.982
Round 103, Average loss 0.089, Acc 0.981
Round 104, Average loss 0.096, Acc 0.981
Round 105, Average loss 0.066, Acc 0.983
Round 106, Average loss 0.086, Acc 0.984
Round 107, Average loss 0.081, Acc 0.981
Round 108, Average loss 0.087, Acc 0.981
Round 109, Average loss 0.089, Acc 0.983
Round 110, Average loss 0.107, Acc 0.981
Round 111, Average loss 0.084, Acc 0.983
Round 112, Average loss 0.096, Acc 0.984
Round 113, Average loss 0.161, Acc 0.982
Round 114, Average loss 0.068, Acc 0.981
Round 115, Average loss 0.079, Acc 0.984
Round 116, Average loss 0.087, Acc 0.980
Round 117, Average loss 0.079, Acc 0.984
Round 118, Average loss 0.081, Acc 0.981
0.007971615000000001
Round 119, Average loss 0.070, Acc 0.980
Round 120, Average loss 0.129, Acc 0.980
Round 121, Average loss 0.090, Acc 0.981
Round 122, Average loss 0.093, Acc 0.984
Round 123, Average loss 0.087, Acc 0.982
Round 124, Average loss 0.122, Acc 0.984
Round 125, Average loss 0.092, Acc 0.983
Round 126, Average loss 0.101, Acc 0.984
Round 127, Average loss 0.078, Acc 0.982
Round 128, Average loss 0.090, Acc 0.981
Round 129, Average loss 0.082, Acc 0.984
Round 130, Average loss 0.105, Acc 0.982
Round 131, Average loss 0.117, Acc 0.984
Round 132, Average loss 0.074, Acc 0.984
Round 133, Average loss 0.065, Acc 0.984
Round 134, Average loss 0.112, Acc 0.983
Round 135, Average loss 0.068, Acc 0.984
Round 136, Average loss 0.076, Acc 0.983
Round 137, Average loss 0.085, Acc 0.984
Round 138, Average loss 0.056, Acc 0.984
0.007174453500000001
Round 139, Average loss 0.067, Acc 0.983
Round 140, Average loss 0.090, Acc 0.984
Round 141, Average loss 0.110, Acc 0.982
Round 142, Average loss 0.100, Acc 0.983
Round 143, Average loss 0.095, Acc 0.984
Round 144, Average loss 0.055, Acc 0.984
Round 145, Average loss 0.072, Acc 0.984
Round 146, Average loss 0.062, Acc 0.983
Round 147, Average loss 0.117, Acc 0.984
Round 148, Average loss 0.055, Acc 0.984
Round 149, Average loss 0.073, Acc 0.984
Round 150, Average loss 0.076, Acc 0.984
Round 151, Average loss 0.099, Acc 0.984
Round 152, Average loss 0.078, Acc 0.984
Round 153, Average loss 0.049, Acc 0.984
Round 154, Average loss 0.103, Acc 0.984
Round 155, Average loss 0.070, Acc 0.984
Round 156, Average loss 0.067, Acc 0.984
Round 157, Average loss 0.070, Acc 0.984
Round 158, Average loss 0.137, Acc 0.984
0.006457008150000001
Round 159, Average loss 0.070, Acc 0.984
Round 160, Average loss 0.079, Acc 0.984
Round 161, Average loss 0.074, Acc 0.984
Round 162, Average loss 0.061, Acc 0.984
Round 163, Average loss 0.062, Acc 0.984
Round 164, Average loss 0.073, Acc 0.984
Round 165, Average loss 0.114, Acc 0.985
Round 166, Average loss 0.078, Acc 0.984
Round 167, Average loss 0.078, Acc 0.983
Round 168, Average loss 0.085, Acc 0.984
Round 169, Average loss 0.048, Acc 0.984
Round 170, Average loss 0.074, Acc 0.984
Round 171, Average loss 0.097, Acc 0.984
Round 172, Average loss 0.076, Acc 0.984
Round 173, Average loss 0.063, Acc 0.984
Round 174, Average loss 0.070, Acc 0.986
Round 175, Average loss 0.074, Acc 0.985
Round 176, Average loss 0.077, Acc 0.987
Round 177, Average loss 0.048, Acc 0.984
Round 178, Average loss 0.084, Acc 0.984
0.005811307335000002
Round 179, Average loss 0.067, Acc 0.984
Round 180, Average loss 0.067, Acc 0.984
Round 181, Average loss 0.085, Acc 0.984
Round 182, Average loss 0.077, Acc 0.984
Round 183, Average loss 0.051, Acc 0.984
Round 184, Average loss 0.058, Acc 0.984
Round 185, Average loss 0.095, Acc 0.984
Round 186, Average loss 0.061, Acc 0.984
Round 187, Average loss 0.058, Acc 0.983
Round 188, Average loss 0.068, Acc 0.985
Round 189, Average loss 0.082, Acc 0.984
Round 190, Average loss 0.064, Acc 0.984
Round 191, Average loss 0.079, Acc 0.984
Round 192, Average loss 0.087, Acc 0.982
Round 193, Average loss 0.097, Acc 0.984
Round 194, Average loss 0.126, Acc 0.985
Round 195, Average loss 0.083, Acc 0.984
Round 196, Average loss 0.075, Acc 0.982
Round 197, Average loss 0.095, Acc 0.985
Round 198, Average loss 0.057, Acc 0.985
0.005230176601500001
Round 199, Average loss 0.074, Acc 0.984
Round 200, Average loss 0.051, Acc 0.985
Round 201, Average loss 0.070, Acc 0.985
Round 202, Average loss 0.067, Acc 0.984
Round 203, Average loss 0.076, Acc 0.984
Round 204, Average loss 0.092, Acc 0.984
Round 205, Average loss 0.057, Acc 0.984
Round 206, Average loss 0.059, Acc 0.985
Round 207, Average loss 0.080, Acc 0.984
Round 208, Average loss 0.042, Acc 0.984
Round 209, Average loss 0.063, Acc 0.985
Round 210, Average loss 0.061, Acc 0.985
Round 211, Average loss 0.056, Acc 0.985
Round 212, Average loss 0.058, Acc 0.984
Round 213, Average loss 0.050, Acc 0.985
Round 214, Average loss 0.054, Acc 0.985
Round 215, Average loss 0.063, Acc 0.985
Round 216, Average loss 0.055, Acc 0.985
Round 217, Average loss 0.072, Acc 0.986
Round 218, Average loss 0.049, Acc 0.987
0.004707158941350001
Round 219, Average loss 0.102, Acc 0.987
Round 220, Average loss 0.074, Acc 0.987
Round 221, Average loss 0.067, Acc 0.986
Round 222, Average loss 0.066, Acc 0.986
Round 223, Average loss 0.067, Acc 0.985
Round 224, Average loss 0.102, Acc 0.986
Round 225, Average loss 0.052, Acc 0.987
Round 226, Average loss 0.057, Acc 0.984
Round 227, Average loss 0.090, Acc 0.987
Round 228, Average loss 0.033, Acc 0.985
Round 229, Average loss 0.082, Acc 0.986
Round 230, Average loss 0.058, Acc 0.985
Round 231, Average loss 0.039, Acc 0.985
Round 232, Average loss 0.054, Acc 0.987
Round 233, Average loss 0.049, Acc 0.985
Round 234, Average loss 0.065, Acc 0.982
Round 235, Average loss 0.063, Acc 0.984
Round 236, Average loss 0.080, Acc 0.984
Round 237, Average loss 0.058, Acc 0.984
Round 238, Average loss 0.092, Acc 0.984
0.004236443047215001
Round 239, Average loss 0.104, Acc 0.983
Round 240, Average loss 0.052, Acc 0.985
Round 241, Average loss 0.054, Acc 0.986
Round 242, Average loss 0.054, Acc 0.986
Round 243, Average loss 0.056, Acc 0.984
Round 244, Average loss 0.054, Acc 0.985
Round 245, Average loss 0.070, Acc 0.986
Round 246, Average loss 0.082, Acc 0.985
Round 247, Average loss 0.065, Acc 0.987
Round 248, Average loss 0.037, Acc 0.986
Round 249, Average loss 0.055, Acc 0.987
Round 250, Average loss 0.046, Acc 0.986
Round 251, Average loss 0.029, Acc 0.986
Round 252, Average loss 0.077, Acc 0.987
Round 253, Average loss 0.051, Acc 0.987
Round 254, Average loss 0.083, Acc 0.987
Round 255, Average loss 0.071, Acc 0.987
Round 256, Average loss 0.040, Acc 0.986
Round 257, Average loss 0.048, Acc 0.987
Round 258, Average loss 0.046, Acc 0.986
0.003812798742493501
Round 259, Average loss 0.076, Acc 0.984
Round 260, Average loss 0.060, Acc 0.987
Round 261, Average loss 0.058, Acc 0.986
Round 262, Average loss 0.053, Acc 0.987
Round 263, Average loss 0.053, Acc 0.987
Round 264, Average loss 0.044, Acc 0.987
Round 265, Average loss 0.060, Acc 0.988
Round 266, Average loss 0.045, Acc 0.985
Round 267, Average loss 0.060, Acc 0.987
Round 268, Average loss 0.089, Acc 0.986
Round 269, Average loss 0.043, Acc 0.987
Round 270, Average loss 0.056, Acc 0.986
Round 271, Average loss 0.066, Acc 0.986
Round 272, Average loss 0.070, Acc 0.986
Round 273, Average loss 0.038, Acc 0.985
Round 274, Average loss 0.052, Acc 0.986
Round 275, Average loss 0.101, Acc 0.986
Round 276, Average loss 0.039, Acc 0.986
Round 277, Average loss 0.065, Acc 0.986
Round 278, Average loss 0.035, Acc 0.986
0.003431518868244151
Round 279, Average loss 0.076, Acc 0.987
Round 280, Average loss 0.120, Acc 0.987
Round 281, Average loss 0.055, Acc 0.987
Round 282, Average loss 0.048, Acc 0.984
Round 283, Average loss 0.031, Acc 0.986
Round 284, Average loss 0.079, Acc 0.986
Round 285, Average loss 0.089, Acc 0.987
Round 286, Average loss 0.035, Acc 0.987
Round 287, Average loss 0.069, Acc 0.986
Round 288, Average loss 0.035, Acc 0.986
Round 289, Average loss 0.042, Acc 0.984
Round 290, Average loss 0.085, Acc 0.986
Round 291, Average loss 0.041, Acc 0.986
Round 292, Average loss 0.069, Acc 0.988
Round 293, Average loss 0.068, Acc 0.986
Round 294, Average loss 0.042, Acc 0.986
Round 295, Average loss 0.074, Acc 0.987
Round 296, Average loss 0.050, Acc 0.987
Round 297, Average loss 0.080, Acc 0.987
Round 298, Average loss 0.056, Acc 0.987
0.0030883669814197362
Round 299, Average loss 0.057, Acc 0.988
216.7864692211151 s
Memory used: 1697.41 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=50, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.6832742] and score 2 is 0.0
Round   0, Average loss 3.194, Acc 0.000
score 1 is [0.58615166] and score 2 is 0.0
Round   1, Average loss 3.209, Acc 0.000
score 1 is [0.80093396] and score 2 is 0.0
Round   2, Average loss 3.158, Acc 0.000
score 1 is [0.80870456] and score 2 is 0.0
Round   3, Average loss 3.072, Acc 0.000
score 1 is [0.6116848] and score 2 is 0.0
Round   4, Average loss 3.231, Acc 0.000
12.714252471923828 s
Memory used: 1673.64 MB

2e-1 + 60
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=60, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.084, Acc 0.569
Round   1, Average loss 2.533, Acc 0.569
Round   2, Average loss 1.428, Acc 0.569
Round   3, Average loss 0.867, Acc 0.786
Round   4, Average loss 0.969, Acc 0.569
Round   5, Average loss 0.888, Acc 0.928
Round   6, Average loss 0.901, Acc 0.569
Round   7, Average loss 0.974, Acc 0.892
Round   8, Average loss 0.718, Acc 0.569
Round   9, Average loss 0.850, Acc 0.878
Round  10, Average loss 0.640, Acc 0.608
Round  11, Average loss 0.724, Acc 0.978
Round  12, Average loss 0.613, Acc 0.775
Round  13, Average loss 0.634, Acc 0.969
Round  14, Average loss 0.490, Acc 0.799
Round  15, Average loss 0.453, Acc 0.982
Round  16, Average loss 0.399, Acc 0.838
Round  17, Average loss 0.375, Acc 0.981
Round  18, Average loss 0.290, Acc 0.817
0.0135
Round  19, Average loss 0.419, Acc 0.977
Round  20, Average loss 0.282, Acc 0.941
Round  21, Average loss 0.216, Acc 0.981
Round  22, Average loss 0.236, Acc 0.943
Round  23, Average loss 0.183, Acc 0.979
Round  24, Average loss 0.228, Acc 0.975
Round  25, Average loss 0.245, Acc 0.964
Round  26, Average loss 0.183, Acc 0.949
Round  27, Average loss 0.260, Acc 0.976
Round  28, Average loss 0.089, Acc 0.976
Round  29, Average loss 0.193, Acc 0.413
Round  30, Average loss 1.611, Acc 0.964
Round  31, Average loss 0.173, Acc 0.413
Round  32, Average loss 0.541, Acc 0.942
Round  33, Average loss 0.169, Acc 0.981
Round  34, Average loss 0.390, Acc 0.941
Round  35, Average loss 0.280, Acc 0.981
Round  36, Average loss 0.342, Acc 0.943
Round  37, Average loss 0.160, Acc 0.981
Round  38, Average loss 0.262, Acc 0.942
0.01215
Round  39, Average loss 0.191, Acc 0.982
Round  40, Average loss 0.138, Acc 0.943
Round  41, Average loss 0.160, Acc 0.981
Round  42, Average loss 0.154, Acc 0.945
Round  43, Average loss 0.133, Acc 0.981
Round  44, Average loss 0.152, Acc 0.909
Round  45, Average loss 0.235, Acc 0.981
Round  46, Average loss 0.108, Acc 0.962
Round  47, Average loss 0.161, Acc 0.981
Round  48, Average loss 0.121, Acc 0.964
Round  49, Average loss 0.148, Acc 0.979
Round  50, Average loss 0.098, Acc 0.981
Round  51, Average loss 0.191, Acc 0.946
Round  52, Average loss 0.142, Acc 0.981
Round  53, Average loss 0.097, Acc 0.977
Round  54, Average loss 0.143, Acc 0.982
Round  55, Average loss 0.117, Acc 0.964
Round  56, Average loss 0.128, Acc 0.981
Round  57, Average loss 0.137, Acc 0.975
Round  58, Average loss 0.151, Acc 0.981
0.010935
Round  59, Average loss 0.132, Acc 0.979
Round  60, Average loss 0.103, Acc 0.896
Round  61, Average loss 0.170, Acc 0.979
Round  62, Average loss 0.121, Acc 0.981
Round  63, Average loss 0.101, Acc 0.978
Round  64, Average loss 0.101, Acc 0.981
Round  65, Average loss 0.110, Acc 0.979
Round  66, Average loss 0.056, Acc 0.981
Round  67, Average loss 0.160, Acc 0.981
Round  68, Average loss 0.144, Acc 0.981
Round  69, Average loss 0.103, Acc 0.981
Round  70, Average loss 0.109, Acc 0.980
Round  71, Average loss 0.106, Acc 0.981
Round  72, Average loss 0.096, Acc 0.982
Round  73, Average loss 0.079, Acc 0.982
Round  74, Average loss 0.117, Acc 0.978
Round  75, Average loss 0.121, Acc 0.982
Round  76, Average loss 0.080, Acc 0.982
Round  77, Average loss 0.097, Acc 0.981
Round  78, Average loss 0.547, Acc 0.964
0.009841500000000001
Round  79, Average loss 0.156, Acc 0.981
Round  80, Average loss 0.111, Acc 0.982
Round  81, Average loss 0.139, Acc 0.980
Round  82, Average loss 0.100, Acc 0.981
Round  83, Average loss 0.095, Acc 0.963
Round  84, Average loss 0.126, Acc 0.972
Round  85, Average loss 0.137, Acc 0.981
Round  86, Average loss 0.112, Acc 0.980
Round  87, Average loss 0.117, Acc 0.981
Round  88, Average loss 0.111, Acc 0.979
Round  89, Average loss 0.053, Acc 0.981
Round  90, Average loss 0.092, Acc 0.911
Round  91, Average loss 0.241, Acc 0.981
Round  92, Average loss 0.076, Acc 0.940
Round  93, Average loss 0.168, Acc 0.977
Round  94, Average loss 0.100, Acc 0.981
Round  95, Average loss 0.111, Acc 0.981
Round  96, Average loss 0.086, Acc 0.980
Round  97, Average loss 0.095, Acc 0.981
Round  98, Average loss 0.093, Acc 0.941
0.008857350000000002
Round  99, Average loss 0.140, Acc 0.981
Round 100, Average loss 0.074, Acc 0.982
Round 101, Average loss 0.116, Acc 0.981
Round 102, Average loss 0.117, Acc 0.983
Round 103, Average loss 0.127, Acc 0.981
Round 104, Average loss 0.105, Acc 0.983
Round 105, Average loss 0.130, Acc 0.981
Round 106, Average loss 0.126, Acc 0.982
Round 107, Average loss 0.100, Acc 0.981
Round 108, Average loss 0.067, Acc 0.980
Round 109, Average loss 0.230, Acc 0.982
Round 110, Average loss 0.104, Acc 0.972
Round 111, Average loss 0.160, Acc 0.981
Round 112, Average loss 0.085, Acc 0.941
Round 113, Average loss 0.173, Acc 0.981
Round 114, Average loss 0.117, Acc 0.980
Round 115, Average loss 0.114, Acc 0.981
Round 116, Average loss 0.056, Acc 0.981
Round 117, Average loss 0.131, Acc 0.981
Round 118, Average loss 0.038, Acc 0.981
0.007971615000000001
Round 119, Average loss 0.092, Acc 0.982
Round 120, Average loss 0.072, Acc 0.982
Round 121, Average loss 0.092, Acc 0.980
Round 122, Average loss 0.147, Acc 0.982
Round 123, Average loss 0.104, Acc 0.982
Round 124, Average loss 0.082, Acc 0.986
Round 125, Average loss 0.107, Acc 0.984
Round 126, Average loss 0.076, Acc 0.981
Round 127, Average loss 0.080, Acc 0.984
Round 128, Average loss 0.085, Acc 0.982
Round 129, Average loss 0.075, Acc 0.982
Round 130, Average loss 0.113, Acc 0.982
Round 131, Average loss 0.061, Acc 0.982
Round 132, Average loss 0.055, Acc 0.981
Round 133, Average loss 0.094, Acc 0.981
Round 134, Average loss 0.100, Acc 0.986
Round 135, Average loss 0.082, Acc 0.982
Round 136, Average loss 0.083, Acc 0.983
Round 137, Average loss 0.080, Acc 0.981
Round 138, Average loss 0.097, Acc 0.981
0.007174453500000001
Round 139, Average loss 0.082, Acc 0.981
Round 140, Average loss 0.071, Acc 0.982
Round 141, Average loss 0.123, Acc 0.981
Round 142, Average loss 0.086, Acc 0.981
Round 143, Average loss 0.097, Acc 0.982
Round 144, Average loss 0.066, Acc 0.982
Round 145, Average loss 0.080, Acc 0.982
Round 146, Average loss 0.065, Acc 0.982
Round 147, Average loss 0.063, Acc 0.983
Round 148, Average loss 0.060, Acc 0.984
Round 149, Average loss 0.100, Acc 0.983
Round 150, Average loss 0.058, Acc 0.982
Round 151, Average loss 0.062, Acc 0.981
Round 152, Average loss 0.080, Acc 0.984
Round 153, Average loss 0.100, Acc 0.984
Round 154, Average loss 0.089, Acc 0.981
Round 155, Average loss 0.079, Acc 0.981
Round 156, Average loss 0.072, Acc 0.982
Round 157, Average loss 0.092, Acc 0.982
Round 158, Average loss 0.063, Acc 0.982
0.006457008150000001
Round 159, Average loss 0.070, Acc 0.984
Round 160, Average loss 0.089, Acc 0.985
Round 161, Average loss 0.078, Acc 0.981
Round 162, Average loss 0.076, Acc 0.984
Round 163, Average loss 0.060, Acc 0.983
Round 164, Average loss 0.061, Acc 0.983
Round 165, Average loss 0.157, Acc 0.983
Round 166, Average loss 0.096, Acc 0.984
Round 167, Average loss 0.047, Acc 0.982
Round 168, Average loss 0.092, Acc 0.982
Round 169, Average loss 0.070, Acc 0.984
Round 170, Average loss 0.061, Acc 0.986
Round 171, Average loss 0.061, Acc 0.984
Round 172, Average loss 0.056, Acc 0.986
Round 173, Average loss 0.061, Acc 0.986
Round 174, Average loss 0.047, Acc 0.984
Round 175, Average loss 0.121, Acc 0.985
Round 176, Average loss 0.080, Acc 0.985
Round 177, Average loss 0.058, Acc 0.987
Round 178, Average loss 0.079, Acc 0.985
0.005811307335000002
Round 179, Average loss 0.095, Acc 0.985
Round 180, Average loss 0.050, Acc 0.985
Round 181, Average loss 0.107, Acc 0.983
Round 182, Average loss 0.078, Acc 0.984
Round 183, Average loss 0.081, Acc 0.984
Round 184, Average loss 0.081, Acc 0.983
Round 185, Average loss 0.064, Acc 0.982
Round 186, Average loss 0.060, Acc 0.986
Round 187, Average loss 0.046, Acc 0.984
Round 188, Average loss 0.061, Acc 0.986
Round 189, Average loss 0.066, Acc 0.985
Round 190, Average loss 0.049, Acc 0.986
Round 191, Average loss 0.065, Acc 0.984
Round 192, Average loss 0.073, Acc 0.984
Round 193, Average loss 0.084, Acc 0.984
Round 194, Average loss 0.052, Acc 0.983
Round 195, Average loss 0.066, Acc 0.985
Round 196, Average loss 0.056, Acc 0.983
Round 197, Average loss 0.094, Acc 0.983
Round 198, Average loss 0.064, Acc 0.983
0.005230176601500001
Round 199, Average loss 0.063, Acc 0.986
Round 200, Average loss 0.057, Acc 0.986
Round 201, Average loss 0.071, Acc 0.984
Round 202, Average loss 0.038, Acc 0.985
Round 203, Average loss 0.067, Acc 0.986
Round 204, Average loss 0.057, Acc 0.985
Round 205, Average loss 0.075, Acc 0.985
Round 206, Average loss 0.068, Acc 0.984
Round 207, Average loss 0.065, Acc 0.986
Round 208, Average loss 0.069, Acc 0.984
Round 209, Average loss 0.027, Acc 0.985
Round 210, Average loss 0.069, Acc 0.985
Round 211, Average loss 0.057, Acc 0.985
Round 212, Average loss 0.044, Acc 0.984
Round 213, Average loss 0.068, Acc 0.986
Round 214, Average loss 0.065, Acc 0.984
Round 215, Average loss 0.060, Acc 0.982
Round 216, Average loss 0.062, Acc 0.981
Round 217, Average loss 0.065, Acc 0.982
Round 218, Average loss 0.068, Acc 0.984
0.004707158941350001
Round 219, Average loss 0.084, Acc 0.986
Round 220, Average loss 0.051, Acc 0.985
Round 221, Average loss 0.056, Acc 0.985
Round 222, Average loss 0.084, Acc 0.985
Round 223, Average loss 0.102, Acc 0.984
Round 224, Average loss 0.066, Acc 0.986
Round 225, Average loss 0.058, Acc 0.984
Round 226, Average loss 0.060, Acc 0.985
Round 227, Average loss 0.043, Acc 0.984
Round 228, Average loss 0.049, Acc 0.984
Round 229, Average loss 0.081, Acc 0.987
Round 230, Average loss 0.048, Acc 0.984
Round 231, Average loss 0.120, Acc 0.987
Round 232, Average loss 0.065, Acc 0.985
Round 233, Average loss 0.053, Acc 0.986
Round 234, Average loss 0.046, Acc 0.985
Round 235, Average loss 0.056, Acc 0.984
Round 236, Average loss 0.077, Acc 0.987
Round 237, Average loss 0.056, Acc 0.985
Round 238, Average loss 0.057, Acc 0.984
0.004236443047215001
Round 239, Average loss 0.069, Acc 0.984
Round 240, Average loss 0.069, Acc 0.984
Round 241, Average loss 0.077, Acc 0.985
Round 242, Average loss 0.049, Acc 0.984
Round 243, Average loss 0.063, Acc 0.986
Round 244, Average loss 0.072, Acc 0.985
Round 245, Average loss 0.068, Acc 0.984
Round 246, Average loss 0.087, Acc 0.984
Round 247, Average loss 0.046, Acc 0.985
Round 248, Average loss 0.113, Acc 0.986
Round 249, Average loss 0.069, Acc 0.984
Round 250, Average loss 0.027, Acc 0.986
Round 251, Average loss 0.056, Acc 0.986
Round 252, Average loss 0.066, Acc 0.985
Round 253, Average loss 0.069, Acc 0.987
Round 254, Average loss 0.058, Acc 0.986
Round 255, Average loss 0.063, Acc 0.987
Round 256, Average loss 0.054, Acc 0.988
Round 257, Average loss 0.083, Acc 0.986
Round 258, Average loss 0.058, Acc 0.985
0.003812798742493501
Round 259, Average loss 0.065, Acc 0.985
Round 260, Average loss 0.047, Acc 0.985
Round 261, Average loss 0.047, Acc 0.985
Round 262, Average loss 0.049, Acc 0.984
Round 263, Average loss 0.071, Acc 0.984
Round 264, Average loss 0.055, Acc 0.985
Round 265, Average loss 0.057, Acc 0.986
Round 266, Average loss 0.047, Acc 0.985
Round 267, Average loss 0.055, Acc 0.985
Round 268, Average loss 0.069, Acc 0.986
Round 269, Average loss 0.060, Acc 0.987
Round 270, Average loss 0.047, Acc 0.987
Round 271, Average loss 0.066, Acc 0.987
Round 272, Average loss 0.053, Acc 0.984
Round 273, Average loss 0.090, Acc 0.987
Round 274, Average loss 0.042, Acc 0.986
Round 275, Average loss 0.052, Acc 0.987
Round 276, Average loss 0.051, Acc 0.985
Round 277, Average loss 0.081, Acc 0.985
Round 278, Average loss 0.036, Acc 0.985
0.003431518868244151
Round 279, Average loss 0.051, Acc 0.986
Round 280, Average loss 0.070, Acc 0.984
Round 281, Average loss 0.058, Acc 0.989
Round 282, Average loss 0.063, Acc 0.986
Round 283, Average loss 0.047, Acc 0.986
Round 284, Average loss 0.064, Acc 0.987
Round 285, Average loss 0.045, Acc 0.984
Round 286, Average loss 0.036, Acc 0.984
Round 287, Average loss 0.076, Acc 0.985
Round 288, Average loss 0.078, Acc 0.988
Round 289, Average loss 0.066, Acc 0.986
Round 290, Average loss 0.034, Acc 0.986
Round 291, Average loss 0.061, Acc 0.984
Round 292, Average loss 0.067, Acc 0.986
Round 293, Average loss 0.049, Acc 0.986
Round 294, Average loss 0.056, Acc 0.986
Round 295, Average loss 0.063, Acc 0.986
Round 296, Average loss 0.060, Acc 0.986
Round 297, Average loss 0.053, Acc 0.986
Round 298, Average loss 0.061, Acc 0.986
0.0030883669814197362
Round 299, Average loss 0.042, Acc 0.987
233.70977902412415 s
Memory used: 1649.14 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=60, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.634284] and score 2 is 0.0
Round   0, Average loss 3.077, Acc 0.000
score 1 is [0.62902474] and score 2 is 0.0
Round   1, Average loss 3.077, Acc 0.000
score 1 is [0.72858566] and score 2 is 0.0
Round   2, Average loss 3.077, Acc 0.000
score 1 is [0.6954143] and score 2 is 0.0
Round   3, Average loss 3.077, Acc 0.000
score 1 is [0.71610177] and score 2 is 0.0
Round   4, Average loss 3.077, Acc 0.000
12.220242023468018 s
Memory used: 1676.64 MB

2e-1 + 70
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=70, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.264, Acc 0.780
Round   1, Average loss 2.814, Acc 0.778
Round   2, Average loss 1.894, Acc 0.744
Round   3, Average loss 0.941, Acc 0.569
Round   4, Average loss 0.860, Acc 0.786
Round   5, Average loss 0.931, Acc 0.569
Round   6, Average loss 0.962, Acc 0.786
Round   7, Average loss 0.640, Acc 0.787
Round   8, Average loss 0.557, Acc 0.786
Round   9, Average loss 0.805, Acc 0.821
Round  10, Average loss 0.464, Acc 0.786
Round  11, Average loss 0.560, Acc 0.975
Round  12, Average loss 0.435, Acc 0.789
Round  13, Average loss 0.448, Acc 0.981
Round  14, Average loss 0.377, Acc 0.802
Round  15, Average loss 0.355, Acc 0.981
Round  16, Average loss 0.328, Acc 0.882
Round  17, Average loss 0.310, Acc 0.981
Round  18, Average loss 0.271, Acc 0.937
0.0135
Round  19, Average loss 0.229, Acc 0.981
Round  20, Average loss 0.195, Acc 0.957
Round  21, Average loss 0.140, Acc 0.982
Round  22, Average loss 0.179, Acc 0.972
Round  23, Average loss 0.118, Acc 0.977
Round  24, Average loss 0.144, Acc 0.978
Round  25, Average loss 0.178, Acc 0.973
Round  26, Average loss 0.161, Acc 0.978
Round  27, Average loss 0.143, Acc 0.981
Round  28, Average loss 0.086, Acc 0.935
Round  29, Average loss 0.240, Acc 0.981
Round  30, Average loss 0.120, Acc 0.981
Round  31, Average loss 0.118, Acc 0.980
Round  32, Average loss 0.140, Acc 0.981
Round  33, Average loss 0.136, Acc 0.946
Round  34, Average loss 0.193, Acc 0.981
Round  35, Average loss 0.092, Acc 0.977
Round  36, Average loss 0.115, Acc 0.981
Round  37, Average loss 0.071, Acc 0.979
Round  38, Average loss 0.101, Acc 0.977
0.01215
Round  39, Average loss 0.159, Acc 0.982
Round  40, Average loss 0.112, Acc 0.982
Round  41, Average loss 0.150, Acc 0.976
Round  42, Average loss 0.138, Acc 0.982
Round  43, Average loss 0.084, Acc 0.979
Round  44, Average loss 0.123, Acc 0.982
Round  45, Average loss 0.093, Acc 0.980
Round  46, Average loss 0.114, Acc 0.982
Round  47, Average loss 0.113, Acc 0.969
Round  48, Average loss 0.127, Acc 0.981
Round  49, Average loss 0.129, Acc 0.972
Round  50, Average loss 0.135, Acc 0.982
Round  51, Average loss 0.104, Acc 0.975
Round  52, Average loss 0.123, Acc 0.981
Round  53, Average loss 0.086, Acc 0.981
Round  54, Average loss 0.095, Acc 0.982
Round  55, Average loss 0.092, Acc 0.981
Round  56, Average loss 0.105, Acc 0.983
Round  57, Average loss 0.087, Acc 0.984
Round  58, Average loss 0.077, Acc 0.981
0.010935
Round  59, Average loss 0.115, Acc 0.981
Round  60, Average loss 0.101, Acc 0.983
Round  61, Average loss 0.056, Acc 0.984
Round  62, Average loss 0.112, Acc 0.981
Round  63, Average loss 0.090, Acc 0.986
Round  64, Average loss 0.086, Acc 0.982
Round  65, Average loss 0.111, Acc 0.982
Round  66, Average loss 0.078, Acc 0.981
Round  67, Average loss 0.082, Acc 0.982
Round  68, Average loss 0.083, Acc 0.981
Round  69, Average loss 0.118, Acc 0.984
Round  70, Average loss 0.073, Acc 0.981
Round  71, Average loss 0.093, Acc 0.984
Round  72, Average loss 0.092, Acc 0.984
Round  73, Average loss 0.075, Acc 0.983
Round  74, Average loss 0.092, Acc 0.983
Round  75, Average loss 0.112, Acc 0.984
Round  76, Average loss 0.062, Acc 0.985
Round  77, Average loss 0.083, Acc 0.981
Round  78, Average loss 0.095, Acc 0.984
0.009841500000000001
Round  79, Average loss 0.100, Acc 0.984
Round  80, Average loss 0.075, Acc 0.984
Round  81, Average loss 0.110, Acc 0.985
Round  82, Average loss 0.059, Acc 0.981
Round  83, Average loss 0.087, Acc 0.985
Round  84, Average loss 0.078, Acc 0.981
Round  85, Average loss 0.052, Acc 0.986
Round  86, Average loss 0.078, Acc 0.984
Round  87, Average loss 0.105, Acc 0.985
Round  88, Average loss 0.070, Acc 0.986
Round  89, Average loss 0.061, Acc 0.986
Round  90, Average loss 0.068, Acc 0.984
Round  91, Average loss 0.069, Acc 0.987
Round  92, Average loss 0.073, Acc 0.985
Round  93, Average loss 0.063, Acc 0.983
Round  94, Average loss 0.064, Acc 0.985
Round  95, Average loss 0.086, Acc 0.986
Round  96, Average loss 0.054, Acc 0.984
Round  97, Average loss 0.070, Acc 0.986
Round  98, Average loss 0.098, Acc 0.984
0.008857350000000002
Round  99, Average loss 0.068, Acc 0.987
Round 100, Average loss 0.085, Acc 0.986
Round 101, Average loss 0.068, Acc 0.983
Round 102, Average loss 0.054, Acc 0.987
Round 103, Average loss 0.063, Acc 0.984
Round 104, Average loss 0.075, Acc 0.986
Round 105, Average loss 0.040, Acc 0.986
Round 106, Average loss 0.079, Acc 0.985
Round 107, Average loss 0.062, Acc 0.984
Round 108, Average loss 0.066, Acc 0.986
Round 109, Average loss 0.058, Acc 0.982
Round 110, Average loss 0.128, Acc 0.984
Round 111, Average loss 0.114, Acc 0.987
Round 112, Average loss 0.100, Acc 0.984
Round 113, Average loss 0.067, Acc 0.983
Round 114, Average loss 0.090, Acc 0.983
Round 115, Average loss 0.045, Acc 0.983
Round 116, Average loss 0.095, Acc 0.984
Round 117, Average loss 0.088, Acc 0.984
Round 118, Average loss 0.097, Acc 0.982
0.007971615000000001
Round 119, Average loss 0.111, Acc 0.981
Round 120, Average loss 0.081, Acc 0.981
Round 121, Average loss 0.072, Acc 0.981
Round 122, Average loss 0.061, Acc 0.981
Round 123, Average loss 0.093, Acc 0.981
Round 124, Average loss 0.072, Acc 0.981
Round 125, Average loss 0.083, Acc 0.981
Round 126, Average loss 0.096, Acc 0.981
Round 127, Average loss 0.065, Acc 0.981
Round 128, Average loss 0.053, Acc 0.981
Round 129, Average loss 0.071, Acc 0.981
Round 130, Average loss 0.044, Acc 0.981
Round 131, Average loss 0.083, Acc 0.981
Round 132, Average loss 0.092, Acc 0.981
Round 133, Average loss 0.082, Acc 0.981
Round 134, Average loss 0.108, Acc 0.981
Round 135, Average loss 0.103, Acc 0.981
Round 136, Average loss 0.054, Acc 0.981
Round 137, Average loss 0.089, Acc 0.982
Round 138, Average loss 0.077, Acc 0.984
0.007174453500000001
Round 139, Average loss 0.090, Acc 0.981
Round 140, Average loss 0.096, Acc 0.984
Round 141, Average loss 0.040, Acc 0.982
Round 142, Average loss 0.051, Acc 0.985
Round 143, Average loss 0.078, Acc 0.984
Round 144, Average loss 0.073, Acc 0.986
Round 145, Average loss 0.077, Acc 0.986
Round 146, Average loss 0.073, Acc 0.986
Round 147, Average loss 0.058, Acc 0.987
Round 148, Average loss 0.068, Acc 0.986
Round 149, Average loss 0.051, Acc 0.986
Round 150, Average loss 0.070, Acc 0.984
Round 151, Average loss 0.054, Acc 0.984
Round 152, Average loss 0.084, Acc 0.984
Round 153, Average loss 0.053, Acc 0.986
Round 154, Average loss 0.076, Acc 0.984
Round 155, Average loss 0.099, Acc 0.986
Round 156, Average loss 0.098, Acc 0.985
Round 157, Average loss 0.085, Acc 0.986
Round 158, Average loss 0.046, Acc 0.986
0.006457008150000001
Round 159, Average loss 0.068, Acc 0.984
Round 160, Average loss 0.081, Acc 0.985
Round 161, Average loss 0.078, Acc 0.985
Round 162, Average loss 0.097, Acc 0.984
Round 163, Average loss 0.074, Acc 0.986
Round 164, Average loss 0.064, Acc 0.985
Round 165, Average loss 0.073, Acc 0.985
Round 166, Average loss 0.062, Acc 0.985
Round 167, Average loss 0.069, Acc 0.984
Round 168, Average loss 0.047, Acc 0.984
Round 169, Average loss 0.121, Acc 0.984
Round 170, Average loss 0.096, Acc 0.985
Round 171, Average loss 0.058, Acc 0.984
Round 172, Average loss 0.076, Acc 0.984
Round 173, Average loss 0.096, Acc 0.985
Round 174, Average loss 0.034, Acc 0.986
Round 175, Average loss 0.068, Acc 0.985
Round 176, Average loss 0.046, Acc 0.985
Round 177, Average loss 0.053, Acc 0.985
Round 178, Average loss 0.085, Acc 0.987
0.005811307335000002
Round 179, Average loss 0.085, Acc 0.985
Round 180, Average loss 0.097, Acc 0.986
Round 181, Average loss 0.059, Acc 0.986
Round 182, Average loss 0.055, Acc 0.985
Round 183, Average loss 0.042, Acc 0.985
Round 184, Average loss 0.068, Acc 0.984
Round 185, Average loss 0.063, Acc 0.984
Round 186, Average loss 0.073, Acc 0.984
Round 187, Average loss 0.093, Acc 0.984
Round 188, Average loss 0.078, Acc 0.985
Round 189, Average loss 0.095, Acc 0.985
Round 190, Average loss 0.080, Acc 0.985
Round 191, Average loss 0.083, Acc 0.984
Round 192, Average loss 0.080, Acc 0.984
Round 193, Average loss 0.080, Acc 0.984
Round 194, Average loss 0.080, Acc 0.984
Round 195, Average loss 0.073, Acc 0.984
Round 196, Average loss 0.086, Acc 0.984
Round 197, Average loss 0.082, Acc 0.984
Round 198, Average loss 0.090, Acc 0.984
0.005230176601500001
Round 199, Average loss 0.069, Acc 0.984
Round 200, Average loss 0.091, Acc 0.984
Round 201, Average loss 0.070, Acc 0.984
Round 202, Average loss 0.115, Acc 0.983
Round 203, Average loss 0.060, Acc 0.984
Round 204, Average loss 0.082, Acc 0.985
Round 205, Average loss 0.051, Acc 0.985
Round 206, Average loss 0.072, Acc 0.985
Round 207, Average loss 0.083, Acc 0.985
Round 208, Average loss 0.076, Acc 0.985
Round 209, Average loss 0.082, Acc 0.986
Round 210, Average loss 0.063, Acc 0.985
Round 211, Average loss 0.059, Acc 0.985
Round 212, Average loss 0.061, Acc 0.985
Round 213, Average loss 0.061, Acc 0.986
Round 214, Average loss 0.078, Acc 0.986
Round 215, Average loss 0.068, Acc 0.985
Round 216, Average loss 0.078, Acc 0.986
Round 217, Average loss 0.076, Acc 0.986
Round 218, Average loss 0.062, Acc 0.986
0.004707158941350001
Round 219, Average loss 0.059, Acc 0.985
Round 220, Average loss 0.047, Acc 0.985
Round 221, Average loss 0.044, Acc 0.986
Round 222, Average loss 0.096, Acc 0.986
Round 223, Average loss 0.055, Acc 0.985
Round 224, Average loss 0.050, Acc 0.985
Round 225, Average loss 0.055, Acc 0.984
Round 226, Average loss 0.077, Acc 0.984
Round 227, Average loss 0.057, Acc 0.984
Round 228, Average loss 0.048, Acc 0.984
Round 229, Average loss 0.076, Acc 0.985
Round 230, Average loss 0.054, Acc 0.985
Round 231, Average loss 0.071, Acc 0.985
Round 232, Average loss 0.062, Acc 0.985
Round 233, Average loss 0.122, Acc 0.985
Round 234, Average loss 0.098, Acc 0.985
Round 235, Average loss 0.041, Acc 0.985
Round 236, Average loss 0.056, Acc 0.985
Round 237, Average loss 0.055, Acc 0.986
Round 238, Average loss 0.067, Acc 0.985
0.004236443047215001
Round 239, Average loss 0.072, Acc 0.986
Round 240, Average loss 0.045, Acc 0.985
Round 241, Average loss 0.061, Acc 0.986
Round 242, Average loss 0.065, Acc 0.985
Round 243, Average loss 0.061, Acc 0.985
Round 244, Average loss 0.050, Acc 0.985
Round 245, Average loss 0.063, Acc 0.986
Round 246, Average loss 0.037, Acc 0.985
Round 247, Average loss 0.082, Acc 0.986
Round 248, Average loss 0.049, Acc 0.985
Round 249, Average loss 0.049, Acc 0.986
Round 250, Average loss 0.062, Acc 0.987
Round 251, Average loss 0.102, Acc 0.987
Round 252, Average loss 0.064, Acc 0.986
Round 253, Average loss 0.038, Acc 0.986
Round 254, Average loss 0.064, Acc 0.987
Round 255, Average loss 0.051, Acc 0.987
Round 256, Average loss 0.066, Acc 0.987
Round 257, Average loss 0.049, Acc 0.985
Round 258, Average loss 0.093, Acc 0.985
0.003812798742493501
Round 259, Average loss 0.050, Acc 0.986
Round 260, Average loss 0.051, Acc 0.986
Round 261, Average loss 0.043, Acc 0.986
Round 262, Average loss 0.072, Acc 0.987
Round 263, Average loss 0.062, Acc 0.986
Round 264, Average loss 0.049, Acc 0.986
Round 265, Average loss 0.066, Acc 0.986
Round 266, Average loss 0.067, Acc 0.987
Round 267, Average loss 0.066, Acc 0.987
Round 268, Average loss 0.061, Acc 0.986
Round 269, Average loss 0.036, Acc 0.986
Round 270, Average loss 0.075, Acc 0.987
Round 271, Average loss 0.061, Acc 0.986
Round 272, Average loss 0.033, Acc 0.986
Round 273, Average loss 0.039, Acc 0.986
Round 274, Average loss 0.038, Acc 0.986
Round 275, Average loss 0.092, Acc 0.987
Round 276, Average loss 0.084, Acc 0.987
Round 277, Average loss 0.061, Acc 0.987
Round 278, Average loss 0.037, Acc 0.986
0.003431518868244151
Round 279, Average loss 0.054, Acc 0.987
Round 280, Average loss 0.052, Acc 0.987
Round 281, Average loss 0.066, Acc 0.987
Round 282, Average loss 0.055, Acc 0.987
Round 283, Average loss 0.054, Acc 0.987
Round 284, Average loss 0.064, Acc 0.987
Round 285, Average loss 0.065, Acc 0.987
Round 286, Average loss 0.060, Acc 0.987
Round 287, Average loss 0.061, Acc 0.987
Round 288, Average loss 0.085, Acc 0.987
Round 289, Average loss 0.058, Acc 0.987
Round 290, Average loss 0.063, Acc 0.987
Round 291, Average loss 0.047, Acc 0.987
Round 292, Average loss 0.081, Acc 0.987
Round 293, Average loss 0.066, Acc 0.987
Round 294, Average loss 0.062, Acc 0.987
Round 295, Average loss 0.041, Acc 0.987
Round 296, Average loss 0.036, Acc 0.987
Round 297, Average loss 0.048, Acc 0.986
Round 298, Average loss 0.041, Acc 0.987
0.0030883669814197362
Round 299, Average loss 0.071, Acc 0.986
248.72595524787903 s
Memory used: 1653.00 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=70, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.8306712] and score 2 is 0.0
Round   0, Average loss 3.124, Acc 0.001
score 1 is [0.6031152] and score 2 is 0.0
Round   1, Average loss 3.201, Acc 0.001
score 1 is [0.7826538] and score 2 is 0.0
Round   2, Average loss 3.112, Acc 0.001
score 1 is [0.6751322] and score 2 is 0.0
Round   3, Average loss 3.112, Acc 0.001
score 1 is [0.7086782] and score 2 is 0.0
Round   4, Average loss 3.112, Acc 0.001
10.339426279067993 s
Memory used: 1661.73 MB

2e-1 + 80
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=80, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.206, Acc 0.744
Round   1, Average loss 2.733, Acc 0.744
Round   2, Average loss 1.674, Acc 0.744
Round   3, Average loss 0.750, Acc 0.786
Round   4, Average loss 0.661, Acc 0.613
Round   5, Average loss 0.925, Acc 0.980
Round   6, Average loss 0.632, Acc 0.744
Round   7, Average loss 0.760, Acc 0.969
Round   8, Average loss 0.470, Acc 0.789
Round   9, Average loss 0.561, Acc 0.978
Round  10, Average loss 0.387, Acc 0.923
Round  11, Average loss 0.346, Acc 0.981
Round  12, Average loss 0.551, Acc 0.899
Round  13, Average loss 0.285, Acc 0.981
Round  14, Average loss 0.314, Acc 0.936
Round  15, Average loss 0.265, Acc 0.981
Round  16, Average loss 0.332, Acc 0.925
Round  17, Average loss 0.279, Acc 0.980
Round  18, Average loss 0.301, Acc 0.925
0.0135
Round  19, Average loss 0.175, Acc 0.979
Round  20, Average loss 0.126, Acc 0.952
Round  21, Average loss 0.190, Acc 0.980
Round  22, Average loss 0.165, Acc 0.974
Round  23, Average loss 0.206, Acc 0.981
Round  24, Average loss 0.197, Acc 0.941
Round  25, Average loss 0.173, Acc 0.981
Round  26, Average loss 0.198, Acc 0.938
Round  27, Average loss 0.174, Acc 0.981
Round  28, Average loss 0.118, Acc 0.966
Round  29, Average loss 0.143, Acc 0.981
Round  30, Average loss 0.089, Acc 0.976
Round  31, Average loss 0.133, Acc 0.981
Round  32, Average loss 0.093, Acc 0.977
Round  33, Average loss 0.143, Acc 0.981
Round  34, Average loss 0.111, Acc 0.980
Round  35, Average loss 0.088, Acc 0.980
Round  36, Average loss 0.134, Acc 0.981
Round  37, Average loss 0.089, Acc 0.978
Round  38, Average loss 0.107, Acc 0.981
0.01215
Round  39, Average loss 0.124, Acc 0.978
Round  40, Average loss 0.136, Acc 0.981
Round  41, Average loss 0.111, Acc 0.979
Round  42, Average loss 0.107, Acc 0.981
Round  43, Average loss 0.096, Acc 0.980
Round  44, Average loss 0.092, Acc 0.981
Round  45, Average loss 0.088, Acc 0.981
Round  46, Average loss 0.086, Acc 0.979
Round  47, Average loss 0.104, Acc 0.978
Round  48, Average loss 0.117, Acc 0.981
Round  49, Average loss 0.079, Acc 0.981
Round  50, Average loss 0.098, Acc 0.981
Round  51, Average loss 0.077, Acc 0.981
Round  52, Average loss 0.166, Acc 0.980
Round  53, Average loss 0.090, Acc 0.980
Round  54, Average loss 0.089, Acc 0.981
Round  55, Average loss 0.083, Acc 0.979
Round  56, Average loss 0.096, Acc 0.981
Round  57, Average loss 0.142, Acc 0.979
Round  58, Average loss 0.082, Acc 0.981
0.010935
Round  59, Average loss 0.088, Acc 0.981
Round  60, Average loss 0.132, Acc 0.979
Round  61, Average loss 0.101, Acc 0.981
Round  62, Average loss 0.105, Acc 0.980
Round  63, Average loss 0.067, Acc 0.978
Round  64, Average loss 0.118, Acc 0.981
Round  65, Average loss 0.103, Acc 0.980
Round  66, Average loss 0.106, Acc 0.983
Round  67, Average loss 0.096, Acc 0.979
Round  68, Average loss 0.107, Acc 0.981
Round  69, Average loss 0.053, Acc 0.981
Round  70, Average loss 0.120, Acc 0.980
Round  71, Average loss 0.107, Acc 0.981
Round  72, Average loss 0.086, Acc 0.981
Round  73, Average loss 0.077, Acc 0.981
Round  74, Average loss 0.074, Acc 0.978
Round  75, Average loss 0.145, Acc 0.981
Round  76, Average loss 0.076, Acc 0.981
Round  77, Average loss 0.096, Acc 0.981
Round  78, Average loss 0.101, Acc 0.978
0.009841500000000001
Round  79, Average loss 0.118, Acc 0.981
Round  80, Average loss 0.096, Acc 0.981
Round  81, Average loss 0.077, Acc 0.981
Round  82, Average loss 0.062, Acc 0.981
Round  83, Average loss 0.077, Acc 0.981
Round  84, Average loss 0.090, Acc 0.981
Round  85, Average loss 0.070, Acc 0.980
Round  86, Average loss 0.102, Acc 0.981
Round  87, Average loss 0.093, Acc 0.982
Round  88, Average loss 0.100, Acc 0.982
Round  89, Average loss 0.097, Acc 0.982
Round  90, Average loss 0.128, Acc 0.981
Round  91, Average loss 0.093, Acc 0.982
Round  92, Average loss 0.084, Acc 0.984
Round  93, Average loss 0.086, Acc 0.981
Round  94, Average loss 0.059, Acc 0.981
Round  95, Average loss 0.103, Acc 0.980
Round  96, Average loss 0.092, Acc 0.982
Round  97, Average loss 0.094, Acc 0.982
Round  98, Average loss 0.107, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.077, Acc 0.982
Round 100, Average loss 0.120, Acc 0.981
Round 101, Average loss 0.087, Acc 0.982
Round 102, Average loss 0.080, Acc 0.982
Round 103, Average loss 0.074, Acc 0.981
Round 104, Average loss 0.089, Acc 0.982
Round 105, Average loss 0.074, Acc 0.981
Round 106, Average loss 0.094, Acc 0.983
Round 107, Average loss 0.087, Acc 0.981
Round 108, Average loss 0.107, Acc 0.982
Round 109, Average loss 0.095, Acc 0.981
Round 110, Average loss 0.105, Acc 0.982
Round 111, Average loss 0.061, Acc 0.982
Round 112, Average loss 0.072, Acc 0.982
Round 113, Average loss 0.105, Acc 0.984
Round 114, Average loss 0.102, Acc 0.981
Round 115, Average loss 0.121, Acc 0.982
Round 116, Average loss 0.073, Acc 0.981
Round 117, Average loss 0.102, Acc 0.981
Round 118, Average loss 0.076, Acc 0.983
0.007971615000000001
Round 119, Average loss 0.113, Acc 0.981
Round 120, Average loss 0.077, Acc 0.982
Round 121, Average loss 0.108, Acc 0.981
Round 122, Average loss 0.104, Acc 0.981
Round 123, Average loss 0.082, Acc 0.981
Round 124, Average loss 0.094, Acc 0.982
Round 125, Average loss 0.062, Acc 0.982
Round 126, Average loss 0.102, Acc 0.982
Round 127, Average loss 0.088, Acc 0.982
Round 128, Average loss 0.104, Acc 0.982
Round 129, Average loss 0.097, Acc 0.982
Round 130, Average loss 0.088, Acc 0.982
Round 131, Average loss 0.080, Acc 0.981
Round 132, Average loss 0.081, Acc 0.982
Round 133, Average loss 0.053, Acc 0.983
Round 134, Average loss 0.084, Acc 0.983
Round 135, Average loss 0.084, Acc 0.982
Round 136, Average loss 0.092, Acc 0.982
Round 137, Average loss 0.088, Acc 0.982
Round 138, Average loss 0.089, Acc 0.982
0.007174453500000001
Round 139, Average loss 0.089, Acc 0.982
Round 140, Average loss 0.080, Acc 0.982
Round 141, Average loss 0.054, Acc 0.982
Round 142, Average loss 0.053, Acc 0.984
Round 143, Average loss 0.059, Acc 0.982
Round 144, Average loss 0.059, Acc 0.982
Round 145, Average loss 0.062, Acc 0.983
Round 146, Average loss 0.074, Acc 0.982
Round 147, Average loss 0.064, Acc 0.983
Round 148, Average loss 0.092, Acc 0.982
Round 149, Average loss 0.051, Acc 0.982
Round 150, Average loss 0.078, Acc 0.982
Round 151, Average loss 0.078, Acc 0.981
Round 152, Average loss 0.081, Acc 0.984
Round 153, Average loss 0.088, Acc 0.981
Round 154, Average loss 0.100, Acc 0.984
Round 155, Average loss 0.107, Acc 0.982
Round 156, Average loss 0.090, Acc 0.982
Round 157, Average loss 0.079, Acc 0.982
Round 158, Average loss 0.075, Acc 0.981
0.006457008150000001
Round 159, Average loss 0.045, Acc 0.982
Round 160, Average loss 0.082, Acc 0.981
Round 161, Average loss 0.047, Acc 0.981
Round 162, Average loss 0.089, Acc 0.982
Round 163, Average loss 0.079, Acc 0.984
Round 164, Average loss 0.078, Acc 0.983
Round 165, Average loss 0.062, Acc 0.981
Round 166, Average loss 0.116, Acc 0.983
Round 167, Average loss 0.035, Acc 0.984
Round 168, Average loss 0.064, Acc 0.983
Round 169, Average loss 0.074, Acc 0.983
Round 170, Average loss 0.082, Acc 0.982
Round 171, Average loss 0.045, Acc 0.985
Round 172, Average loss 0.068, Acc 0.985
Round 173, Average loss 0.088, Acc 0.984
Round 174, Average loss 0.075, Acc 0.985
Round 175, Average loss 0.054, Acc 0.982
Round 176, Average loss 0.066, Acc 0.984
Round 177, Average loss 0.059, Acc 0.983
Round 178, Average loss 0.073, Acc 0.981
0.005811307335000002
Round 179, Average loss 0.052, Acc 0.982
Round 180, Average loss 0.066, Acc 0.981
Round 181, Average loss 0.055, Acc 0.982
Round 182, Average loss 0.059, Acc 0.982
Round 183, Average loss 0.084, Acc 0.985
Round 184, Average loss 0.083, Acc 0.982
Round 185, Average loss 0.080, Acc 0.985
Round 186, Average loss 0.088, Acc 0.982
Round 187, Average loss 0.063, Acc 0.983
Round 188, Average loss 0.082, Acc 0.984
Round 189, Average loss 0.062, Acc 0.982
Round 190, Average loss 0.060, Acc 0.983
Round 191, Average loss 0.057, Acc 0.983
Round 192, Average loss 0.062, Acc 0.983
Round 193, Average loss 0.072, Acc 0.985
Round 194, Average loss 0.062, Acc 0.983
Round 195, Average loss 0.062, Acc 0.982
Round 196, Average loss 0.065, Acc 0.984
Round 197, Average loss 0.082, Acc 0.984
Round 198, Average loss 0.088, Acc 0.983
0.005230176601500001
Round 199, Average loss 0.072, Acc 0.986
Round 200, Average loss 0.077, Acc 0.984
Round 201, Average loss 0.073, Acc 0.986
Round 202, Average loss 0.055, Acc 0.983
Round 203, Average loss 0.097, Acc 0.985
Round 204, Average loss 0.033, Acc 0.986
Round 205, Average loss 0.065, Acc 0.986
Round 206, Average loss 0.080, Acc 0.986
Round 207, Average loss 0.060, Acc 0.983
Round 208, Average loss 0.049, Acc 0.985
Round 209, Average loss 0.094, Acc 0.982
Round 210, Average loss 0.045, Acc 0.988
Round 211, Average loss 0.058, Acc 0.983
Round 212, Average loss 0.078, Acc 0.987
Round 213, Average loss 0.080, Acc 0.986
Round 214, Average loss 0.073, Acc 0.984
Round 215, Average loss 0.063, Acc 0.984
Round 216, Average loss 0.065, Acc 0.985
Round 217, Average loss 0.060, Acc 0.984
Round 218, Average loss 0.042, Acc 0.986
0.004707158941350001
Round 219, Average loss 0.057, Acc 0.987
Round 220, Average loss 0.054, Acc 0.984
Round 221, Average loss 0.071, Acc 0.987
Round 222, Average loss 0.087, Acc 0.984
Round 223, Average loss 0.053, Acc 0.985
Round 224, Average loss 0.053, Acc 0.984
Round 225, Average loss 0.112, Acc 0.982
Round 226, Average loss 0.085, Acc 0.988
Round 227, Average loss 0.082, Acc 0.982
Round 228, Average loss 0.076, Acc 0.983
Round 229, Average loss 0.070, Acc 0.983
Round 230, Average loss 0.074, Acc 0.983
Round 231, Average loss 0.064, Acc 0.985
Round 232, Average loss 0.068, Acc 0.982
Round 233, Average loss 0.066, Acc 0.985
Round 234, Average loss 0.039, Acc 0.983
Round 235, Average loss 0.076, Acc 0.988
Round 236, Average loss 0.065, Acc 0.987
Round 237, Average loss 0.073, Acc 0.985
Round 238, Average loss 0.055, Acc 0.987
0.004236443047215001
Round 239, Average loss 0.104, Acc 0.987
Round 240, Average loss 0.043, Acc 0.987
Round 241, Average loss 0.053, Acc 0.986
Round 242, Average loss 0.046, Acc 0.987
Round 243, Average loss 0.063, Acc 0.987
Round 244, Average loss 0.058, Acc 0.987
Round 245, Average loss 0.059, Acc 0.963
Round 246, Average loss 0.138, Acc 0.987
Round 247, Average loss 0.051, Acc 0.985
Round 248, Average loss 0.134, Acc 0.987
Round 249, Average loss 0.076, Acc 0.984
Round 250, Average loss 0.073, Acc 0.987
Round 251, Average loss 0.068, Acc 0.985
Round 252, Average loss 0.080, Acc 0.987
Round 253, Average loss 0.042, Acc 0.985
Round 254, Average loss 0.077, Acc 0.984
Round 255, Average loss 0.051, Acc 0.987
Round 256, Average loss 0.059, Acc 0.984
Round 257, Average loss 0.041, Acc 0.985
Round 258, Average loss 0.071, Acc 0.983
0.003812798742493501
Round 259, Average loss 0.057, Acc 0.985
Round 260, Average loss 0.072, Acc 0.986
Round 261, Average loss 0.065, Acc 0.985
Round 262, Average loss 0.082, Acc 0.985
Round 263, Average loss 0.085, Acc 0.984
Round 264, Average loss 0.080, Acc 0.983
Round 265, Average loss 0.058, Acc 0.985
Round 266, Average loss 0.040, Acc 0.988
Round 267, Average loss 0.073, Acc 0.985
Round 268, Average loss 0.081, Acc 0.986
Round 269, Average loss 0.071, Acc 0.986
Round 270, Average loss 0.059, Acc 0.985
Round 271, Average loss 0.067, Acc 0.980
Round 272, Average loss 0.099, Acc 0.987
Round 273, Average loss 0.061, Acc 0.984
Round 274, Average loss 0.061, Acc 0.985
Round 275, Average loss 0.045, Acc 0.987
Round 276, Average loss 0.056, Acc 0.984
Round 277, Average loss 0.064, Acc 0.987
Round 278, Average loss 0.084, Acc 0.988
0.003431518868244151
Round 279, Average loss 0.051, Acc 0.986
Round 280, Average loss 0.053, Acc 0.987
Round 281, Average loss 0.050, Acc 0.988
Round 282, Average loss 0.061, Acc 0.987
Round 283, Average loss 0.070, Acc 0.987
Round 284, Average loss 0.068, Acc 0.986
Round 285, Average loss 0.062, Acc 0.988
Round 286, Average loss 0.058, Acc 0.986
Round 287, Average loss 0.067, Acc 0.986
Round 288, Average loss 0.040, Acc 0.988
Round 289, Average loss 0.050, Acc 0.986
Round 290, Average loss 0.056, Acc 0.986
Round 291, Average loss 0.051, Acc 0.985
Round 292, Average loss 0.064, Acc 0.986
Round 293, Average loss 0.043, Acc 0.986
Round 294, Average loss 0.040, Acc 0.986
Round 295, Average loss 0.038, Acc 0.985
Round 296, Average loss 0.040, Acc 0.986
Round 297, Average loss 0.070, Acc 0.986
Round 298, Average loss 0.055, Acc 0.986
0.0030883669814197362
Round 299, Average loss 0.078, Acc 0.988
260.25275135040283 s
Memory used: 1658.16 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=80, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.6958552] and score 2 is 0.0
Round   0, Average loss 3.238, Acc 0.000
score 1 is [0.741488] and score 2 is 1.0
Round   1, Average loss 3.063, Acc 0.000
score 1 is [0.50424033] and score 2 is 0.0
Round   2, Average loss 3.095, Acc 0.000
score 1 is [0.721921] and score 2 is 0.0
Round   3, Average loss 3.238, Acc 0.000
score 1 is [0.6123298] and score 2 is 1.0
Round   4, Average loss 3.063, Acc 0.000
11.67322826385498 s
Memory used: 1669.27 MB

2e-1 + 90
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=90, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.162, Acc 0.569
Round   1, Average loss 2.722, Acc 0.569
Round   2, Average loss 1.727, Acc 0.569
Round   3, Average loss 0.811, Acc 0.825
Round   4, Average loss 0.683, Acc 0.569
Round   5, Average loss 0.883, Acc 0.933
Round   6, Average loss 0.566, Acc 0.786
Round   7, Average loss 0.542, Acc 0.976
Round   8, Average loss 0.433, Acc 0.819
Round   9, Average loss 0.381, Acc 0.981
Round  10, Average loss 0.304, Acc 0.935
Round  11, Average loss 0.227, Acc 0.982
Round  12, Average loss 0.256, Acc 0.936
Round  13, Average loss 0.290, Acc 0.981
Round  14, Average loss 0.171, Acc 0.941
Round  15, Average loss 0.205, Acc 0.981
Round  16, Average loss 0.301, Acc 0.942
Round  17, Average loss 0.167, Acc 0.981
Round  18, Average loss 0.194, Acc 0.955
0.0135
Round  19, Average loss 0.230, Acc 0.981
Round  20, Average loss 0.114, Acc 0.981
Round  21, Average loss 0.157, Acc 0.978
Round  22, Average loss 0.149, Acc 0.979
Round  23, Average loss 0.162, Acc 0.981
Round  24, Average loss 0.121, Acc 0.981
Round  25, Average loss 0.242, Acc 0.967
Round  26, Average loss 0.168, Acc 0.981
Round  27, Average loss 0.128, Acc 0.981
Round  28, Average loss 0.108, Acc 0.979
Round  29, Average loss 0.151, Acc 0.981
Round  30, Average loss 0.092, Acc 0.981
Round  31, Average loss 0.156, Acc 0.981
Round  32, Average loss 0.112, Acc 0.981
Round  33, Average loss 0.105, Acc 0.981
Round  34, Average loss 0.137, Acc 0.979
Round  35, Average loss 0.124, Acc 0.981
Round  36, Average loss 0.143, Acc 0.977
Round  37, Average loss 0.091, Acc 0.981
Round  38, Average loss 0.127, Acc 0.978
0.01215
Round  39, Average loss 0.120, Acc 0.981
Round  40, Average loss 0.098, Acc 0.981
Round  41, Average loss 0.095, Acc 0.979
Round  42, Average loss 0.114, Acc 0.981
Round  43, Average loss 0.095, Acc 0.978
Round  44, Average loss 0.088, Acc 0.981
Round  45, Average loss 0.093, Acc 0.981
Round  46, Average loss 0.086, Acc 0.981
Round  47, Average loss 0.114, Acc 0.979
Round  48, Average loss 0.097, Acc 0.981
Round  49, Average loss 0.099, Acc 0.979
Round  50, Average loss 0.102, Acc 0.981
Round  51, Average loss 0.139, Acc 0.980
Round  52, Average loss 0.155, Acc 0.981
Round  53, Average loss 0.105, Acc 0.981
Round  54, Average loss 0.102, Acc 0.981
Round  55, Average loss 0.156, Acc 0.981
Round  56, Average loss 0.129, Acc 0.981
Round  57, Average loss 0.143, Acc 0.981
Round  58, Average loss 0.089, Acc 0.981
0.010935
Round  59, Average loss 0.123, Acc 0.981
Round  60, Average loss 0.103, Acc 0.981
Round  61, Average loss 0.095, Acc 0.981
Round  62, Average loss 0.094, Acc 0.981
Round  63, Average loss 0.069, Acc 0.981
Round  64, Average loss 0.122, Acc 0.980
Round  65, Average loss 0.147, Acc 0.981
Round  66, Average loss 0.115, Acc 0.981
Round  67, Average loss 0.097, Acc 0.981
Round  68, Average loss 0.074, Acc 0.981
Round  69, Average loss 0.100, Acc 0.981
Round  70, Average loss 0.101, Acc 0.981
Round  71, Average loss 0.158, Acc 0.981
Round  72, Average loss 0.136, Acc 0.981
Round  73, Average loss 0.136, Acc 0.981
Round  74, Average loss 0.129, Acc 0.981
Round  75, Average loss 0.110, Acc 0.981
Round  76, Average loss 0.111, Acc 0.981
Round  77, Average loss 0.144, Acc 0.980
Round  78, Average loss 0.100, Acc 0.981
0.009841500000000001
Round  79, Average loss 0.090, Acc 0.981
Round  80, Average loss 0.096, Acc 0.983
Round  81, Average loss 0.127, Acc 0.981
Round  82, Average loss 0.067, Acc 0.982
Round  83, Average loss 0.091, Acc 0.981
Round  84, Average loss 0.084, Acc 0.983
Round  85, Average loss 0.106, Acc 0.978
Round  86, Average loss 0.095, Acc 0.982
Round  87, Average loss 0.063, Acc 0.982
Round  88, Average loss 0.112, Acc 0.981
Round  89, Average loss 0.108, Acc 0.983
Round  90, Average loss 0.095, Acc 0.981
Round  91, Average loss 0.087, Acc 0.982
Round  92, Average loss 0.110, Acc 0.985
Round  93, Average loss 0.102, Acc 0.982
Round  94, Average loss 0.081, Acc 0.982
Round  95, Average loss 0.084, Acc 0.981
Round  96, Average loss 0.115, Acc 0.984
Round  97, Average loss 0.091, Acc 0.981
Round  98, Average loss 0.107, Acc 0.981
0.008857350000000002
Round  99, Average loss 0.088, Acc 0.981
Round 100, Average loss 0.066, Acc 0.985
Round 101, Average loss 0.075, Acc 0.981
Round 102, Average loss 0.077, Acc 0.981
Round 103, Average loss 0.086, Acc 0.981
Round 104, Average loss 0.107, Acc 0.981
Round 105, Average loss 0.144, Acc 0.981
Round 106, Average loss 0.069, Acc 0.981
Round 107, Average loss 0.107, Acc 0.981
Round 108, Average loss 0.086, Acc 0.981
Round 109, Average loss 0.102, Acc 0.981
Round 110, Average loss 0.082, Acc 0.981
Round 111, Average loss 0.069, Acc 0.979
Round 112, Average loss 0.081, Acc 0.984
Round 113, Average loss 0.108, Acc 0.984
Round 114, Average loss 0.065, Acc 0.979
Round 115, Average loss 0.120, Acc 0.936
Round 116, Average loss 0.212, Acc 0.982
Round 117, Average loss 0.074, Acc 0.984
Round 118, Average loss 0.077, Acc 0.981
0.007971615000000001
Round 119, Average loss 0.113, Acc 0.985
Round 120, Average loss 0.089, Acc 0.982
Round 121, Average loss 0.054, Acc 0.981
Round 122, Average loss 0.069, Acc 0.982
Round 123, Average loss 0.068, Acc 0.985
Round 124, Average loss 0.055, Acc 0.984
Round 125, Average loss 0.055, Acc 0.958
Round 126, Average loss 0.116, Acc 0.983
Round 127, Average loss 0.072, Acc 0.981
Round 128, Average loss 0.105, Acc 0.985
Round 129, Average loss 0.107, Acc 0.985
Round 130, Average loss 0.069, Acc 0.981
Round 131, Average loss 0.089, Acc 0.984
Round 132, Average loss 0.088, Acc 0.984
Round 133, Average loss 0.065, Acc 0.981
Round 134, Average loss 0.104, Acc 0.982
Round 135, Average loss 0.112, Acc 0.985
Round 136, Average loss 0.118, Acc 0.984
Round 137, Average loss 0.093, Acc 0.986
Round 138, Average loss 0.075, Acc 0.984
0.007174453500000001
Round 139, Average loss 0.101, Acc 0.985
Round 140, Average loss 0.070, Acc 0.984
Round 141, Average loss 0.080, Acc 0.984
Round 142, Average loss 0.086, Acc 0.985
Round 143, Average loss 0.068, Acc 0.985
Round 144, Average loss 0.054, Acc 0.984
Round 145, Average loss 0.103, Acc 0.985
Round 146, Average loss 0.080, Acc 0.985
Round 147, Average loss 0.079, Acc 0.984
Round 148, Average loss 0.081, Acc 0.983
Round 149, Average loss 0.095, Acc 0.982
Round 150, Average loss 0.126, Acc 0.982
Round 151, Average loss 0.057, Acc 0.987
Round 152, Average loss 0.060, Acc 0.984
Round 153, Average loss 0.073, Acc 0.983
Round 154, Average loss 0.105, Acc 0.984
Round 155, Average loss 0.063, Acc 0.984
Round 156, Average loss 0.072, Acc 0.984
Round 157, Average loss 0.059, Acc 0.984
Round 158, Average loss 0.044, Acc 0.985
0.006457008150000001
Round 159, Average loss 0.051, Acc 0.985
Round 160, Average loss 0.073, Acc 0.986
Round 161, Average loss 0.075, Acc 0.986
Round 162, Average loss 0.102, Acc 0.985
Round 163, Average loss 0.089, Acc 0.987
Round 164, Average loss 0.075, Acc 0.982
Round 165, Average loss 0.059, Acc 0.988
Round 166, Average loss 0.084, Acc 0.980
Round 167, Average loss 0.085, Acc 0.985
Round 168, Average loss 0.051, Acc 0.986
Round 169, Average loss 0.100, Acc 0.983
Round 170, Average loss 0.059, Acc 0.985
Round 171, Average loss 0.107, Acc 0.987
Round 172, Average loss 0.047, Acc 0.984
Round 173, Average loss 0.068, Acc 0.987
Round 174, Average loss 0.038, Acc 0.986
Round 175, Average loss 0.056, Acc 0.987
Round 176, Average loss 0.062, Acc 0.986
Round 177, Average loss 0.069, Acc 0.986
Round 178, Average loss 0.052, Acc 0.987
0.005811307335000002
Round 179, Average loss 0.090, Acc 0.985
Round 180, Average loss 0.078, Acc 0.985
Round 181, Average loss 0.073, Acc 0.986
Round 182, Average loss 0.074, Acc 0.986
Round 183, Average loss 0.070, Acc 0.986
Round 184, Average loss 0.036, Acc 0.986
Round 185, Average loss 0.058, Acc 0.987
Round 186, Average loss 0.055, Acc 0.985
Round 187, Average loss 0.048, Acc 0.985
Round 188, Average loss 0.079, Acc 0.986
Round 189, Average loss 0.052, Acc 0.986
Round 190, Average loss 0.042, Acc 0.987
Round 191, Average loss 0.076, Acc 0.987
Round 192, Average loss 0.039, Acc 0.987
Round 193, Average loss 0.057, Acc 0.987
Round 194, Average loss 0.053, Acc 0.986
Round 195, Average loss 0.045, Acc 0.986
Round 196, Average loss 0.054, Acc 0.987
Round 197, Average loss 0.050, Acc 0.986
Round 198, Average loss 0.067, Acc 0.986
0.005230176601500001
Round 199, Average loss 0.053, Acc 0.986
Round 200, Average loss 0.063, Acc 0.985
Round 201, Average loss 0.060, Acc 0.986
Round 202, Average loss 0.031, Acc 0.985
Round 203, Average loss 0.103, Acc 0.986
Round 204, Average loss 0.048, Acc 0.986
Round 205, Average loss 0.046, Acc 0.984
Round 206, Average loss 0.057, Acc 0.986
Round 207, Average loss 0.046, Acc 0.987
Round 208, Average loss 0.046, Acc 0.986
Round 209, Average loss 0.055, Acc 0.986
Round 210, Average loss 0.040, Acc 0.985
Round 211, Average loss 0.068, Acc 0.986
Round 212, Average loss 0.064, Acc 0.986
Round 213, Average loss 0.053, Acc 0.985
Round 214, Average loss 0.063, Acc 0.985
Round 215, Average loss 0.041, Acc 0.987
Round 216, Average loss 0.069, Acc 0.987
Round 217, Average loss 0.086, Acc 0.986
Round 218, Average loss 0.051, Acc 0.987
0.004707158941350001
Round 219, Average loss 0.064, Acc 0.988
Round 220, Average loss 0.022, Acc 0.988
Round 221, Average loss 0.046, Acc 0.986
Round 222, Average loss 0.062, Acc 0.988
Round 223, Average loss 0.074, Acc 0.988
Round 224, Average loss 0.057, Acc 0.988
Round 225, Average loss 0.075, Acc 0.988
Round 226, Average loss 0.078, Acc 0.987
Round 227, Average loss 0.029, Acc 0.988
Round 228, Average loss 0.052, Acc 0.988
Round 229, Average loss 0.076, Acc 0.987
Round 230, Average loss 0.044, Acc 0.988
Round 231, Average loss 0.047, Acc 0.987
Round 232, Average loss 0.076, Acc 0.988
Round 233, Average loss 0.045, Acc 0.986
Round 234, Average loss 0.090, Acc 0.988
Round 235, Average loss 0.091, Acc 0.988
Round 236, Average loss 0.060, Acc 0.988
Round 237, Average loss 0.073, Acc 0.988
Round 238, Average loss 0.052, Acc 0.989
0.004236443047215001
Round 239, Average loss 0.067, Acc 0.988
Round 240, Average loss 0.038, Acc 0.990
Round 241, Average loss 0.065, Acc 0.986
Round 242, Average loss 0.076, Acc 0.989
Round 243, Average loss 0.067, Acc 0.989
Round 244, Average loss 0.059, Acc 0.988
Round 245, Average loss 0.032, Acc 0.988
Round 246, Average loss 0.020, Acc 0.989
Round 247, Average loss 0.096, Acc 0.988
Round 248, Average loss 0.038, Acc 0.987
Round 249, Average loss 0.037, Acc 0.988
Round 250, Average loss 0.078, Acc 0.988
Round 251, Average loss 0.042, Acc 0.987
Round 252, Average loss 0.079, Acc 0.987
Round 253, Average loss 0.077, Acc 0.989
Round 254, Average loss 0.078, Acc 0.988
Round 255, Average loss 0.055, Acc 0.987
Round 256, Average loss 0.054, Acc 0.987
Round 257, Average loss 0.031, Acc 0.986
Round 258, Average loss 0.062, Acc 0.986
0.003812798742493501
Round 259, Average loss 0.064, Acc 0.987
Round 260, Average loss 0.078, Acc 0.989
Round 261, Average loss 0.049, Acc 0.990
Round 262, Average loss 0.045, Acc 0.989
Round 263, Average loss 0.047, Acc 0.989
Round 264, Average loss 0.048, Acc 0.990
Round 265, Average loss 0.056, Acc 0.990
Round 266, Average loss 0.066, Acc 0.989
Round 267, Average loss 0.047, Acc 0.990
Round 268, Average loss 0.040, Acc 0.990
Round 269, Average loss 0.057, Acc 0.990
Round 270, Average loss 0.059, Acc 0.990
Round 271, Average loss 0.039, Acc 0.990
Round 272, Average loss 0.077, Acc 0.989
Round 273, Average loss 0.039, Acc 0.990
Round 274, Average loss 0.048, Acc 0.989
Round 275, Average loss 0.028, Acc 0.988
Round 276, Average loss 0.036, Acc 0.987
Round 277, Average loss 0.034, Acc 0.986
Round 278, Average loss 0.074, Acc 0.986
0.003431518868244151
Round 279, Average loss 0.068, Acc 0.987
Round 280, Average loss 0.033, Acc 0.988
Round 281, Average loss 0.045, Acc 0.987
Round 282, Average loss 0.028, Acc 0.986
Round 283, Average loss 0.017, Acc 0.986
Round 284, Average loss 0.073, Acc 0.986
Round 285, Average loss 0.087, Acc 0.987
Round 286, Average loss 0.078, Acc 0.987
Round 287, Average loss 0.046, Acc 0.988
Round 288, Average loss 0.082, Acc 0.987
Round 289, Average loss 0.037, Acc 0.989
Round 290, Average loss 0.047, Acc 0.988
Round 291, Average loss 0.045, Acc 0.988
Round 292, Average loss 0.037, Acc 0.989
Round 293, Average loss 0.030, Acc 0.990
Round 294, Average loss 0.050, Acc 0.988
Round 295, Average loss 0.043, Acc 0.987
Round 296, Average loss 0.052, Acc 0.988
Round 297, Average loss 0.036, Acc 0.987
Round 298, Average loss 0.031, Acc 0.986
0.0030883669814197362
Round 299, Average loss 0.061, Acc 0.987
271.24610710144043 s
Memory used: 1651.24 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=90, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.6659088] and score 2 is 0.0
Round   0, Average loss 3.127, Acc 0.002
score 1 is [0.64121574] and score 2 is 0.0
Round   1, Average loss 3.208, Acc 0.002
score 1 is [0.6037538] and score 2 is 0.0
Round   2, Average loss 3.119, Acc 0.002
score 1 is [0.5695401] and score 2 is 0.0
Round   3, Average loss 3.208, Acc 0.002
score 1 is [0.53563553] and score 2 is 0.0
Round   4, Average loss 3.208, Acc 0.002
13.704119205474854 s
Memory used: 1672.67 MB

2e-1 + 100
True
Namespace(epochs=300, num_users=1, local_ep=1, local_bs=1000, lr=0.015, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.9, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=0, defense=1, alpha=1.0, defense_epochs=100, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
Round   0, Average loss 3.182, Acc 0.569
Round   1, Average loss 2.701, Acc 0.569
Round   2, Average loss 1.730, Acc 0.569
Round   3, Average loss 0.906, Acc 0.570
Round   4, Average loss 0.915, Acc 0.786
Round   5, Average loss 0.912, Acc 0.747
Round   6, Average loss 0.699, Acc 0.936
Round   7, Average loss 0.649, Acc 0.786
Round   8, Average loss 0.451, Acc 0.791
Round   9, Average loss 0.492, Acc 0.413
Round  10, Average loss 0.691, Acc 0.864
Round  11, Average loss 0.304, Acc 0.981
Round  12, Average loss 0.418, Acc 0.918
Round  13, Average loss 0.375, Acc 0.981
Round  14, Average loss 0.248, Acc 0.955
Round  15, Average loss 0.197, Acc 0.981
Round  16, Average loss 0.265, Acc 0.962
Round  17, Average loss 0.178, Acc 0.980
Round  18, Average loss 0.164, Acc 0.958
0.0135
Round  19, Average loss 0.467, Acc 0.975
Round  20, Average loss 0.121, Acc 0.981
Round  21, Average loss 0.129, Acc 0.974
Round  22, Average loss 0.154, Acc 0.981
Round  23, Average loss 0.118, Acc 0.977
Round  24, Average loss 0.097, Acc 0.981
Round  25, Average loss 0.181, Acc 0.981
Round  26, Average loss 0.118, Acc 0.981
Round  27, Average loss 0.089, Acc 0.981
Round  28, Average loss 0.202, Acc 0.980
Round  29, Average loss 0.132, Acc 0.978
Round  30, Average loss 0.132, Acc 0.981
Round  31, Average loss 0.076, Acc 0.980
Round  32, Average loss 0.121, Acc 0.981
Round  33, Average loss 0.147, Acc 0.981
Round  34, Average loss 0.123, Acc 0.981
Round  35, Average loss 0.157, Acc 0.976
Round  36, Average loss 0.093, Acc 0.974
Round  37, Average loss 0.129, Acc 0.980
Round  38, Average loss 0.090, Acc 0.981
0.01215
Round  39, Average loss 0.115, Acc 0.981
Round  40, Average loss 0.075, Acc 0.973
Round  41, Average loss 0.100, Acc 0.983
Round  42, Average loss 0.074, Acc 0.981
Round  43, Average loss 0.123, Acc 0.981
Round  44, Average loss 0.079, Acc 0.980
Round  45, Average loss 0.086, Acc 0.981
Round  46, Average loss 0.097, Acc 0.981
Round  47, Average loss 0.092, Acc 0.943
Round  48, Average loss 0.144, Acc 0.981
Round  49, Average loss 0.071, Acc 0.981
Round  50, Average loss 0.071, Acc 0.981
Round  51, Average loss 0.104, Acc 0.960
Round  52, Average loss 0.216, Acc 0.981
Round  53, Average loss 0.093, Acc 0.981
Round  54, Average loss 0.087, Acc 0.981
Round  55, Average loss 0.123, Acc 0.981
Round  56, Average loss 0.079, Acc 0.981
Round  57, Average loss 0.097, Acc 0.981
Round  58, Average loss 0.091, Acc 0.984
0.010935
Round  59, Average loss 0.072, Acc 0.981
Round  60, Average loss 0.078, Acc 0.983
Round  61, Average loss 0.142, Acc 0.981
Round  62, Average loss 0.065, Acc 0.981
Round  63, Average loss 0.089, Acc 0.984
Round  64, Average loss 0.107, Acc 0.944
Round  65, Average loss 0.180, Acc 0.982
Round  66, Average loss 0.104, Acc 0.984
Round  67, Average loss 0.076, Acc 0.985
Round  68, Average loss 0.082, Acc 0.981
Round  69, Average loss 0.059, Acc 0.981
Round  70, Average loss 0.088, Acc 0.981
Round  71, Average loss 0.142, Acc 0.982
Round  72, Average loss 0.104, Acc 0.984
Round  73, Average loss 0.057, Acc 0.981
Round  74, Average loss 0.065, Acc 0.981
Round  75, Average loss 0.138, Acc 0.977
Round  76, Average loss 0.103, Acc 0.981
Round  77, Average loss 0.127, Acc 0.978
Round  78, Average loss 0.089, Acc 0.981
0.009841500000000001
Round  79, Average loss 0.107, Acc 0.981
Round  80, Average loss 0.062, Acc 0.981
Round  81, Average loss 0.063, Acc 0.983
Round  82, Average loss 0.059, Acc 0.982
Round  83, Average loss 0.087, Acc 0.986
Round  84, Average loss 0.105, Acc 0.984
Round  85, Average loss 0.060, Acc 0.985
Round  86, Average loss 0.091, Acc 0.984
Round  87, Average loss 0.061, Acc 0.980
Round  88, Average loss 0.098, Acc 0.984
Round  89, Average loss 0.068, Acc 0.986
Round  90, Average loss 0.076, Acc 0.983
Round  91, Average loss 0.067, Acc 0.985
Round  92, Average loss 0.086, Acc 0.985
Round  93, Average loss 0.121, Acc 0.985
Round  94, Average loss 0.055, Acc 0.982
Round  95, Average loss 0.077, Acc 0.981
Round  96, Average loss 0.088, Acc 0.981
Round  97, Average loss 0.080, Acc 0.985
Round  98, Average loss 0.069, Acc 0.985
0.008857350000000002
Round  99, Average loss 0.061, Acc 0.984
Round 100, Average loss 0.065, Acc 0.987
Round 101, Average loss 0.078, Acc 0.984
Round 102, Average loss 0.073, Acc 0.985
Round 103, Average loss 0.083, Acc 0.984
Round 104, Average loss 0.063, Acc 0.977
Round 105, Average loss 0.149, Acc 0.985
Round 106, Average loss 0.093, Acc 0.984
Round 107, Average loss 0.102, Acc 0.985
Round 108, Average loss 0.068, Acc 0.985
Round 109, Average loss 0.064, Acc 0.986
Round 110, Average loss 0.082, Acc 0.984
Round 111, Average loss 0.067, Acc 0.986
Round 112, Average loss 0.094, Acc 0.984
Round 113, Average loss 0.060, Acc 0.980
Round 114, Average loss 0.083, Acc 0.982
Round 115, Average loss 0.075, Acc 0.980
Round 116, Average loss 0.108, Acc 0.984
Round 117, Average loss 0.076, Acc 0.982
Round 118, Average loss 0.091, Acc 0.984
0.007971615000000001
Round 119, Average loss 0.071, Acc 0.985
Round 120, Average loss 0.085, Acc 0.986
Round 121, Average loss 0.102, Acc 0.984
Round 122, Average loss 0.051, Acc 0.984
Round 123, Average loss 0.080, Acc 0.985
Round 124, Average loss 0.082, Acc 0.984
Round 125, Average loss 0.071, Acc 0.984
Round 126, Average loss 0.076, Acc 0.983
Round 127, Average loss 0.064, Acc 0.985
Round 128, Average loss 0.120, Acc 0.985
Round 129, Average loss 0.048, Acc 0.984
Round 130, Average loss 0.078, Acc 0.986
Round 131, Average loss 0.072, Acc 0.985
Round 132, Average loss 0.101, Acc 0.985
Round 133, Average loss 0.046, Acc 0.982
Round 134, Average loss 0.088, Acc 0.982
Round 135, Average loss 0.099, Acc 0.983
Round 136, Average loss 0.131, Acc 0.985
Round 137, Average loss 0.062, Acc 0.984
Round 138, Average loss 0.115, Acc 0.986
0.007174453500000001
Round 139, Average loss 0.040, Acc 0.986
Round 140, Average loss 0.083, Acc 0.987
Round 141, Average loss 0.041, Acc 0.983
Round 142, Average loss 0.082, Acc 0.984
Round 143, Average loss 0.042, Acc 0.982
Round 144, Average loss 0.117, Acc 0.985
Round 145, Average loss 0.059, Acc 0.983
Round 146, Average loss 0.060, Acc 0.984
Round 147, Average loss 0.085, Acc 0.983
Round 148, Average loss 0.072, Acc 0.984
Round 149, Average loss 0.073, Acc 0.984
Round 150, Average loss 0.084, Acc 0.983
Round 151, Average loss 0.100, Acc 0.985
Round 152, Average loss 0.100, Acc 0.985
Round 153, Average loss 0.063, Acc 0.985
Round 154, Average loss 0.081, Acc 0.984
Round 155, Average loss 0.036, Acc 0.986
Round 156, Average loss 0.069, Acc 0.984
Round 157, Average loss 0.060, Acc 0.984
Round 158, Average loss 0.057, Acc 0.986
0.006457008150000001
Round 159, Average loss 0.052, Acc 0.986
Round 160, Average loss 0.063, Acc 0.985
Round 161, Average loss 0.063, Acc 0.983
Round 162, Average loss 0.050, Acc 0.984
Round 163, Average loss 0.075, Acc 0.984
Round 164, Average loss 0.089, Acc 0.985
Round 165, Average loss 0.120, Acc 0.985
Round 166, Average loss 0.040, Acc 0.985
Round 167, Average loss 0.048, Acc 0.985
Round 168, Average loss 0.054, Acc 0.984
Round 169, Average loss 0.044, Acc 0.983
Round 170, Average loss 0.046, Acc 0.983
Round 171, Average loss 0.075, Acc 0.985
Round 172, Average loss 0.054, Acc 0.984
Round 173, Average loss 0.072, Acc 0.984
Round 174, Average loss 0.049, Acc 0.984
Round 175, Average loss 0.076, Acc 0.985
Round 176, Average loss 0.093, Acc 0.985
Round 177, Average loss 0.041, Acc 0.983
Round 178, Average loss 0.068, Acc 0.986
0.005811307335000002
Round 179, Average loss 0.102, Acc 0.986
Round 180, Average loss 0.077, Acc 0.986
Round 181, Average loss 0.065, Acc 0.984
Round 182, Average loss 0.062, Acc 0.986
Round 183, Average loss 0.062, Acc 0.987
Round 184, Average loss 0.052, Acc 0.988
Round 185, Average loss 0.048, Acc 0.988
Round 186, Average loss 0.065, Acc 0.988
Round 187, Average loss 0.045, Acc 0.989
Round 188, Average loss 0.081, Acc 0.985
Round 189, Average loss 0.051, Acc 0.987
Round 190, Average loss 0.042, Acc 0.990
Round 191, Average loss 0.051, Acc 0.985
Round 192, Average loss 0.055, Acc 0.986
Round 193, Average loss 0.048, Acc 0.987
Round 194, Average loss 0.026, Acc 0.987
Round 195, Average loss 0.051, Acc 0.989
Round 196, Average loss 0.059, Acc 0.989
Round 197, Average loss 0.065, Acc 0.990
Round 198, Average loss 0.048, Acc 0.987
0.005230176601500001
Round 199, Average loss 0.034, Acc 0.986
Round 200, Average loss 0.051, Acc 0.985
Round 201, Average loss 0.094, Acc 0.987
Round 202, Average loss 0.064, Acc 0.986
Round 203, Average loss 0.043, Acc 0.986
Round 204, Average loss 0.056, Acc 0.987
Round 205, Average loss 0.037, Acc 0.985
Round 206, Average loss 0.067, Acc 0.982
Round 207, Average loss 0.036, Acc 0.984
Round 208, Average loss 0.072, Acc 0.986
Round 209, Average loss 0.053, Acc 0.987
Round 210, Average loss 0.062, Acc 0.986
Round 211, Average loss 0.047, Acc 0.987
Round 212, Average loss 0.054, Acc 0.985
Round 213, Average loss 0.048, Acc 0.986
Round 214, Average loss 0.049, Acc 0.986
Round 215, Average loss 0.064, Acc 0.986
Round 216, Average loss 0.084, Acc 0.987
Round 217, Average loss 0.046, Acc 0.986
Round 218, Average loss 0.053, Acc 0.987
0.004707158941350001
Round 219, Average loss 0.085, Acc 0.988
Round 220, Average loss 0.069, Acc 0.988
Round 221, Average loss 0.044, Acc 0.988
Round 222, Average loss 0.035, Acc 0.989
Round 223, Average loss 0.036, Acc 0.987
Round 224, Average loss 0.071, Acc 0.988
Round 225, Average loss 0.059, Acc 0.988
Round 226, Average loss 0.051, Acc 0.988
Round 227, Average loss 0.048, Acc 0.989
Round 228, Average loss 0.061, Acc 0.989
Round 229, Average loss 0.060, Acc 0.989
Round 230, Average loss 0.046, Acc 0.989
Round 231, Average loss 0.057, Acc 0.989
Round 232, Average loss 0.042, Acc 0.988
Round 233, Average loss 0.032, Acc 0.989
Round 234, Average loss 0.044, Acc 0.988
Round 235, Average loss 0.053, Acc 0.989
Round 236, Average loss 0.040, Acc 0.989
Round 237, Average loss 0.034, Acc 0.989
Round 238, Average loss 0.054, Acc 0.989
0.004236443047215001
Round 239, Average loss 0.053, Acc 0.990
Round 240, Average loss 0.052, Acc 0.990
Round 241, Average loss 0.048, Acc 0.990
Round 242, Average loss 0.036, Acc 0.990
Round 243, Average loss 0.038, Acc 0.990
Round 244, Average loss 0.056, Acc 0.991
Round 245, Average loss 0.054, Acc 0.991
Round 246, Average loss 0.051, Acc 0.990
Round 247, Average loss 0.027, Acc 0.990
Round 248, Average loss 0.034, Acc 0.990
Round 249, Average loss 0.051, Acc 0.990
Round 250, Average loss 0.038, Acc 0.990
Round 251, Average loss 0.031, Acc 0.990
Round 252, Average loss 0.043, Acc 0.991
Round 253, Average loss 0.053, Acc 0.990
Round 254, Average loss 0.041, Acc 0.990
Round 255, Average loss 0.049, Acc 0.990
Round 256, Average loss 0.029, Acc 0.990
Round 257, Average loss 0.034, Acc 0.991
Round 258, Average loss 0.028, Acc 0.991
0.003812798742493501
Round 259, Average loss 0.044, Acc 0.990
Round 260, Average loss 0.034, Acc 0.990
Round 261, Average loss 0.042, Acc 0.991
Round 262, Average loss 0.040, Acc 0.990
Round 263, Average loss 0.058, Acc 0.990
Round 264, Average loss 0.030, Acc 0.990
Round 265, Average loss 0.035, Acc 0.989
Round 266, Average loss 0.036, Acc 0.990
Round 267, Average loss 0.026, Acc 0.989
Round 268, Average loss 0.025, Acc 0.990
Round 269, Average loss 0.048, Acc 0.990
Round 270, Average loss 0.037, Acc 0.990
Round 271, Average loss 0.031, Acc 0.990
Round 272, Average loss 0.040, Acc 0.990
Round 273, Average loss 0.042, Acc 0.991
Round 274, Average loss 0.037, Acc 0.989
Round 275, Average loss 0.038, Acc 0.991
Round 276, Average loss 0.057, Acc 0.989
Round 277, Average loss 0.023, Acc 0.989
Round 278, Average loss 0.042, Acc 0.990
0.003431518868244151
Round 279, Average loss 0.030, Acc 0.990
Round 280, Average loss 0.040, Acc 0.991
Round 281, Average loss 0.065, Acc 0.990
Round 282, Average loss 0.037, Acc 0.991
Round 283, Average loss 0.032, Acc 0.990
Round 284, Average loss 0.051, Acc 0.990
Round 285, Average loss 0.039, Acc 0.989
Round 286, Average loss 0.030, Acc 0.990
Round 287, Average loss 0.030, Acc 0.990
Round 288, Average loss 0.069, Acc 0.991
Round 289, Average loss 0.039, Acc 0.991
Round 290, Average loss 0.050, Acc 0.991
Round 291, Average loss 0.022, Acc 0.991
Round 292, Average loss 0.048, Acc 0.991
Round 293, Average loss 0.037, Acc 0.990
Round 294, Average loss 0.038, Acc 0.990
Round 295, Average loss 0.045, Acc 0.990
Round 296, Average loss 0.040, Acc 0.990
Round 297, Average loss 0.051, Acc 0.988
Round 298, Average loss 0.043, Acc 0.989
0.0030883669814197362
Round 299, Average loss 0.020, Acc 0.989
305.5649666786194 s
Memory used: 1667.00 MB

True
Namespace(epochs=5, num_users=1, local_ep=1, local_bs=1, lr=0.01, eval=1, iid=1, save_change=0, save_ablation=0, model='dnn', device='cuda', decay=0.8, decay_epochs=20, test_num=-1, dataset='kdd', recon_epochs=300, attack=1, defense=1, alpha=1.0, defense_epochs=100, defense_lr=0.2, g_value=1e-15, max_dis=1, load_model=0, save_model=0, save_plot=0, save_recon=0, klam=4, upper=0.65, n_epochs=100, gan_lr=0.001, b1=0.5, b2=0.999, clip_value=0.01, n_critic=1, pretrain=0, use_ori=0)
score 1 is [0.54591525] and score 2 is 0.0
Round   0, Average loss 3.161, Acc 0.000
score 1 is [0.59930825] and score 2 is 0.0
Round   1, Average loss 3.068, Acc 0.000
score 1 is [0.65487134] and score 2 is 0.0
Round   2, Average loss 3.149, Acc 0.000
score 1 is [0.6726926] and score 2 is 0.0
Round   3, Average loss 3.161, Acc 0.000
score 1 is [0.63423383] and score 2 is 0.0
Round   4, Average loss 3.161, Acc 0.000
13.273227453231812 s
Memory used: 1701.00 MB

